import{_ as k,r as l,o as d,c as m,b as a,w as t,a as n,d as s,e as c}from"./app.1137d7ac.js";const v={},h=n("h1",{id:"conversations-conversations",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#conversations-conversations","aria-hidden":"true"},"#"),s(" Conversations ("),n("code",null,"conversations"),s(")")],-1),b=n("p",null,"Create powerful conversational interfaces with ease.",-1),y=n("h2",{id:"introduction",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#introduction","aria-hidden":"true"},"#"),s(" Introduction")],-1),w=n("p",null,"Most chats consist of more than just one single message. (duh)",-1),f=n("p",null,"For example, you may want to ask the user a question, and then wait for the response. This may even go back and forth several times, so that a conversation unfolds.",-1),g=s("When you think about "),_=s("middleware"),x=s(", you will notice that everything is based around a single "),C=s("context object"),j=s(" per handler. This means that you always only handle a single message in isolation. It is not easy to write something like \u201Ccheck the text three messages ago\u201D or something."),I=c(`<p><strong>This plugin comes to the rescue:</strong> It provides an extremely flexible way to define conversations between your bot and your users.</p><p>Many bot frameworks make you define large configuration objects with steps and stages and jumps and wizard flows and what have you. This leads to a lot of boilerplate code, and makes it hard to follow along. <strong>This plugin does not work that way.</strong></p><p>Instead, with this plugin, you will use something much more powerful: <strong>code</strong>. Basically, you simply define a normal JavaScript function which lets you define how the conversation evolves. As the bot and the user talk to each other, the function will be executed statement by statement.</p><p>(To be fair, that\u2019s not actually how it works under the hood. But it is very helpful to think of it that way! In reality, your function will be executed a bit differently, but we\u2019ll get to that <a href="#waiting-for-updates">later</a>.)</p><h2 id="simple-example" tabindex="-1"><a class="header-anchor" href="#simple-example" aria-hidden="true">#</a> Simple Example</h2><p>Before we dive into how you can create conversations, have a look at a short JavaScript example of how a conversation will look.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">greeting</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;Hi there! What is your name?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Welcome to the chat, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>message<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In this conversation, the bot will first greet the user, and ask for their name. Then it will wait until the user sends their name. Lastly, the bot welcomes the user to the chat, repeating the name.</p><p>Easy, right? Let\u2019s see how it\u2019s done!</p><h2 id="conversation-builder-functions" tabindex="-1"><a class="header-anchor" href="#conversation-builder-functions" aria-hidden="true">#</a> Conversation Builder Functions</h2><p>First of all, lets import a few things.</p>`,11),T=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"Conversation"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"ConversationFlavor"),n("span",{class:"token punctuation"},","),s(`
  conversations`),n("span",{class:"token punctuation"},","),s(`
  createConversation`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"@grammyjs/conversations"'),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),M=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  conversations`),n("span",{class:"token punctuation"},","),s(`
  createConversation`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"@grammyjs/conversations"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),q=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"Conversation"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"ConversationFlavor"),n("span",{class:"token punctuation"},","),s(`
  conversations`),n("span",{class:"token punctuation"},","),s(`
  createConversation`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"https://deno.land/x/grammy_conversations@v1.0.3/mod.ts"'),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),S=c(`<p>With that out of the way, we can now have a look at how to define conversational interfaces.</p><p>The main element of a conversation is a function with two arguments. We call this the <em>conversation builder function</em>.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">greeting</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: code the conversation</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Let\u2019s see what the two parameters are.</p>`,4),F=n("strong",null,"The second parameter",-1),A=s(" is not that interesting, it is just a regular context object. As always, it is called "),W=n("code",null,"ctx",-1),B=s(" and uses your "),H=s("custom context type"),O=s(" (maybe called "),J=n("code",null,[s("My"),n("wbr"),s("Context")],-1),D=s("). The conversations plugin exports a "),L=s("context flavor"),P=s(" called "),R=n("code",null,[s("Conversation"),n("wbr"),s("Flavor")],-1),G=s("."),Y=n("strong",null,"The first parameter",-1),N=s(" is the central element of this plugin. It is commonly named "),E=n("code",null,"conversation",-1),$=s(", and it has the type "),z=n("code",null,"Conversation",-1),V=s(" ("),U={href:"https://doc.deno.land/https://deno.land/x/grammy_conversations/mod.ts/~/Conversation",target:"_blank",rel:"noopener noreferrer"},Q=s("API reference"),K=s("). It can be used as a handle to control the conversation, such as waiting for user input, and more. The type "),X=n("code",null,"Conversation",-1),Z=s(" expects your "),nn=s("custom context type"),sn=s(" as a type parameter, so you would often use "),an=n("code",null,[s("Conversation<My"),n("wbr"),s("Context>")],-1),tn=s("."),en=c(`<p>In summary, in TypeScript, your conversation builder function will look like this.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">MyContext</span> <span class="token operator">=</span> Context <span class="token operator">&amp;</span> ConversationFlavor<span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">MyConversation</span> <span class="token operator">=</span> Conversation<span class="token operator">&lt;</span>MyContext<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">greeting</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: code the conversation</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Inside of your conversation builder function, you can now define how the conversation should look. Before we go in depth about every feature of this plugin, let\u2019s have a look at a more complex example than the <a href="#simple-example">simple one</a> above.</p>`,3),on=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"movie"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"How many favorite movies do you have?"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" count "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),s("form"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"number"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" movies"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"string"),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" i "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},";"),s(" i "),n("span",{class:"token operator"},"<"),s(" count"),n("span",{class:"token punctuation"},";"),s(" i"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"Tell me number "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("i "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},"!"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" titleCtx "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"waitFor"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'":text"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    movies`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("titleCtx"),n("span",{class:"token punctuation"},"."),s("msg"),n("span",{class:"token punctuation"},"."),s("text"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Here is a better ranking!"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  movies`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"sort"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),s("movies"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),s("m"),n("span",{class:"token punctuation"},","),s(" i"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("i "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},". "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("m"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"join"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"\\n"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),cn=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"movie"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"How many favorite movies do you have?"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" count "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),s("form"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"number"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" movies "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" i "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},";"),s(" i "),n("span",{class:"token operator"},"<"),s(" count"),n("span",{class:"token punctuation"},";"),s(" i"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"Tell me number "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("i "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},"!"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" titleCtx "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"waitFor"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'":text"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    movies`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("titleCtx"),n("span",{class:"token punctuation"},"."),s("msg"),n("span",{class:"token punctuation"},"."),s("text"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Here is a better ranking!"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  movies`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"sort"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),s("movies"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("m"),n("span",{class:"token punctuation"},","),s(" i")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("i "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},". "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("m"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"join"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"\\n"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),pn=n("p",null,"Can you figure out how this bot will work?",-1),ln=n("h2",{id:"installing-and-entering-a-conversation",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#installing-and-entering-a-conversation","aria-hidden":"true"},"#"),s(" Installing and Entering a Conversation")],-1),un=s("First of all, you "),rn=n("strong",null,"must",-1),kn=s(" use the "),dn=s("session plugin"),mn=s(" if you want to use the conversations plugin. You also have to install the conversations plugin itself, before you can register individual conversations on your bot."),vn=c(`<div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// Install the session plugin.</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">initial</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// return empty object for now</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Install the conversations plugin.</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">conversations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Next, you can install the conversation builder function as middleware on your bot object by wrapping it inside <code>create<wbr>Conversation</code>.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">createConversation</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Now that your conversation is registered on the bot, you can enter the conversation from any handler. Make sure to use <code>await</code> for all methods on <code>ctx<wbr>.conversation</code>\u2014otherwise your code will break.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;greeting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As soon as the user sends <code>/start</code> to the bot, the conversation will be entered. The current context object is passed as the second argument to the conversation builder function. For example, if you start your conversation with <code>await ctx<wbr>.reply(ctx<wbr>.message<wbr>.text)</code>, it will contain the update that contains <code>/start</code>.</p><div class="custom-container tip"><p class="custom-container-title">Change the Conversation Identifier</p><p>By default, you have to pass the name of the function to <code>ctx<wbr>.conversation<wbr>.enter()</code>. However, if you prefer to use a different identifier, you can specify it like so:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">createConversation</span><span class="token punctuation">(</span>greeting<span class="token punctuation">,</span> <span class="token string">&quot;new-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>In turn, you can enter the conversation with it:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;new-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>In total, your code should now roughly look like this:</p>`,8),hn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" Bot"),n("span",{class:"token punctuation"},","),s(" Context"),n("span",{class:"token punctuation"},","),s(" session "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"grammy"'),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"Conversation"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"ConversationFlavor"),n("span",{class:"token punctuation"},","),s(`
  conversations`),n("span",{class:"token punctuation"},","),s(`
  createConversation`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"@grammyjs/conversations"'),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"MyContext"),s(),n("span",{class:"token operator"},"="),s(" Context "),n("span",{class:"token operator"},"&"),s(" ConversationFlavor"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"MyConversation"),s(),n("span",{class:"token operator"},"="),s(" Conversation"),n("span",{class:"token operator"},"<"),s("MyContext"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"const"),s(" bot "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},[s("Bot"),n("span",{class:"token operator"},"<"),s("MyContext"),n("span",{class:"token operator"},">")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token function-variable function"},"initial"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"conversations"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token doc-comment comment"},"/** Defines the conversation */"),s(`
`),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"greeting"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// TODO: code the conversation"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"createConversation"),n("span",{class:"token punctuation"},"("),s("greeting"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"start"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},'// enter the function "greeting" you declared'),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"enter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"greeting"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"start"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),bn=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" Bot"),n("span",{class:"token punctuation"},","),s(" Context"),n("span",{class:"token punctuation"},","),s(" session "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"grammy"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  conversations`),n("span",{class:"token punctuation"},","),s(`
  createConversation`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"@grammyjs/conversations"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"const"),s(" bot "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Bot"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token function-variable function"},"initial"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"conversations"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token doc-comment comment"},"/** Defines the conversation */"),s(`
`),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"greeting"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// TODO: code the conversation"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"createConversation"),n("span",{class:"token punctuation"},"("),s("greeting"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"start"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},'// enter the function "greeting" you declared'),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"enter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"greeting"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"start"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),yn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" Bot"),n("span",{class:"token punctuation"},","),s(" Context"),n("span",{class:"token punctuation"},","),s(" session "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"https://deno.land/x/grammy@v1.11.1/mod.ts"'),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"Conversation"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"ConversationFlavor"),n("span",{class:"token punctuation"},","),s(`
  conversations`),n("span",{class:"token punctuation"},","),s(`
  createConversation`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"https://deno.land/x/grammy_conversations@v1.0.3/mod.ts"'),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"MyContext"),s(),n("span",{class:"token operator"},"="),s(" Context "),n("span",{class:"token operator"},"&"),s(" ConversationFlavor"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"MyConversation"),s(),n("span",{class:"token operator"},"="),s(" Conversation"),n("span",{class:"token operator"},"<"),s("MyContext"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"const"),s(" bot "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},[s("Bot"),n("span",{class:"token operator"},"<"),s("MyContext"),n("span",{class:"token operator"},">")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token function-variable function"},"initial"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"conversations"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token doc-comment comment"},"/** Defines the conversation */"),s(`
`),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"greeting"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// TODO: code the conversation"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"createConversation"),n("span",{class:"token punctuation"},"("),s("greeting"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"start"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},'// enter the function "greeting" you declared'),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"enter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"greeting"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"start"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),wn=n("h2",{id:"leaving-a-conversation",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#leaving-a-conversation","aria-hidden":"true"},"#"),s(" Leaving a Conversation")],-1),fn=n("p",null,[s("The conversation will run until your conversation builder function completes. This means that you can simply leave a conversation by using "),n("code",null,"return"),s(".")],-1),gn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"hiAndBye"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Hi! And Bye!"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token comment"},"// Leave the conversation:"),s(`
  `),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),_n=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"hiAndBye"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Hi! And Bye!"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token comment"},"// Leave the conversation:"),s(`
  `),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),xn=n("p",null,[s("(Yes, putting a "),n("code",null,"return"),s(" at the end of the function is a bit pointless, but you get the idea.)")],-1),Cn=s("You can also throw an error. This will likewise exit the conversation. Remember to "),jn=s("install an error handler"),In=s(" on your bot."),Tn=n("p",null,[s("If you want to hard-kill the conversation while it is waiting for user input, you can also use "),n("code",null,[s("await ctx"),n("wbr"),s(".conversation"),n("wbr"),s(".exit()")]),s(". It\u2019s often better to stick with simply returning from the function, but there are a few examples where using "),n("code",null,[s("await ctx"),n("wbr"),s(".conversation"),n("wbr"),s(".exit()")]),s(" is convenient. Remember that you must "),n("code",null,"await"),s(" the call.")],-1),Mn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"movie"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// TODO: code the conversation"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// Install the conversations plugin."),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"conversations"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Always exit any conversation upon /cancel"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"cancel"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Leaving."'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"exit"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Always exit the `movie` conversation "),s(`
`),n("span",{class:"token comment"},"// when the inline keyboard's `cancel` button is pressed."),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"callbackQuery"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"cancel"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"answerCallbackQuery"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Left conversation"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"exit"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"movie"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"createConversation"),n("span",{class:"token punctuation"},"("),s("movie"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"movie"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"enter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"movie"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"\xA0"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"\xA0"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),qn=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"movie"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// TODO: code the conversation"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// Install the conversations plugin."),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"conversations"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Always exit any conversation upon /cancel"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"cancel"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Leaving."'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"exit"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Always exit the `movie` conversation "),s(`
`),n("span",{class:"token comment"},"// when the inline keyboard's `cancel` button is pressed."),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"callbackQuery"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"cancel"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"answerCallbackQuery"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Left conversation"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"exit"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"movie"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"createConversation"),n("span",{class:"token punctuation"},"("),s("movie"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"movie"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"enter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"movie"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"\xA0"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"\xA0"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Sn=n("p",null,[s("Note that the order matters here. You must first install the conversations plugin (line 6) before you can call "),n("code",null,[s("await ctx"),n("wbr"),s(".conversation"),n("wbr"),s(".exit()")]),s(". Also, the generic cancel handlers must be installed before the actual conversations (line 21) are registered.")],-1),Fn=n("h2",{id:"waiting-for-updates",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#waiting-for-updates","aria-hidden":"true"},"#"),s(" Waiting for Updates")],-1),An=n("p",null,[s("You can use the conversation handle "),n("code",null,"conversation"),s(" to wait for the next update in this particular chat.")],-1),Wn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"waitForMe"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Wait for the next update:"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" newContext "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"wait"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Bn=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"waitForMe"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Wait for the next update:"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" newContext "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"wait"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Hn=s("An update can mean that a text message was sent, or a button was pressed, or something was edited, or virtually any other action was performed by the user. Check out the full list in the Telegram docs "),On={href:"https://core.telegram.org/bots/api#update",target:"_blank",rel:"noopener noreferrer"},Jn=s("here"),Dn=s("."),Ln=s("Usually, outside of the conversations plugin, each of these updates would be handled by the "),Pn=s("middleware system"),Rn=s(" of your bot. Hence, your bot would handle the update via a context object which gets passed to your handlers."),Gn=n("p",null,[s("In conversations, you will obtain this new context object from the "),n("code",null,"wait"),s(" call. In turn, you can handle different updates differently based on this object. For example, you can check for text messages:")],-1),Yn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"waitForText"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Wait for the next update:"),s(`
  ctx `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"wait"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token comment"},"// Check for text:"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("message"),n("span",{class:"token operator"},"?."),s("text"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// ..."),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Nn=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"waitForText"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Wait for the next update:"),s(`
  ctx `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"wait"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token comment"},"// Check for text:"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("message"),n("span",{class:"token operator"},"?."),s("text"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// ..."),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),En=s("In addition, there are a number of other methods alongside "),$n=n("code",null,"wait",-1),zn=s(" that let you wait for specific updates only. One example is "),Vn=n("code",null,[s("wait"),n("wbr"),s("For")],-1),Un=s(" which takes a "),Qn=s("filter query"),Kn=s(" and then only waits for updates that match the provided query. This is especially powerful in combination with "),Xn={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment",target:"_blank",rel:"noopener noreferrer"},Zn=s("object destructuring"),ns=s(":"),ss=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"waitForText"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Wait for the next text message update:"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" msg"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(" text "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"waitFor"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"message:text"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),as=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"waitForText"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Wait for the next text message update:"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"msg"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(" text "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"waitFor"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"message:text"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),ts=s("Check out the "),es={href:"https://doc.deno.land/https://deno.land/x/grammy_conversations/mod.ts/~/ConversationHandle#wait",target:"_blank",rel:"noopener noreferrer"},os=s("API reference"),cs=s(" to see all available methods that are similar to "),is=n("code",null,"wait",-1),ps=s("."),ls=c(`<h2 id="three-golden-rules-of-conversations" tabindex="-1"><a class="header-anchor" href="#three-golden-rules-of-conversations" aria-hidden="true">#</a> Three Golden Rules of Conversations</h2><p>There are three rules that apply to the code you write inside a conversation builder function. You must follow them if you want your code to behave correctly.</p><p>Scroll <a href="#how-it-works">down</a> if you want to know more about <em>why</em> these rules apply, and what <code>wait</code> calls really do internally.</p><h3 id="rule-i-all-side-effects-must-be-wrapped" tabindex="-1"><a class="header-anchor" href="#rule-i-all-side-effects-must-be-wrapped" aria-hidden="true">#</a> Rule I: All Side-effects Must Be Wrapped</h3><p>Code that depends on external system such as databases, APIs, files, or other resources which could change from one execution to the next must be wrapped in <code>conversation<wbr>.external()</code> calls.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// BAD</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">externalApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// GOOD</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">external</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">externalApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This includes both reading data, as well as performing side-effects (such as writing to a database).</p><div class="custom-container tip"><p class="custom-container-title">Comparable to React</p><p>If you are familiar with React, you may know a comparable concept from <code>use<wbr>Effect</code>.</p></div><h3 id="rule-ii-all-random-behavior-must-be-wrapped" tabindex="-1"><a class="header-anchor" href="#rule-ii-all-random-behavior-must-be-wrapped" aria-hidden="true">#</a> Rule II: All Random Behavior Must Be Wrapped</h3><p>Code that depends on randomness or on global state which could change, must wrap all access to it in <code>conversation<wbr>.external()</code> calls, or use the <code>conversation<wbr>.random()</code> convenience function.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// BAD</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* do stuff */</span> <span class="token punctuation">}</span>
<span class="token comment">// GOOD</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>conversation<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* do stuff */</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="rule-iii-use-convenience-functions" tabindex="-1"><a class="header-anchor" href="#rule-iii-use-convenience-functions" aria-hidden="true">#</a> Rule III: Use Convenience Functions</h3><p>There are a bunch of things installed on <code>conversation</code> which may greatly help you. Your code doesn\u2019t exactly break if you don\u2019t use them, but it can be slow or behave in a confusing way. The end user might not notice a difference, though.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// Sleep via conversation, massive performance improvement</span>
<span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3 seconds</span>

<span class="token comment">// Debug logging via conversation, does not print confusing logs</span>
conversation<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,14),us=s("Note that you can do all of the above via "),rs=n("code",null,[s("conversation"),n("wbr"),s(".external()")],-1),ks=s(", but this can be tedious to type, so it\u2019s just easier to use the convenience functions ("),ds={href:"https://doc.deno.land/https://deno.land/x/grammy_conversations/mod.ts/~/ConversationHandle#Methods",target:"_blank",rel:"noopener noreferrer"},ms=s("API reference"),vs=s(")."),hs=c(`<h2 id="variables-branching-and-loops" tabindex="-1"><a class="header-anchor" href="#variables-branching-and-loops" aria-hidden="true">#</a> Variables, Branching, and Loops</h2><p>If you follow the three rules above, you are completely free to use any code you like. We will now go through a few concepts that you already know from programming, and show how they translate to clean and readable conversations.</p><p>Imagine that all code below is written inside a conversation builder function.</p><p>You can declare variables and do whatever you want with them:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;Send me your favorite numbers, separated by commas!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token string">&quot;message:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sum <span class="token operator">=</span> message<span class="token punctuation">.</span>text
  <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;The sum of these numbers is: &quot;</span> <span class="token operator">+</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Branching works, too:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;Send me a photo!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>message<span class="token operator">?.</span>photo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;That is not a photo! I&#39;m out!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So do loops:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">do</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;Send me a photo!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>message<span class="token operator">?.</span>text <span class="token operator">===</span> <span class="token string">&quot;/cancel&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;Cancelled, leaving!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>ctx<span class="token punctuation">.</span>message<span class="token operator">?.</span>photo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="functions-and-recursion" tabindex="-1"><a class="header-anchor" href="#functions-and-recursion" aria-hidden="true">#</a> Functions and Recursion</h2><p>You can also split up your code in several functions, and reuse them. For example, this is how you can define a reusable captcha.</p>`,11),bs=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"captcha"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Prove you are human! What is the answer to everything?"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" message "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"wait"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"return"),s(" message"),n("span",{class:"token operator"},"?."),s("text "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},'"42"'),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),ys=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"captcha"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Prove you are human! What is the answer to everything?"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" message "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"wait"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"return"),s(" message"),n("span",{class:"token operator"},"?."),s("text "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},'"42"'),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),ws=n("p",null,[s("It returns "),n("code",null,"true"),s(" if the user may pass, and "),n("code",null,"false"),s(" otherwise. You can now use it in your main conversation builder function like this:")],-1),fs=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"enterGroup"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" ok "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"captcha"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ok"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Welcome!"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"banChatMember"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),gs=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"enterGroup"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" ok "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"captcha"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ok"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Welcome!"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"banChatMember"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),_s=c('<p>See how the captcha function can be reused in different places in your code.</p><blockquote><p>This simple example is only meant to illustrate how functions work. In reality, it may work poorly because it only waits for a new update from the respective chat, but without verifying that it actually comes from the same user who joined. If you want to create a real captcha, you may want to use <a href="#parallel-conversations">parallel conversations</a>.</p></blockquote><p>If you want, you can also split your code across even more functions, or use recursion, mutual recursion, generators, and so on. (Just make sure that all functions follow the <a href="#three-golden-rules-of-conversations">three rules</a>.)</p><p>Naturally, you can use error handling in your functions, too. Regular <code>try</code>/<code>catch</code> statements work just fine, also across functions. After all, conversations are just JavaScript.</p>',4),xs=s("If the main conversation function throws an error, the error will propagate further into the "),Cs=s("error handling mechanisms"),js=s(" of your bot."),Is=n("h2",{id:"modules-and-classes",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#modules-and-classes","aria-hidden":"true"},"#"),s(" Modules and Classes")],-1),Ts=n("p",null,[s("Naturally, you can just move your functions across modules. That way, you can define some functions in one file, "),n("code",null,"export"),s(" them, and then "),n("code",null,"import"),s(" and use them in another file.")],-1),Ms=n("p",null,"If you want, you can also define classes.",-1),qs=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"Auth"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"public"),s(" token"),n("span",{class:"token operator"},"?"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"string"),n("span",{class:"token punctuation"},";"),s(`

  `),n("span",{class:"token function"},"constructor"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"private"),s(" conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token function"},"authenticate"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" link "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"getAuthLink"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(),n("span",{class:"token comment"},"// get auth link from your system"),s(`
    `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},'"Open this link to obtain a token, and sent it back to me: "'),s(),n("span",{class:"token operator"},"+"),s(" link"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    ctx `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},"."),s("conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"wait"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},"."),s("token "),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s("message"),n("span",{class:"token operator"},"?."),s("text"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token function"},"isAuthenticated"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"this"),s(),n("span",{class:"token keyword"},"is"),s(" Auth "),n("span",{class:"token operator"},"&"),s(),n("span",{class:"token punctuation"},"{"),s(" token"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"string"),s(),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},"."),s("token "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token keyword"},"undefined"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"askForToken"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" auth "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Auth"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" auth"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"authenticate"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("auth"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"isAuthenticated"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" token "),n("span",{class:"token operator"},"="),s(" auth"),n("span",{class:"token punctuation"},"."),s("token"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token comment"},"// do stuff with token"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Ss=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"Auth"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token function"},"constructor"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"conversation"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},"."),s("#conversation "),n("span",{class:"token operator"},"="),s(" conversation"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token function"},"authenticate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" link "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"getAuthLink"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(),n("span",{class:"token comment"},"// get auth link from your system"),s(`
    `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},'"Open this link to obtain a token, and sent it back to me: "'),s(),n("span",{class:"token operator"},"+"),s(" link"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    ctx `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},"."),s("#conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"wait"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},"."),s("token "),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s("message"),n("span",{class:"token operator"},"?."),s("text"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token function"},"isAuthenticated"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},"."),s("token "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token keyword"},"undefined"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"askForToken"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" auth "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Auth"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" auth"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"authenticate"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("auth"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"isAuthenticated"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" token "),n("span",{class:"token operator"},"="),s(" auth"),n("span",{class:"token punctuation"},"."),s("token"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token comment"},"// do stuff with token"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Fs=c('<p>The point here is not so much that we strictly recommend you to do this. It is rather meant as an example for how you can use the endless flexibilities of JavaScript to structure your code.</p><h2 id="forms" tabindex="-1"><a class="header-anchor" href="#forms" aria-hidden="true">#</a> Forms</h2><p>As mentioned <a href="#waiting-for-updates">earlier</a>, there are several different utility functions on the conversation handle, such as <code>await conversation<wbr>.wait<wbr>For(&#39;message:<wbr>text&#39;)</code> which only returns text message updates.</p><p>If these methods are not enough, the conversations plugin provides even more helper functions for building forms via <code>conversation<wbr>.form</code>.</p>',4),As=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"waitForMe"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"How old are you?"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"number"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),s("form"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"number"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Ws=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"waitForMe"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"How old are you?"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" age "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),s("form"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"number"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Bs=s("As always, check out the "),Hs={href:"https://doc.deno.land/https://deno.land/x/grammy_conversations/mod.ts/~/ConversationForm",target:"_blank",rel:"noopener noreferrer"},Os=s("API reference"),Js=s(" to see which methods are available."),Ds=c('<h2 id="parallel-conversations" tabindex="-1"><a class="header-anchor" href="#parallel-conversations" aria-hidden="true">#</a> Parallel Conversations</h2><p>Naturally, the conversations plugin can run any number of conversations in parallel in different chats.</p><p>However, if your bot gets added to a group chat, it may want to have conversations with several different users in parallel <em>in the same chat</em>. For example, if your bot features a captcha that it wants to send to all new members. If two members join at the same time, the bot should be able to have two independent conversations with them.</p><p>This is why the conversations plugin allows you to enter several conversations at the same time for every chat. For instance, it is possible to have five different conversations with five new users, and at the same time chat with an admin about new chat config.</p><h3 id="how-it-works-behind-the-scenes" tabindex="-1"><a class="header-anchor" href="#how-it-works-behind-the-scenes" aria-hidden="true">#</a> How It Works Behind the Scenes</h3><p>Every incoming update will only be handled by one of the active conversations in a chat. Comparable to middleware handlers, the conversations will be called in the order they are registered. If a conversation is started multiple times, these instances of the conversation will be called in chronological order.</p><p>Each conversation can then either handle the update, or it can call <code>await conversation<wbr>.skip()</code>. In the former case, the update will simply be consumed while the conversation is handling it. In the latter case, the conversation will effectively undo receiving the update, and pass it on to the next conversation. If all conversations skip an update, the control flow will be passed back to the middleware system, and run any subsequent handlers.</p><p>This allows you to start a new conversation from the regular middleware.</p><h3 id="how-you-can-use-it" tabindex="-1"><a class="header-anchor" href="#how-you-can-use-it" aria-hidden="true">#</a> How You Can Use It</h3><p>In practice, you never really need to call <code>await conversation<wbr>.skip()</code> at all. Instead, you can just use things like <code>await conversation<wbr>.wait<wbr>From(user<wbr>Id)</code>, which will take care of the details for you. This allows you to chat with a single user only in a group chat.</p><p>For instance, let\u2019s implement the captcha example from up here again, but this time with parallel conversations.</p>',11),Ls=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"captcha"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("from "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token keyword"},"undefined"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Prove you are human! What is the answer to everything?"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" message "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"waitFrom"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("from"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"return"),s(" message"),n("span",{class:"token operator"},"?."),s("text "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},'"42"'),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"enterGroup"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token operator"},":"),s(" MyConversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token operator"},":"),s(" MyContext"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" ok "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"captcha"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ok"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Welcome!"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"banChatMember"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"\xA0"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Ps=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"captcha"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("from "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token keyword"},"undefined"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Prove you are human! What is the answer to everything?"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" message "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" conversation"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"waitFrom"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("from"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"return"),s(" message"),n("span",{class:"token operator"},"?."),s("text "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},'"42"'),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"enterGroup"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" ok "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"captcha"),n("span",{class:"token punctuation"},"("),s("conversation"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ok"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Welcome!"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"banChatMember"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"\xA0"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Rs=c(`<p>Note how we only wait for messages from a particular user.</p><p>We can now have a simple handler that enters the conversation when a new member joins.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;chat_member&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>chatMember<span class="token punctuation">.</span>old_chat_member<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>chatMember<span class="token punctuation">.</span>new_chat_member<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">&quot;member&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;enterGroup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="inspecting-active-conversations" tabindex="-1"><a class="header-anchor" href="#inspecting-active-conversations" aria-hidden="true">#</a> Inspecting Active Conversations</h3><p>You can see how many conversations with which identifier are running.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> stats <span class="token operator">=</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span>active<span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stats<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { &quot;enterGroup&quot;: 1 }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>This will be provided as an object that has the conversation identifiers as keys, and a number indicating the number of running conversations for each identifier.</p><h2 id="how-it-works" tabindex="-1"><a class="header-anchor" href="#how-it-works" aria-hidden="true">#</a> How It Works</h2><blockquote><p><a href="#three-golden-rules-of-conversations">Remember</a> that the code inside your conversation builder functions must follow three rules. We are now going to see <em>why</em> you need to build them that way.</p></blockquote><p>We are first going to see how this plugin works conceptually, before we elaborate on some details.</p><h3 id="how-wait-calls-work" tabindex="-1"><a class="header-anchor" href="#how-wait-calls-work" aria-hidden="true">#</a> How <code>wait</code> Calls Work</h3><p>Let us switch perspectives for a while, and ask a question from a plugin developer\u2019s point of view. How to implement a <code>wait</code> call in the plugin?</p><p>The na\xEFve approach to implementing a <code>wait</code> call in the conversations plugin would be to create a new promise, and to wait until the next context object arrives. As soon as it does, we resolve the promise, and the conversation can continue.</p><p>However, this is a bad idea for several reasons.</p><p><strong>Data Loss.</strong> What if your server crashes while waiting for a context object? In that case, we lose all information about the state of the conversation. Basically, the bot loses its train of thought, and the user has to start over. This is a bad and annoying design.</p><p><strong>Blocking.</strong> If wait calls would block until the next update arrives, it means that the middleware execution for the first update can\u2019t complete until the entire conversation completes.</p>`,16),Gs=n("li",null,"For built-in polling, this means that no further updates can be processed until the current one is done. Hence, the bot would simply be blocked forever.",-1),Ys=s("For "),Ns=s("grammY runner"),Es=s(", the bot would not be blocked. However, when processing thousands of conversations in parallel with different users, it would consume potentially very large amounts of memory. If many users stop responding, this leaves the bot stuck in the middle of countless conversations."),$s=s("Webhooks have their own whole "),zs=s("category of problems"),Vs=s(" with long-running middleware."),Us=c(`<p><strong>State.</strong> On serverless infrastructure such as cloud functions, we cannot actually assume that the same instance handles two subsequent updates from the same user. Hence, if we were to create stateful conversations, they may randomly break all the time, as some <code>wait</code> calls don\u2019t resolve, but some other middleware is suddenly executed. The result is an abundance of random bugs and chaos.</p><p>There are more problems, but you get the idea.</p><p>Consequently, the conversations plugin does things differently. Very differently. As mentioned earlier, <strong>they don\u2019t <em>literally</em> make your bot wait</strong>, even though we can program conversations as if that was the case.</p><p>The conversations plugin tracks the execution of your function. When a wait call is reached, it serializes the state of execution into the session, and safely stores it in a database. When the next update arrives, it first inspects the session data. If it finds that it left off in the middle of a conversation, it deserializes the state of execution, takes your conversation builder function, and replays it up to the point of the last <code>wait</code> call. It then resumes ordinary execution of your function\u2014until the next <code>wait</code> call is reached, and the execution must be halted again.</p><p>What do we mean by the state of execution? In a nutshell, it consists on three things:</p><ol><li>Incoming updates</li><li>Outgoing API calls</li><li>External events and effects, such as randomness or calls to external APIs or databases</li></ol><p>What do we mean by replaying? Replaying simply means calling the function regularly from the start, but when it does things like calling <code>wait</code> or performing API calls, we don\u2019t actually do any of those. Instead, we check out or logs where we recorded from a previous run which values were returned. We then inject these values so that the conversation builder function simply runs through very fast\u2014until our logs are exhausted. At that point, we switch back to normal execution mode, which is just a fancy way of saying that we stop injecting stuff, and start to actually perform API calls again.</p><p>This is why the plugin has to track all incoming updates as well as all Bot API calls. (See points 1 and 2 above.) However, the plugin has no control over external events, side-effects, or randomness. For example, you could this:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// do one thing</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// do another thing</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In that case, when calling the function, it may suddenly behave differently every time, so replaying the function will break! It could randomly work differently than the original execution. This is why point 3 exists, and the <a href="#three-golden-rules-of-conversations">Three Golden Rules</a> must be followed.</p><h3 id="how-to-intercept-function-execution" tabindex="-1"><a class="header-anchor" href="#how-to-intercept-function-execution" aria-hidden="true">#</a> How to Intercept Function Execution</h3>`,11),Qs=s("Conceptually speaking, the keywords "),Ks=n("code",null,"async",-1),Xs=s(" and "),Zs=n("code",null,"await",-1),na=s(" give us control over where the thread is "),sa={href:"https://en.wikipedia.org/wiki/Preemption_(computing)",target:"_blank",rel:"noopener noreferrer"},aa=s("preempted"),ta=s(". Hence, if someone calls "),ea=n("code",null,[s("await conversation"),n("wbr"),s(".wait()")],-1),oa=s(", which is a function of our library, we are given the power to preempt the execution."),ca=c(`<p>Concretely speaking, the secret core primitive that enables us to interrupt function execution is a <code>Promise</code> that never resolves.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">never</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// BOOM</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>If you <code>await</code> such a promise in any JavaScript file, your runtime will terminate instantly. (Feel free to paste the above code into a file and try it out.)</p><p>Since we obviously don\u2019t want to kill the JS runtime, we have to catch this again. How would you go about this? (Feel free to check out the plugin\u2019s source code if this isn\u2019t immediately obvious to you.)</p><h2 id="plugin-summary" tabindex="-1"><a class="header-anchor" href="#plugin-summary" aria-hidden="true">#</a> Plugin Summary</h2>`,5),ia=n("li",null,[s("Name: "),n("code",null,"conversations")],-1),pa=s("Source: "),la={href:"https://github.com/grammyjs/conversations",target:"_blank",rel:"noopener noreferrer"},ua=s("https://"),ra=n("wbr",null,null,-1),ka=s("github"),da=n("wbr",null,null,-1),ma=s(".com"),va=n("wbr",null,null,-1),ha=s("/grammyjs"),ba=n("wbr",null,null,-1),ya=s("/conversations"),wa=s("Reference: "),fa={href:"https://doc.deno.land/https://deno.land/x/grammy_conversations/mod.ts",target:"_blank",rel:"noopener noreferrer"},ga=c("https://<wbr>doc<wbr>.deno<wbr>.land<wbr>/https://<wbr>deno<wbr>.land<wbr>/x<wbr>/grammy<wbr>_conversations<wbr>/mod<wbr>.ts",23);function _a(xa,Ca){const u=l("Tag"),r=l("TagGroup"),i=l("RouterLink"),e=l("CodeGroupItem"),o=l("CodeGroup"),p=l("ExternalLinkIcon");return d(),m("div",null,[h,a(r,null,{default:t(()=>[a(u,{type:"official",desc:"This plugin is published and maintained by grammY"})]),_:1}),b,y,w,f,n("p",null,[g,a(i,{to:"/guide/middleware.html"},{default:t(()=>[_]),_:1}),x,a(i,{to:"/guide/context.html"},{default:t(()=>[C]),_:1}),j]),I,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[T]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[M]),_:1}),a(e,{title:"Deno"},{default:t(()=>[q]),_:1})]),_:1}),S,n("p",null,[F,A,W,B,a(i,{to:"/guide/context.html#customizing-the-context-object"},{default:t(()=>[H]),_:1}),O,J,D,a(i,{to:"/guide/context.html#additive-context-flavors"},{default:t(()=>[L]),_:1}),P,R,G]),n("p",null,[Y,N,E,$,z,V,n("a",U,[Q,a(p)]),K,X,Z,a(i,{to:"/guide/context.html#customizing-the-context-object"},{default:t(()=>[nn]),_:1}),sn,an,tn]),en,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[on]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[cn]),_:1})]),_:1}),pn,ln,n("p",null,[un,rn,kn,a(i,{to:"/plugins/session.html"},{default:t(()=>[dn]),_:1}),mn]),vn,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[hn]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[bn]),_:1}),a(e,{title:"Deno"},{default:t(()=>[yn]),_:1})]),_:1}),wn,fn,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[gn]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[_n]),_:1})]),_:1}),xn,n("p",null,[Cn,a(i,{to:"/guide/errors.html"},{default:t(()=>[jn]),_:1}),In]),Tn,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[Mn]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[qn]),_:1})]),_:1}),Sn,Fn,An,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[Wn]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[Bn]),_:1})]),_:1}),n("p",null,[Hn,n("a",On,[Jn,a(p)]),Dn]),n("p",null,[Ln,a(i,{to:"/guide/middleware.html"},{default:t(()=>[Pn]),_:1}),Rn]),Gn,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[Yn]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[Nn]),_:1})]),_:1}),n("p",null,[En,$n,zn,Vn,Un,a(i,{to:"/guide/filter-queries.html"},{default:t(()=>[Qn]),_:1}),Kn,n("a",Xn,[Zn,a(p)]),ns]),a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[ss]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[as]),_:1})]),_:1}),n("p",null,[ts,n("a",es,[os,a(p)]),cs,is,ps]),ls,n("p",null,[us,rs,ks,n("a",ds,[ms,a(p)]),vs]),hs,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[bs]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[ys]),_:1})]),_:1}),ws,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[fs]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[gs]),_:1})]),_:1}),_s,n("p",null,[xs,a(i,{to:"/guide/errors.html"},{default:t(()=>[Cs]),_:1}),js]),Is,Ts,Ms,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[qs]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[Ss]),_:1})]),_:1}),Fs,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[As]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[Ws]),_:1})]),_:1}),n("p",null,[Bs,n("a",Hs,[Os,a(p)]),Js]),Ds,a(o,null,{default:t(()=>[a(e,{title:"TypeScript",active:""},{default:t(()=>[Ls]),_:1}),a(e,{title:"JavaScript"},{default:t(()=>[Ps]),_:1})]),_:1}),Rs,n("ul",null,[Gs,n("li",null,[Ys,a(i,{to:"/plugins/runner.html"},{default:t(()=>[Ns]),_:1}),Es]),n("li",null,[$s,a(i,{to:"/guide/deployment-types.html#ending-webhook-requests-in-time"},{default:t(()=>[zs]),_:1}),Vs])]),Us,n("p",null,[Qs,Ks,Xs,Zs,na,n("a",sa,[aa,a(p)]),ta,ea,oa]),ca,n("ul",null,[ia,n("li",null,[pa,n("a",la,[ua,ra,ka,da,ma,va,ha,ba,ya,a(p)])]),n("li",null,[wa,n("a",fa,[ga,a(p)])])])])}const Ia=k(v,[["render",_a],["__file","conversations.html.vue"]]);export{Ia as default};
