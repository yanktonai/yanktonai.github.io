import{_ as i,r as c,o as l,c as u,a as n,b as a,w as p,d as s,e as o}from"./app.ff0cf306.js";const r={},d=n("h1",{id:"grammy-\u63D2\u4EF6\u7684\u642D\u4FBF\u8F66\u6307\u5357",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#grammy-\u63D2\u4EF6\u7684\u642D\u4FBF\u8F66\u6307\u5357","aria-hidden":"true"},"#"),s(" grammy \u63D2\u4EF6\u7684\u642D\u4FBF\u8F66\u6307\u5357")],-1),k=n("p",null,"\u5982\u679C\u4F60\u60F3\u5F00\u53D1\u81EA\u5DF1\u7684\u63D2\u4EF6\u5E76\u53D1\u5E03\u5B83\uFF0C\u6216\u8005\u4F60\u60F3\u77E5\u9053 grammY \u63D2\u4EF6\u5728\u5E55\u540E\u662F\u5982\u4F55\u5DE5\u4F5C\u7684\uFF0C\u8FD9\u5C31\u662F\u4F60\u8981\u6765\u7684\u5730\u65B9\uFF01",-1),m=s("\u8BF7\u6CE8\u610F\uFF0C\u5DF2\u7ECF\u6709\u4E00\u4E2A\u5173\u4E8E "),_=s("grammY \u63D2\u4EF6"),h=s(" \u662F\u4EC0\u4E48\u4EE5\u53CA\u5B83\u4EEC\u505A\u4EC0\u4E48\u7684\u6982\u8981\u3002 \u8FD9\u7BC7\u6587\u7AE0\u662F\u5173\u4E8E\u5B83\u4EEC\u5185\u90E8\u5DE5\u4F5C\u7684\u6DF1\u5165\u63A2\u7D22\u3002"),v=n("h2",{id:"grammy-\u4E2D\u7684\u63D2\u4EF6\u7C7B\u578B",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#grammy-\u4E2D\u7684\u63D2\u4EF6\u7C7B\u578B","aria-hidden":"true"},"#"),s(" grammY \u4E2D\u7684\u63D2\u4EF6\u7C7B\u578B")],-1),b=n("p",null,"grammY \u4E2D\u4E3B\u8981\u6709\u4E24\u79CD\u7C7B\u578B\u7684\u63D2\u4EF6\uFF1A",-1),g=s("\u4E2D\u95F4\u4EF6\u63D2\u4EF6\uFF1A\u8BE5\u63D2\u4EF6\u7684\u552F\u4E00\u5DE5\u4F5C\u662F\u8FD4\u56DE\u4E00\u4E2A "),y=s("\u4E2D\u95F4\u4EF6\u51FD\u6570"),f=s("\uFF0C\u53EF\u4EE5\u5582\u7ED9 grammY bot\u3002"),w=s("\u8F6C\u5316\u5668\u63D2\u4EF6\uFF1A\u8BE5\u63D2\u4EF6\u7684\u552F\u4E00\u5DE5\u4F5C\u662F\u8FD4\u56DE\u4E00\u4E2A "),x=s("\u8F6C\u6362\u5668\u51FD\u6570"),q=s("\uFF0C\u53EF\u4EE5\u5582\u7ED9 grammY bot\u3002"),j=n("p",null,"\u7136\u800C\uFF0C\u6709\u65F6\u5019\u4F60\u4F1A\u53D1\u73B0\u63D2\u4EF6\u540C\u65F6\u505A\u8FD9\u4E24\u4EF6\u4E8B\u3002 \u8FD8\u6709\u4E00\u4E9B\u8F6F\u4EF6\u5305\u65E2\u4E0D\u662F\u4E2D\u95F4\u4EF6\uFF0C\u4E5F\u4E0D\u662F\u8F6C\u5316\u5668\u51FD\u6570\uFF0C\u4F46\u6211\u4EEC\u8FD8\u662F\u79F0\u5B83\u4EEC\u4E3A\u63D2\u4EF6\uFF0C\u56E0\u4E3A\u5B83\u4EEC\u4EE5\u5404\u79CD\u65B9\u5F0F\u6269\u5C55\u4E86 grammY\u3002",-1),D=n("h2",{id:"\u8D21\u732E\u89C4\u5219",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u8D21\u732E\u89C4\u5219","aria-hidden":"true"},"#"),s(" \u8D21\u732E\u89C4\u5219")],-1),E=n("p",null,"\u4F60\u53EF\u4EE5\u901A\u8FC7\u4E0B\u9762\u4EFB\u610F\u4E00\u79CD\u65B9\u5F0F\u53D1\u5E03\u4F60\u7684\u63D2\u4EF6\uFF1A",-1),A=n("ul",null,[n("li",null,[s("\u4F5C\u4E3A"),n("strong",null,"\u5B98\u65B9"),s("\u63D2\u4EF6\u53D1\u5E03\u3002")]),n("li",null,[s("\u4F5C\u4E3A"),n("strong",null,"\u7B2C\u4E09\u65B9"),s("\u63D2\u4EF6\u53D1\u5E03\u3002")])],-1),C=s("\u5982\u679C\u4F60\u9009\u62E9\u4EE5\u7B2C\u4E09\u65B9\u7684\u65B9\u5F0F\u53D1\u5E03\u63D2\u4EF6\uFF0C\u6211\u4EEC\u4ECD\u7136\u53EF\u4EE5\u5728\u672C\u7F51\u7AD9\u4E0A\u4E3A\u4F60\u63D0\u4F9B\u4E00\u4E2A\u7A81\u51FA\u7684\u4F4D\u7F6E\u3002 \u4F46\u662F\uFF0C\u6211\u4EEC\u66F4\u5E0C\u671B\u4F60\u5728 GitHub \u4E0A\u7684 "),Y={href:"https://github.com/grammyjs",target:"_blank",rel:"noopener noreferrer"},N=s("grammyjs \u7EC4\u7EC7"),I=s(" \u4E0B\u53D1\u5E03\u4F60\u7684\u63D2\u4EF6\uFF0C\u4ECE\u800C\u4F7F\u5176\u6210\u4E3A\u4E00\u4E2A\u5B98\u65B9\u63D2\u4EF6\u3002 \u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u4F60\u5C06\u88AB\u6388\u4E88 GitHub \u548C npm \u7684\u53D1\u5E03\u6743\u9650\u3002 \u6B64\u5916\uFF0C\u4F60\u8FD8\u5C06\u8D1F\u8D23\u7EF4\u62A4\u4F60\u7684\u4EE3\u7801\u3002"),T=n("p",null,"\u5728\u6DF1\u5165\u7814\u7A76\u4E00\u4E9B\u5B9E\u8DF5\u6848\u4F8B\u4E4B\u524D\uFF0C\u5982\u679C\u4F60\u60F3\u8BA9\u4F60\u7684\u63D2\u4EF6\u5728\u8FD9\u4E2A\u7F51\u7AD9\u4E0A\u5217\u51FA\uFF0C\u4F60\u9700\u8981\u6CE8\u610F\u4EE5\u4E0B\u89C4\u5219\u3002",-1),B=n("li",null,"\u5728 GitHub\uFF08\u548Cnpm\uFF09\u4E0A\u6709\u4E00\u4E2A README \u6587\u4EF6\uFF0C\u7B80\u77ED\u800C\u6E05\u6670\u5730\u63CF\u8FF0\u5982\u4F55\u4F7F\u7528\u5B83\u3002",-1),M=s("\u901A\u8FC7\u5728 "),R={href:"https://github.com/grammyjs/website",target:"_blank",rel:"noopener noreferrer"},G=s("\u6587\u6863"),H=s(" \u4E2D\u6DFB\u52A0\u4E00\u4E2A\u9875\u9762\u6765\u89E3\u91CA\u4F60\u7684\u63D2\u4EF6\u7684\u76EE\u7684\u4EE5\u53CA\u5982\u4F55\u4F7F\u7528\u5B83\u3002 \uFF08\u5982\u679C\u4F60\u4E0D\u786E\u5B9A\u600E\u4E48\u505A\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4E3A\u4F60\u505A\u8FD9\u4EF6\u4E8B\u3002\uFF09"),L=n("li",null,"\u9009\u62E9\u4E00\u4E2A\u8BB8\u53EF\u8BC1\uFF0C\u6BD4\u5982 MIT \u6216 ISC\u3002",-1),S=s("\u6700\u540E\uFF0C\u4F60\u5E94\u8BE5\u77E5\u9053\uFF0C\u5C3D\u7BA1 grammY \u540C\u65F6\u652F\u6301 Node.js \u548C "),V={href:"https://deno.land/",target:"_blank",rel:"noopener noreferrer"},z=s("Deno"),F=s("\uFF0C\u4F46\u5B83\u662F\u4E00\u4E2A Deno \u4F18\u5148\u7684\u9879\u76EE\uFF0C\u6211\u4EEC\u4E5F\u9F13\u52B1\u4F60\u4E3A Deno \u7F16\u5199\u4F60\u7684\u63D2\u4EF6\uFF08\u548C\u5728\u98CE\u683C\u4E0A\uFF09\u3002 \u6709\u4E00\u4E2A\u53EF\u4EE5\u8F6C\u6362 Deno \u4EE3\u7801\u5230 Node.js \u7684\u5DE5\u5177\uFF0C\u53EB\u505A "),P={href:"https://github.com/wojpawlik/deno2node",target:"_blank",rel:"noopener noreferrer"},W=s("deno2node"),$=s("\uFF0C\u6240\u4EE5\u6211\u4EEC\u53EF\u4EE5\u540C\u65F6\u652F\u6301\u8FD9\u4E24\u4E2A\u5E73\u53F0\u3002 Deno \u652F\u6301\u53EA\u662F\u5BF9\u5B98\u65B9\u63D2\u4EF6\u7684\u4E25\u683C\u8981\u6C42\uFF0C\u800C\u4E0D\u662F\u5BF9\u7B2C\u4E09\u65B9\u63D2\u4EF6\u7684\u3002 \u5C3D\u7BA1\u5982\u6B64\uFF0C\u6211\u4EEC\u8FD8\u662F\u975E\u5E38\u9F13\u52B1\u4F60\u53BB\u5C1D\u8BD5\u4E00\u4E0B Deno\u3002 \u7528\u8FC7\u90FD\u8BF4\u597D\u3002"),J=o(`<h2 id="\u8BBE\u8BA1\u4E00\u4E2A\u865A\u62DF\u7684\u4E2D\u95F4\u4EF6\u63D2\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u8BBE\u8BA1\u4E00\u4E2A\u865A\u62DF\u7684\u4E2D\u95F4\u4EF6\u63D2\u4EF6" aria-hidden="true">#</a> \u8BBE\u8BA1\u4E00\u4E2A\u865A\u62DF\u7684\u4E2D\u95F4\u4EF6\u63D2\u4EF6</h2><p>\u8BA9\u6211\u4EEC\u5047\u8BBE\u6211\u4EEC\u60F3\u8BBE\u8BA1\u4E00\u4E2A\u53EA\u54CD\u5E94\u67D0\u4E9B\u7279\u5B9A\u7528\u6237\u7684\u63D2\u4EF6\uFF01 \u4F8B\u5982\uFF0C\u6211\u4EEC\u53EF\u4EE5\u51B3\u5B9A\u53EA\u54CD\u5E94\u7528\u6237\u7684\u540D\u5B57\u4E2D\u5305\u542B\u7279\u5B9A\u5B57\u7B26\u7684\u4EBA\u3002 \u8FD9\u4E2A bot \u5C06\u7B80\u5355\u5730\u62D2\u7EDD\u4E3A\u5176\u4ED6\u4EBA\u670D\u52A1\u3002</p><p>\u4E0B\u9762\u662F\u4E00\u4E2A\u865A\u62DF\u7684\u793A\u4F8B\uFF1A</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// plugin.ts</span>
<span class="token comment">// \u4ECE grammY \u4E2D\u5BFC\u5165\u7C7B\u578B\uFF08\u6211\u4EEC\u5728 \`deps.deno.ts\` \u4E2D\u91CD\u65B0\u5BFC\u51FA\u4E86\u5B83\u4EEC\uFF09\u3002</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> Context<span class="token punctuation">,</span> Middleware<span class="token punctuation">,</span> NextFunction <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./deps.deno.ts&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// \u4F60\u7684\u63D2\u4EF6\u53EF\u4EE5\u6709\u4E00\u4E2A\u521B\u5EFA\u4E2D\u95F4\u4EF6\u7684\u4E3B\u51FD\u6570\u3002</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">onlyAccept</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">C</span> <span class="token keyword">extends</span> Context<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>str<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Middleware<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u521B\u5EFA\u5E76\u8FD4\u56DE\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u3002</span>
  <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u83B7\u53D6\u7528\u6237\u7684\u540D\u5B57\u3002</span>
    <span class="token keyword">const</span> name <span class="token operator">=</span> ctx<span class="token punctuation">.</span>from<span class="token operator">?.</span>first_name<span class="token punctuation">;</span>
    <span class="token comment">// \u901A\u8FC7\u6240\u6709\u5339\u914D\u7684 updates\u3002</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> name<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u5C06\u63A7\u5236\u6D41\u4F20\u9012\u7ED9\u4E0B\u6E38\u7684\u4E2D\u95F4\u4EF6\u3002</span>
      <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u544A\u8BC9\u4ED6\u4EEC\u6211\u4EEC\u4E0D\u559C\u6B22\u4ED6\u4EEC\u3002</span>
      <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">I&#39;m not talking to you! You don&#39;t care about </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>str<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u73B0\u5728\uFF0C\u5B83\u53EF\u4EE5\u5728\u771F\u6B63\u7684 bot \u4E2D\u4F7F\u7528\uFF1A</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> onlyAccept <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./testing.ts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Bot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./deps.deno.ts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bot</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &lt;-- \u628A\u4F60\u7684 bot token \u653E\u8FD9\u91CC\u3002</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">onlyAccept</span><span class="token punctuation">(</span><span class="token string">&quot;grammY&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;You passed the middleware plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Voil\xE0! \u4F60\u5F97\u5230\u4E86\u4E00\u4E2A\u63D2\u4EF6\uFF0C\u5BF9\u5427\uFF1F \u5BF9\uFF0C\u4F46\u8FD9\u4E48\u5FEB\u3002 \u6211\u4EEC\u8FD8\u9700\u8981\u6253\u5305\u5B83\uFF0C\u4F46\u5728\u8FD9\u4E4B\u524D\uFF0C\u6211\u4EEC\u5148\u770B\u4E00\u4E0B\u8F6C\u6362\u5668\u63D2\u4EF6\u3002</p><h2 id="\u8BBE\u8BA1\u4E00\u4E2A\u865A\u62DF\u7684\u8F6C\u6362\u5668\u63D2\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u8BBE\u8BA1\u4E00\u4E2A\u865A\u62DF\u7684\u8F6C\u6362\u5668\u63D2\u4EF6" aria-hidden="true">#</a> \u8BBE\u8BA1\u4E00\u4E2A\u865A\u62DF\u7684\u8F6C\u6362\u5668\u63D2\u4EF6</h2>`,8),K=s("\u60F3\u8C61\u4E00\u4E0B\uFF0C\u5199\u4E00\u4E2A\u63D2\u4EF6\uFF0C\u6BCF\u5F53 bot \u53D1\u9001\u6587\u4EF6\u65F6\uFF0C\u81EA\u52A8\u53D1\u9001\u76F8\u5E94\u7684 "),O={href:"https://core.telegram.org/bots/api#sendchataction",target:"_blank",rel:"noopener noreferrer"},Q=s("\u804A\u5929\u52A8\u4F5C"),U=s("\u3002 \u8FD9\u610F\u5473\u7740\u5F53\u4F60\u7684 bot \u5728\u53D1\u9001\u6587\u4EF6\u65F6\uFF0C\u7528\u6237\u4F1A\u81EA\u52A8\u770B\u5230 \u201C"),X=n("em",null,"sending file\u2026",-1),Z=s("\u201D \u4F5C\u4E3A\u72B6\u6001\u3002 \u5F88\u9177\uFF0C\u5BF9\u5417\uFF1F"),nn=o(`<div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// plugin.ts</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> Transformer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./deps.deno.ts&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// \u51FD\u6570\u7684\u4E3B\u8981\u529F\u80FD</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">autoChatAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Transformer <span class="token punctuation">{</span>
  <span class="token comment">// \u521B\u5EFA\u5E76\u8FD4\u56DE\u4E00\u4E2A\u8F6C\u6362\u5668\u51FD\u6570\u3002</span>
  <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>prev<span class="token punctuation">,</span> method<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> signal<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u4FDD\u5B58\u5DF2\u8BBE\u5B9A\u7684\u65F6\u95F4\u95F4\u9694\u7684 handle\uFF0C\u4EE5\u4FBF\u6211\u4EEC\u7A0D\u540E\u53EF\u4EE5\u6E05\u9664\u5B83\u3002</span>
    <span class="token keyword">let</span> handle<span class="token operator">:</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> setTimeout<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>method <span class="token operator">===</span> <span class="token string">&quot;sendDocument&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;chat_id&quot;</span> <span class="token keyword">in</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u6211\u4EEC\u73B0\u5728\u77E5\u9053\uFF0C\u4E00\u4EFD\u6587\u4EF6\u6B63\u5728\u88AB\u53D1\u9001\u3002</span>
      <span class="token keyword">const</span> actionPayload <span class="token operator">=</span> <span class="token punctuation">{</span>
        chat_id<span class="token operator">:</span> payload<span class="token punctuation">.</span>chat_id<span class="token punctuation">,</span>
        action<span class="token operator">:</span> <span class="token string">&quot;upload_document&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token comment">// \u5728\u4E0A\u4F20\u6587\u4EF6\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u91CD\u590D\u8BBE\u7F6E\u804A\u5929\u52A8\u4F5C\u3002</span>
      handle <span class="token operator">??=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">prev</span><span class="token punctuation">(</span><span class="token string">&quot;sendChatAction&quot;</span><span class="token punctuation">,</span> actionPayload<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token builtin">console</span><span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u4ECE bot \u4E2D\u8FD0\u884C\u5B9E\u9645\u7684\u65B9\u6CD5\u3002</span>
      <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">prev</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> signal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u6E05\u9664\u95F4\u9694\uFF0C\u4EE5\u4FBF\u6211\u4EEC\u505C\u6B62\u5411\u5BA2\u6237\u7AEF\u53D1\u9001\u804A\u5929\u52A8\u4F5C\u3002</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u73B0\u5728\uFF0C\u5B83\u53EF\u4EE5\u5728\u771F\u6B63\u7684 bot \u4E2D\u4F7F\u7528\uFF1A</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Bot<span class="token punctuation">,</span> InputFile <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./deps.deno.ts&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// \u8BE5\u63D2\u4EF6\u7684\u4EE3\u7801\u5728\u4E00\u4E2A\u540D\u4E3A \`plugin.ts\` \u7684\u6587\u4EF6\u4E2D\u3002</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> autoChatAction <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./plugin.ts&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// \u521B\u5EFA\u4E00\u4E2A bot \u5B9E\u4F8B\u3002</span>
<span class="token keyword">const</span> bot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bot</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &lt;-- \u628A\u4F60\u7684 bot token \u653E\u8FD9\u91CC\u3002</span>
<span class="token comment">// \u4F7F\u7528\u63D2\u4EF6\u3002</span>
bot<span class="token punctuation">.</span>api<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">autoChatAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span><span class="token function">hears</span><span class="token punctuation">(</span><span class="token string">&quot;send me a document&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u5982\u679C\u7528\u6237\u53D1\u9001\u8FD9\u4E2A\u547D\u4EE4\uFF0C\u6211\u4EEC\u5C06\u5411\u4ED6\u53D1\u9001\u4E00\u4E2A pdf \u6587\u4EF6\uFF08\u7528\u4E8E\u6F14\u793A\uFF09\u3002</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">replyWithDocument</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputFile</span><span class="token punctuation">(</span><span class="token string">&quot;/tmp/document.pdf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u542F\u52A8 bot</span>
bot<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u73B0\u5728\uFF0C\u6BCF\u6B21\u6211\u4EEC\u53D1\u9001\u6587\u4EF6\u65F6\uFF0C<code>upload<wbr>_document</code> \u804A\u5929\u52A8\u4F5C\u5C06\u88AB\u53D1\u9001\u5230\u6211\u4EEC\u7684\u5BA2\u6237\u7AEF\u3002 \u8BF7\u6CE8\u610F\uFF0C\u8FD9\u662F\u4E3A\u4E86\u6F14\u793A\u76EE\u7684\u3002 Telegram \u5EFA\u8BAE\u53EA\u6709\u5728 \u201Cbot \u7684\u54CD\u5E94\u9700\u8981<strong>\u660E\u663E</strong>\u7684\u65F6\u95F4\u624D\u80FD\u5230\u8FBE\u65F6\u201D \u624D\u4F7F\u7528\u804A\u5929\u52A8\u4F5C\u3002 \u5982\u679C\u6587\u4EF6\u975E\u5E38\u5C0F\uFF0C\u4F60\u53EF\u80FD\u5B9E\u9645\u4E0A\u4E0D\u9700\u8981\u8BBE\u7F6E\u72B6\u6001\uFF0C\u6240\u4EE5\u8FD9\u91CC\u53EF\u4EE5\u505A\u4E00\u4E9B\u4F18\u5316\u3002</p><h2 id="\u63D0\u53D6\u5230\u4E00\u4E2A\u63D2\u4EF6\u4E2D" tabindex="-1"><a class="header-anchor" href="#\u63D0\u53D6\u5230\u4E00\u4E2A\u63D2\u4EF6\u4E2D" aria-hidden="true">#</a> \u63D0\u53D6\u5230\u4E00\u4E2A\u63D2\u4EF6\u4E2D</h2>`,5),sn=s("\u65E0\u8BBA\u4F60\u505A\u7684\u662F\u54EA\u79CD\u7C7B\u578B\u7684\u63D2\u4EF6\uFF0C\u4F60\u90FD\u9700\u8981\u628A\u5B83\u6253\u5305\u6210\u4E00\u4E2A\u72EC\u7ACB\u7684\u5305\u3002 \u8FD9\u662F\u4E00\u4E2A\u76F8\u5F53\u7B80\u5355\u7684\u4EFB\u52A1\u3002 \u5173\u4E8E\u5982\u4F55\u505A\u5230\u8FD9\u4E00\u70B9\u6CA1\u6709\u5177\u4F53\u7684\u89C4\u5219\uFF0Cnpm \u662F\u4F60\u81EA\u5DF1\u7684\uFF0C\u4F46\u4E3A\u4E86\u8BA9\u4E8B\u60C5\u6709\u6761\u7406\uFF0C\u6211\u4EEC\u6709\u4E00\u4E2A\u6A21\u677F\u5EFA\u8BAE\u7ED9\u4F60\u3002 \u4F60\u53EF\u4EE5\u4ECE "),an={href:"https://github.com/grammyjs/plugin-template",target:"_blank",rel:"noopener noreferrer"},tn=s("\u6211\u4EEC\u5728 Git"),on=n("wbr",null,null,-1),en=s("Hub \u4E0A\u7684\u63D2\u4EF6\u6A21\u677F\u5E93"),pn=s(" \u4E2D\u4E0B\u8F7D\u4EE3\u7801\uFF0C\u5E76\u5F00\u59CB\u5F00\u53D1\u4F60\u7684\u63D2\u4EF6\uFF0C\u4E0D\u7528\u6D88\u8017\u4EFB\u4F55\u65F6\u95F4\u5728\u914D\u7F6E\u4E0A\u3002"),cn=n("p",null,"\u5EFA\u8BAE\u7684\u521D\u59CB\u5316\u6587\u4EF6\u5939\u7ED3\u6784\uFF1A",-1),ln=n("div",{class:"language-asciiart ext-asciiart"},[n("pre",{class:"language-asciiart"},[n("code",null,`plugin-template/
\u251C\u2500 src/
\u2502  \u251C\u2500 deps.deno.ts
\u2502  \u251C\u2500 deps.node.ts
\u2502  \u2514\u2500 index.ts
\u251C\u2500 package.json
\u251C\u2500 tsconfig.json
\u2514\u2500 README.md
`)])],-1),un=o("<strong><code>deps<wbr>.deno<wbr>.ts</code> \u548C <code>deps<wbr>.node<wbr>.ts</code></strong>\uFF1A\u8FD9\u662F\u4E3A\u90A3\u4E9B\u613F\u610F\u4E3A Deno \u7F16\u5199\u63D2\u4EF6\uFF0C\u7136\u540E\u5C06\u5176\u8F6C\u8BD1\u4E3A Node.js \u7684\u5F00\u53D1\u8005\u51C6\u5907\u7684\u3002 \u6B63\u5982\u524D\u9762\u63D0\u5230\u7684\uFF0C\u6211\u4EEC\u4F7F\u7528 <code>deno2node</code> \u5C06 Deno \u7684\u4EE3\u7801\u8F6C\u8BD1\u4E3A Node.js\u3002 <code>deno2node</code> \u6709\u4E00\u4E2A\u7279\u6027\uFF0C\u5141\u8BB8\u4F60\u5411\u5B83\u63D0\u4F9B\u8FD0\u884C\u65F6\u7684\u7279\u5B9A\u6587\u4EF6\u3002 \u8FD9\u4E9B\u6587\u4EF6\u5E94\u8BE5\u662F\u76F8\u90BB\u7684\uFF0C\u5E76\u4E14\u6309\u7167\u5982 ",6),rn={href:"https://github.com/wojpawlik/deno2node#runtime-specific-code",target:"_blank",rel:"noopener noreferrer"},dn=s("\u6587\u6863\u4E2D\u89E3\u91CA"),kn=o(" \u7684 <code>*<wbr>.deno<wbr>.ts</code> \u548C <code>*<wbr>.node<wbr>.ts</code> \u7684\u540D\u79F0\u7ED3\u6784\u6765\u547D\u540D\u3002 \u8FD9\u5C31\u662F\u4E3A\u4EC0\u4E48\u8FD9\u91CC\u6709\u4E24\u4E2A\u6587\u4EF6\uFF1A<code>deps<wbr>.deno<wbr>.ts</code> \u548C <code>deps<wbr>.node<wbr>.ts</code>\u3002 \u5982\u679C\u6709\u4EFB\u4F55 Node.js \u7279\u5B9A\u7684\u4F9D\u8D56\u9879\uFF0C\u8BF7\u653E\u5728 <code>deps<wbr>.node<wbr>.ts</code> \u4E2D\uFF0C\u5426\u5219\uFF0C\u8BF7\u8BA9\u5B83\u4FDD\u6301\u7A7A\u767D\u3002",11),mn=n("em",null,[n("strong",null,"\u6CE8\u610F")],-1),_n=s("\uFF1A\u4F60\u4E5F\u53EF\u4EE5\u4F7F\u7528\u5176\u4ED6\u5DE5\u5177\uFF0C\u4F8B\u5982 "),hn={href:"https://github.com/denoland/dnt",target:"_blank",rel:"noopener noreferrer"},vn=s("deno dnt"),bn=s(" \u6765\u8F6C\u8BD1\u4F60\u7684 Deno \u4EE3\u7801\u6216\u4F7F\u7528\u5176\u4ED6\u6587\u4EF6\u5939\u7ED3\u6784\u3002 \u4F60\u4F7F\u7528\u7684\u5DE5\u5177\u5E76\u4E0D\u91CD\u8981\uFF0C\u8FD9\u91CC\u7684\u4E3B\u8981\u76EE\u7684\u662F\u4E3A\u4E86\u66F4\u597D\u548C\u66F4\u7B80\u5355\u5730\u5199 Deno \u4EE3\u7801\u3002"),gn=o('<p><strong><code>tsconfig<wbr>.json</code></strong>\uFF1A\u8FD9\u662F TypeScript \u7F16\u8BD1\u5668\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u7528\u4E8E <code>deno2node</code> \u7684\u8F6C\u8BD1\u3002 \u4ED3\u5E93\u4E2D\u63D0\u4F9B\u4E86\u4E00\u4E2A\u9ED8\u8BA4\u7684\u914D\u7F6E\u4F5C\u4E3A\u5EFA\u8BAE\u3002 \u5B83\u4E0E Deno \u4F7F\u7528\u7684\u5185\u90E8 TypeScript \u914D\u7F6E\u76F8\u540C\uFF0C\u6211\u4EEC\u5EFA\u8BAE\u4F60\u575A\u6301\u4F7F\u7528\u5B83\u3002</p><p><strong><code>package<wbr>.json</code></strong>\uFF1A\u4F60\u7684\u63D2\u4EF6\u7684 npm \u7248\u672C\u7684 package.json \u6587\u4EF6\u3002 <strong>\u786E\u4FDD\u6839\u636E\u4F60\u7684\u9879\u76EE\u6765\u6539\u53D8\u5B83</strong>.</p><p><strong><code>README<wbr>.md</code></strong>\uFF1A\u5173\u4E8E\u5982\u4F55\u4F7F\u7528\u8BE5\u63D2\u4EF6\u7684\u8BF4\u660E\u3002 <strong>\u786E\u4FDD\u6839\u636E\u4F60\u7684\u9879\u76EE\u6765\u6539\u53D8\u5B83</strong>.</p><p><strong><code>index<wbr>.ts</code></strong>\uFF1A\u5305\u542B\u4F60\u7684\u4E1A\u52A1\u903B\u8F91\u7684\u6587\u4EF6\uFF0C\u5373\u4F60\u7684\u4E3B\u8981\u63D2\u4EF6\u4EE3\u7801\u3002</p><h2 id="\u8FD9\u91CC\u6709\u4E00\u4E2A\u6A21\u7248" tabindex="-1"><a class="header-anchor" href="#\u8FD9\u91CC\u6709\u4E00\u4E2A\u6A21\u7248" aria-hidden="true">#</a> \u8FD9\u91CC\u6709\u4E00\u4E2A\u6A21\u7248</h2>',5),yn=s("\u5982\u679C\u4F60\u60F3\u4E3A grammY \u5F00\u53D1\u4E00\u4E2A\u63D2\u4EF6\uFF0C\u4F46\u4E0D\u77E5\u9053\u4ECE\u54EA\u91CC\u5F00\u59CB\uFF0C\u6211\u4EEC\u5F3A\u70C8\u5EFA\u8BAE\u4F7F\u7528 "),fn={href:"https://github.com/grammyjs/plugin-template",target:"_blank",rel:"noopener noreferrer"},wn=s("\u6211\u4EEC\u7684\u4ED3\u5E93"),xn=s(" \u4E2D\u7684\u6A21\u677F\u4EE3\u7801\u3002 \u4F60\u53EF\u4EE5\u4E3A\u81EA\u5DF1\u514B\u9686\u4EE3\u7801\uFF0C\u5E76\u6839\u636E\u8FD9\u7BC7\u6587\u7AE0\u6240\u6D89\u53CA\u7684\u5185\u5BB9\u5F00\u59CB\u5199\u4EE3\u7801\u3002 \u8FD9\u4E2A\u4ED3\u5E93\u8FD8\u5305\u62EC\u4E00\u4E9B\u989D\u5916\u7684\u597D\u4E1C\u897F\uFF0C\u6BD4\u5982 "),qn=n("code",null,".editorconfig",-1),jn=s("\uFF0C"),Dn=n("code",null,"LICENSE",-1),En=s("\uFF0C"),An=n("code",null,".gitignore",-1),Cn=s(" \u7B49\u7B49\uFF0C\u4F46\u4F60\u53EF\u4EE5\u9009\u62E9\u5220\u9664\u5B83\u4EEC\u3002"),Yn=n("h2",{id:"\u6211\u4E0D\u559C\u6B22-deno",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u6211\u4E0D\u559C\u6B22-deno","aria-hidden":"true"},"#"),s(" \u6211\u4E0D\u559C\u6B22 Deno")],-1),Nn=n("p",null,[s("\u597D\u5427\uFF0C\u4F60\u9519\u8FC7\u4E86\u597D\u4E1C\u897F\uFF01 \u4F46\u4F60\u4E5F\u53EF\u4EE5\u53EA\u4E3A Node.js \u5199\u4F60\u7684\u63D2\u4EF6\u3002 \u4F60\u4ECD\u7136\u53EF\u4EE5\u53D1\u5E03\u63D2\u4EF6\uFF0C\u8BA9\u5B83\u4F5C\u4E3A\u7B2C\u4E09\u65B9\u63D2\u4EF6\u5217\u5728\u8FD9\u4E2A\u7F51\u7AD9\u4E0A\u3002 \u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528\u4EFB\u4F55\u4F60\u559C\u6B22\u7684\u6587\u4EF6\u5939\u7ED3\u6784\uFF08\u53EA\u8981\u5B83\u50CF\u5176\u4ED6 npm \u9879\u76EE\u4E00\u6837\u7EC4\u7EC7\u7ED3\u6784\uFF09\u3002 \u53EA\u9700\u8981\u901A\u8FC7 "),n("code",null,"npm install grammy"),s(" \u5B89\u88C5 grammy\uFF0C\u7136\u540E\u5F00\u59CB\u5199\u4EE3\u7801\u3002")],-1),In=n("h2",{id:"\u5982\u4F55\u63D0\u4EA4",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5982\u4F55\u63D0\u4EA4","aria-hidden":"true"},"#"),s(" \u5982\u4F55\u63D0\u4EA4\uFF1F")],-1),Tn=s("\u5982\u679C\u4F60\u5DF2\u7ECF\u51C6\u5907\u597D\u4E86\u4E00\u4E2A\u63D2\u4EF6\uFF0C\u4F60\u53EF\u4EE5\u76F4\u63A5\u5728 GitHub \u4E0A\u63D0\u4EA4\u4E00\u4E2A pull request\uFF08\u6839\u636E "),Bn=n("a",{href:"#%E8%B4%A1%E7%8C%AE%E8%A7%84%E5%88%99"},"\u8D21\u732E\u89C4\u5219",-1),Mn=s("\uFF09\uFF0C\u6216\u8005\u5728 "),Rn={href:"https://t.me/grammyjs",target:"_blank",rel:"noopener noreferrer"},Gn=s("\u793E\u533A\u804A\u5929"),Hn=s(" \u4E2D\u901A\u77E5\u6211\u4EEC\u4EE5\u83B7\u5F97\u8FDB\u4E00\u6B65\u7684\u5E2E\u52A9\u3002");function Ln(Sn,Vn){const e=c("RouterLink"),t=c("ExternalLinkIcon");return l(),u("div",null,[d,k,n("blockquote",null,[n("p",null,[m,a(e,{to:"/zh/plugins/"},{default:p(()=>[_]),_:1}),h])]),v,b,n("ul",null,[n("li",null,[g,a(e,{to:"/zh/guide/middleware.html"},{default:p(()=>[y]),_:1}),f]),n("li",null,[w,a(e,{to:"/zh/advanced/transformers.html"},{default:p(()=>[x]),_:1}),q])]),j,D,E,A,n("p",null,[C,n("a",Y,[N,a(t)]),I]),T,n("ol",null,[B,n("li",null,[M,n("a",R,[G,a(t)]),H]),L]),n("p",null,[S,n("a",V,[z,a(t)]),F,n("a",P,[W,a(t)]),$]),J,n("p",null,[K,n("a",O,[Q,a(t)]),U,X,Z]),nn,n("p",null,[sn,n("a",an,[tn,on,en,a(t)]),pn]),cn,ln,n("p",null,[un,n("a",rn,[dn,a(t)]),kn]),n("blockquote",null,[n("p",null,[mn,_n,n("a",hn,[vn,a(t)]),bn])]),gn,n("p",null,[yn,n("a",fn,[wn,a(t)]),xn,qn,jn,Dn,En,An,Cn]),Yn,Nn,In,n("p",null,[Tn,Bn,Mn,n("a",Rn,[Gn,a(t)]),Hn])])}const Fn=i(r,[["render",Ln],["__file","guide.html.vue"]]);export{Fn as default};
