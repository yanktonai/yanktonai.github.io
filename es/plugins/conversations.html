<!DOCTYPE html>
<html lang="es-ES">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>Conversaciones (conversations) | grammY</title><meta name="description" content="El Framework de Bots para Telegram.">
    <link rel="modulepreload" href="/assets/app.ff0cf306.js"><link rel="modulepreload" href="/assets/conversations.html.0a307e9b.js"><link rel="modulepreload" href="/assets/conversations.html.34bdf713.js"><link rel="prefetch" href="/assets/index.html.0429b483.js"><link rel="prefetch" href="/assets/index.html.2401d292.js"><link rel="prefetch" href="/assets/deployment.html.820945fa.js"><link rel="prefetch" href="/assets/flood.html.064205fe.js"><link rel="prefetch" href="/assets/middleware.html.992dcb0e.js"><link rel="prefetch" href="/assets/proxy.html.c404e72a.js"><link rel="prefetch" href="/assets/reliability.html.5a572dfa.js"><link rel="prefetch" href="/assets/scaling.html.fe634161.js"><link rel="prefetch" href="/assets/structuring.html.1e8ebd48.js"><link rel="prefetch" href="/assets/transformers.html.3e1cae77.js"><link rel="prefetch" href="/assets/index.html.fb39b504.js"><link rel="prefetch" href="/assets/examples.html.4b7b6125.js"><link rel="prefetch" href="/assets/index.html.e45b3ea7.js"><link rel="prefetch" href="/assets/index.html.172886ab.js"><link rel="prefetch" href="/assets/api.html.d34afc0f.js"><link rel="prefetch" href="/assets/basics.html.65923044.js"><link rel="prefetch" href="/assets/commands.html.c2610c77.js"><link rel="prefetch" href="/assets/context.html.d7289dc7.js"><link rel="prefetch" href="/assets/deployment-types.html.346b4d4f.js"><link rel="prefetch" href="/assets/errors.html.d567f2e9.js"><link rel="prefetch" href="/assets/files.html.5df1fdf3.js"><link rel="prefetch" href="/assets/filter-queries.html.ff3c15e1.js"><link rel="prefetch" href="/assets/games.html.ebb92d65.js"><link rel="prefetch" href="/assets/getting-started.html.3aad9f5a.js"><link rel="prefetch" href="/assets/inline-queries.html.9fa5435e.js"><link rel="prefetch" href="/assets/introduction.html.d062e0ed.js"><link rel="prefetch" href="/assets/middleware.html.c32c1afb.js"><link rel="prefetch" href="/assets/comparison.html.864b515f.js"><link rel="prefetch" href="/assets/deno-deploy.html.33fda6ac.js"><link rel="prefetch" href="/assets/gcf.html.94978e12.js"><link rel="prefetch" href="/assets/heroku.html.f4861855.js"><link rel="prefetch" href="/assets/supabase.html.f931ecc3.js"><link rel="prefetch" href="/assets/vps.html.f8b61457.js"><link rel="prefetch" href="/assets/index.html.564f39e8.js"><link rel="prefetch" href="/assets/index.html.cc711d93.js"><link rel="prefetch" href="/assets/auto-retry.html.76b5ce1b.js"><link rel="prefetch" href="/assets/autoquote.html.f8611f7b.js"><link rel="prefetch" href="/assets/command-filter.html.12deb6e8.js"><link rel="prefetch" href="/assets/console-time.html.bbb18311.js"><link rel="prefetch" href="/assets/conversations.html.542d4ede.js"><link rel="prefetch" href="/assets/emoji.html.96b685bd.js"><link rel="prefetch" href="/assets/files.html.59f0953c.js"><link rel="prefetch" href="/assets/fluent.html.93e75a53.js"><link rel="prefetch" href="/assets/guide.html.4a675f4a.js"><link rel="prefetch" href="/assets/hydrate.html.4d6c9f6e.js"><link rel="prefetch" href="/assets/i18n.html.b886c9b6.js"><link rel="prefetch" href="/assets/keyboard.html.5d3ef392.js"><link rel="prefetch" href="/assets/menu.html.97fd78f5.js"><link rel="prefetch" href="/assets/middlewares.html.4527fc91.js"><link rel="prefetch" href="/assets/parse-mode.html.5fea1fba.js"><link rel="prefetch" href="/assets/ratelimiter.html.09dbf6ad.js"><link rel="prefetch" href="/assets/router.html.02606ebd.js"><link rel="prefetch" href="/assets/runner.html.fb3b00e6.js"><link rel="prefetch" href="/assets/session.html.a3ebd553.js"><link rel="prefetch" href="/assets/stateless-question.html.acdd39e3.js"><link rel="prefetch" href="/assets/transformer-throttler.html.009b0e9c.js"><link rel="prefetch" href="/assets/about.html.e9ce3575.js"><link rel="prefetch" href="/assets/comparison.html.5589e0a7.js"><link rel="prefetch" href="/assets/faq.html.4a46d2bc.js"><link rel="prefetch" href="/assets/index.html.8d516f91.js"><link rel="prefetch" href="/assets/index.html.0ea21131.js"><link rel="prefetch" href="/assets/deployment.html.947cfd03.js"><link rel="prefetch" href="/assets/flood.html.adb704f3.js"><link rel="prefetch" href="/assets/middleware.html.62700685.js"><link rel="prefetch" href="/assets/proxy.html.d9e32858.js"><link rel="prefetch" href="/assets/reliability.html.214116d2.js"><link rel="prefetch" href="/assets/scaling.html.17ebd1a5.js"><link rel="prefetch" href="/assets/structuring.html.b2cc831f.js"><link rel="prefetch" href="/assets/transformers.html.0d715264.js"><link rel="prefetch" href="/assets/index.html.655275db.js"><link rel="prefetch" href="/assets/examples.html.4da510e2.js"><link rel="prefetch" href="/assets/index.html.b68e7c4e.js"><link rel="prefetch" href="/assets/api.html.864221a5.js"><link rel="prefetch" href="/assets/basics.html.d83b67aa.js"><link rel="prefetch" href="/assets/commands.html.0c654628.js"><link rel="prefetch" href="/assets/context.html.684cfc10.js"><link rel="prefetch" href="/assets/deployment-types.html.66bb2eb6.js"><link rel="prefetch" href="/assets/errors.html.3bd197a1.js"><link rel="prefetch" href="/assets/files.html.b3f5719d.js"><link rel="prefetch" href="/assets/filter-queries.html.2fc848b9.js"><link rel="prefetch" href="/assets/games.html.ed2eeb11.js"><link rel="prefetch" href="/assets/getting-started.html.bee7700c.js"><link rel="prefetch" href="/assets/inline-queries.html.3dd234a2.js"><link rel="prefetch" href="/assets/introduction.html.2c38a111.js"><link rel="prefetch" href="/assets/middleware.html.956472a4.js"><link rel="prefetch" href="/assets/comparison.html.62a530ba.js"><link rel="prefetch" href="/assets/deno-deploy.html.9ad88492.js"><link rel="prefetch" href="/assets/gcf.html.dbb08649.js"><link rel="prefetch" href="/assets/heroku.html.1a7f1f38.js"><link rel="prefetch" href="/assets/supabase.html.4ce4dd3e.js"><link rel="prefetch" href="/assets/vps.html.7964c3ff.js"><link rel="prefetch" href="/assets/index.html.d277051d.js"><link rel="prefetch" href="/assets/auto-retry.html.627c099e.js"><link rel="prefetch" href="/assets/autoquote.html.931147c8.js"><link rel="prefetch" href="/assets/command-filter.html.24250ac2.js"><link rel="prefetch" href="/assets/console-time.html.c602475c.js"><link rel="prefetch" href="/assets/emoji.html.4340fe04.js"><link rel="prefetch" href="/assets/files.html.0ce1beed.js"><link rel="prefetch" href="/assets/fluent.html.2312cffa.js"><link rel="prefetch" href="/assets/guide.html.cdc01534.js"><link rel="prefetch" href="/assets/hydrate.html.e78bac27.js"><link rel="prefetch" href="/assets/i18n.html.7a67a704.js"><link rel="prefetch" href="/assets/keyboard.html.6c1187da.js"><link rel="prefetch" href="/assets/menu.html.2390f9b0.js"><link rel="prefetch" href="/assets/middlewares.html.8fb2b4c6.js"><link rel="prefetch" href="/assets/parse-mode.html.6084b065.js"><link rel="prefetch" href="/assets/ratelimiter.html.e9ab9086.js"><link rel="prefetch" href="/assets/router.html.49ad6cc8.js"><link rel="prefetch" href="/assets/runner.html.2e392816.js"><link rel="prefetch" href="/assets/session.html.bc00753b.js"><link rel="prefetch" href="/assets/stateless-question.html.840ef874.js"><link rel="prefetch" href="/assets/transformer-throttler.html.a0519c22.js"><link rel="prefetch" href="/assets/about.html.6acc59e5.js"><link rel="prefetch" href="/assets/comparison.html.19d2b82f.js"><link rel="prefetch" href="/assets/faq.html.525026ef.js"><link rel="prefetch" href="/assets/index.html.c671af3a.js"><link rel="prefetch" href="/assets/deployment.html.890ba700.js"><link rel="prefetch" href="/assets/flood.html.99fc87f0.js"><link rel="prefetch" href="/assets/middleware.html.93e739dc.js"><link rel="prefetch" href="/assets/proxy.html.a206407d.js"><link rel="prefetch" href="/assets/reliability.html.77f11b74.js"><link rel="prefetch" href="/assets/scaling.html.b0186def.js"><link rel="prefetch" href="/assets/structuring.html.431bf13f.js"><link rel="prefetch" href="/assets/transformers.html.76eb6336.js"><link rel="prefetch" href="/assets/index.html.629ca643.js"><link rel="prefetch" href="/assets/examples.html.cea54aec.js"><link rel="prefetch" href="/assets/index.html.374cf0b5.js"><link rel="prefetch" href="/assets/api.html.a789ac69.js"><link rel="prefetch" href="/assets/basics.html.a5f54cb2.js"><link rel="prefetch" href="/assets/commands.html.f5bc337a.js"><link rel="prefetch" href="/assets/context.html.e94c9f2e.js"><link rel="prefetch" href="/assets/deployment-types.html.d3d220f8.js"><link rel="prefetch" href="/assets/errors.html.cb531b7a.js"><link rel="prefetch" href="/assets/files.html.1cbd9c21.js"><link rel="prefetch" href="/assets/filter-queries.html.18865e77.js"><link rel="prefetch" href="/assets/games.html.019dc6f4.js"><link rel="prefetch" href="/assets/getting-started.html.cdb13cc0.js"><link rel="prefetch" href="/assets/inline-queries.html.02267dd2.js"><link rel="prefetch" href="/assets/introduction.html.e8487eb7.js"><link rel="prefetch" href="/assets/middleware.html.beeb4db0.js"><link rel="prefetch" href="/assets/comparison.html.ece5207a.js"><link rel="prefetch" href="/assets/deno-deploy.html.8cd18a25.js"><link rel="prefetch" href="/assets/gcf.html.bf1ad988.js"><link rel="prefetch" href="/assets/heroku.html.200ca6ee.js"><link rel="prefetch" href="/assets/supabase.html.aca1ac1d.js"><link rel="prefetch" href="/assets/vps.html.40de5172.js"><link rel="prefetch" href="/assets/index.html.567ecd8c.js"><link rel="prefetch" href="/assets/auto-retry.html.be745936.js"><link rel="prefetch" href="/assets/autoquote.html.5c46e2d3.js"><link rel="prefetch" href="/assets/command-filter.html.fa1f4413.js"><link rel="prefetch" href="/assets/console-time.html.0d2bc762.js"><link rel="prefetch" href="/assets/conversations.html.778561d7.js"><link rel="prefetch" href="/assets/emoji.html.601be2b6.js"><link rel="prefetch" href="/assets/files.html.13f0053f.js"><link rel="prefetch" href="/assets/fluent.html.47d160d5.js"><link rel="prefetch" href="/assets/guide.html.381a5a51.js"><link rel="prefetch" href="/assets/hydrate.html.426ed716.js"><link rel="prefetch" href="/assets/i18n.html.afb30866.js"><link rel="prefetch" href="/assets/keyboard.html.19037e93.js"><link rel="prefetch" href="/assets/menu.html.e70d11ec.js"><link rel="prefetch" href="/assets/middlewares.html.5bc684e5.js"><link rel="prefetch" href="/assets/parse-mode.html.0e2027aa.js"><link rel="prefetch" href="/assets/ratelimiter.html.f1aaea8c.js"><link rel="prefetch" href="/assets/router.html.1476dda9.js"><link rel="prefetch" href="/assets/runner.html.ce50a49c.js"><link rel="prefetch" href="/assets/session.html.fe8e3213.js"><link rel="prefetch" href="/assets/stateless-question.html.b8a43883.js"><link rel="prefetch" href="/assets/transformer-throttler.html.45a66fc5.js"><link rel="prefetch" href="/assets/about.html.4abcfa07.js"><link rel="prefetch" href="/assets/comparison.html.8ed17bd9.js"><link rel="prefetch" href="/assets/faq.html.0dd6c2c4.js"><link rel="prefetch" href="/assets/index.html.45898178.js"><link rel="prefetch" href="/assets/deployment.html.75afc00d.js"><link rel="prefetch" href="/assets/flood.html.71e88b3b.js"><link rel="prefetch" href="/assets/middleware.html.afa5db3b.js"><link rel="prefetch" href="/assets/proxy.html.b70254e4.js"><link rel="prefetch" href="/assets/reliability.html.2858f460.js"><link rel="prefetch" href="/assets/scaling.html.ae951df2.js"><link rel="prefetch" href="/assets/structuring.html.d2ff17dd.js"><link rel="prefetch" href="/assets/transformers.html.6f5b57b6.js"><link rel="prefetch" href="/assets/index.html.74522b16.js"><link rel="prefetch" href="/assets/examples.html.24e682eb.js"><link rel="prefetch" href="/assets/index.html.9de295a7.js"><link rel="prefetch" href="/assets/api.html.8ed7866f.js"><link rel="prefetch" href="/assets/basics.html.7afbeb28.js"><link rel="prefetch" href="/assets/commands.html.131d044b.js"><link rel="prefetch" href="/assets/context.html.f1f04579.js"><link rel="prefetch" href="/assets/deployment-types.html.6efb3c25.js"><link rel="prefetch" href="/assets/errors.html.0c95dbb6.js"><link rel="prefetch" href="/assets/files.html.c53a8155.js"><link rel="prefetch" href="/assets/filter-queries.html.dab2ea34.js"><link rel="prefetch" href="/assets/games.html.60a32e8c.js"><link rel="prefetch" href="/assets/getting-started.html.7d3308dc.js"><link rel="prefetch" href="/assets/inline-queries.html.c644e6f2.js"><link rel="prefetch" href="/assets/introduction.html.2b2e7021.js"><link rel="prefetch" href="/assets/middleware.html.8e8a095a.js"><link rel="prefetch" href="/assets/comparison.html.65d3d0d9.js"><link rel="prefetch" href="/assets/deno-deploy.html.b3d0c42c.js"><link rel="prefetch" href="/assets/gcf.html.8a35f9f5.js"><link rel="prefetch" href="/assets/heroku.html.8ba42f90.js"><link rel="prefetch" href="/assets/supabase.html.ee2b455f.js"><link rel="prefetch" href="/assets/vps.html.6fe75bcb.js"><link rel="prefetch" href="/assets/index.html.f9a366b7.js"><link rel="prefetch" href="/assets/auto-retry.html.e870a1fc.js"><link rel="prefetch" href="/assets/autoquote.html.afc82797.js"><link rel="prefetch" href="/assets/command-filter.html.d5692cab.js"><link rel="prefetch" href="/assets/console-time.html.a509e6b6.js"><link rel="prefetch" href="/assets/conversations.html.c2a1214f.js"><link rel="prefetch" href="/assets/emoji.html.346d49b0.js"><link rel="prefetch" href="/assets/files.html.97985794.js"><link rel="prefetch" href="/assets/fluent.html.497a7165.js"><link rel="prefetch" href="/assets/guide.html.6086fd79.js"><link rel="prefetch" href="/assets/hydrate.html.f3bc28bb.js"><link rel="prefetch" href="/assets/i18n.html.42762cf9.js"><link rel="prefetch" href="/assets/keyboard.html.9ccac385.js"><link rel="prefetch" href="/assets/menu.html.05b22f9d.js"><link rel="prefetch" href="/assets/middlewares.html.b0d76949.js"><link rel="prefetch" href="/assets/parse-mode.html.377b539d.js"><link rel="prefetch" href="/assets/ratelimiter.html.f7e73ee7.js"><link rel="prefetch" href="/assets/router.html.401950f2.js"><link rel="prefetch" href="/assets/runner.html.da15a490.js"><link rel="prefetch" href="/assets/session.html.79028198.js"><link rel="prefetch" href="/assets/stateless-question.html.e542bb65.js"><link rel="prefetch" href="/assets/transformer-throttler.html.7d448db6.js"><link rel="prefetch" href="/assets/about.html.41287b90.js"><link rel="prefetch" href="/assets/comparison.html.162bdf02.js"><link rel="prefetch" href="/assets/faq.html.abba6af1.js"><link rel="prefetch" href="/assets/404.html.d2dc3323.js"><link rel="prefetch" href="/assets/index.html.1c4897cb.js"><link rel="prefetch" href="/assets/index.html.fab842be.js"><link rel="prefetch" href="/assets/deployment.html.2d12c72d.js"><link rel="prefetch" href="/assets/flood.html.4c566ad6.js"><link rel="prefetch" href="/assets/middleware.html.3c169a9b.js"><link rel="prefetch" href="/assets/proxy.html.86c8a347.js"><link rel="prefetch" href="/assets/reliability.html.de93c5c4.js"><link rel="prefetch" href="/assets/scaling.html.38766e34.js"><link rel="prefetch" href="/assets/structuring.html.298e5159.js"><link rel="prefetch" href="/assets/transformers.html.459b59a8.js"><link rel="prefetch" href="/assets/index.html.7ab4aeb8.js"><link rel="prefetch" href="/assets/examples.html.e177b696.js"><link rel="prefetch" href="/assets/index.html.1b86b7ab.js"><link rel="prefetch" href="/assets/index.html.27a97d59.js"><link rel="prefetch" href="/assets/api.html.818d4b27.js"><link rel="prefetch" href="/assets/basics.html.8fbee6af.js"><link rel="prefetch" href="/assets/commands.html.34c4b445.js"><link rel="prefetch" href="/assets/context.html.c95cab40.js"><link rel="prefetch" href="/assets/deployment-types.html.0753e120.js"><link rel="prefetch" href="/assets/errors.html.61b179ab.js"><link rel="prefetch" href="/assets/files.html.f0668945.js"><link rel="prefetch" href="/assets/filter-queries.html.04d48bf8.js"><link rel="prefetch" href="/assets/games.html.cd692caf.js"><link rel="prefetch" href="/assets/getting-started.html.b343f1ad.js"><link rel="prefetch" href="/assets/inline-queries.html.0cef76b9.js"><link rel="prefetch" href="/assets/introduction.html.580d3cec.js"><link rel="prefetch" href="/assets/middleware.html.5a88b951.js"><link rel="prefetch" href="/assets/comparison.html.a4599628.js"><link rel="prefetch" href="/assets/deno-deploy.html.3bf24005.js"><link rel="prefetch" href="/assets/gcf.html.cb67212f.js"><link rel="prefetch" href="/assets/heroku.html.006de730.js"><link rel="prefetch" href="/assets/supabase.html.20f6ce0b.js"><link rel="prefetch" href="/assets/vps.html.3f6b6358.js"><link rel="prefetch" href="/assets/index.html.3dbe0499.js"><link rel="prefetch" href="/assets/index.html.38c0498b.js"><link rel="prefetch" href="/assets/auto-retry.html.8935c4bd.js"><link rel="prefetch" href="/assets/autoquote.html.7d18421c.js"><link rel="prefetch" href="/assets/command-filter.html.41399595.js"><link rel="prefetch" href="/assets/console-time.html.bdcb76fa.js"><link rel="prefetch" href="/assets/conversations.html.30e475ea.js"><link rel="prefetch" href="/assets/emoji.html.0441dc31.js"><link rel="prefetch" href="/assets/files.html.8497b8e8.js"><link rel="prefetch" href="/assets/fluent.html.f255b3f2.js"><link rel="prefetch" href="/assets/guide.html.a191a55b.js"><link rel="prefetch" href="/assets/hydrate.html.f4be7961.js"><link rel="prefetch" href="/assets/i18n.html.06d7a64d.js"><link rel="prefetch" href="/assets/keyboard.html.8839562b.js"><link rel="prefetch" href="/assets/menu.html.13205fde.js"><link rel="prefetch" href="/assets/middlewares.html.b91f741b.js"><link rel="prefetch" href="/assets/parse-mode.html.d6b680f1.js"><link rel="prefetch" href="/assets/ratelimiter.html.b1d0313f.js"><link rel="prefetch" href="/assets/router.html.6431683f.js"><link rel="prefetch" href="/assets/runner.html.6afe64ed.js"><link rel="prefetch" href="/assets/session.html.52fddacf.js"><link rel="prefetch" href="/assets/stateless-question.html.749484d7.js"><link rel="prefetch" href="/assets/transformer-throttler.html.2a964be5.js"><link rel="prefetch" href="/assets/about.html.6ed10858.js"><link rel="prefetch" href="/assets/comparison.html.9ac21ae9.js"><link rel="prefetch" href="/assets/faq.html.13c39620.js"><link rel="prefetch" href="/assets/index.html.05578d8d.js"><link rel="prefetch" href="/assets/index.html.87d4a8f7.js"><link rel="prefetch" href="/assets/deployment.html.af33805d.js"><link rel="prefetch" href="/assets/flood.html.33593415.js"><link rel="prefetch" href="/assets/middleware.html.4ace3339.js"><link rel="prefetch" href="/assets/proxy.html.a5872303.js"><link rel="prefetch" href="/assets/reliability.html.2c57405c.js"><link rel="prefetch" href="/assets/scaling.html.20302e91.js"><link rel="prefetch" href="/assets/structuring.html.d001ced5.js"><link rel="prefetch" href="/assets/transformers.html.94af9873.js"><link rel="prefetch" href="/assets/index.html.b4b4baf5.js"><link rel="prefetch" href="/assets/examples.html.b80db678.js"><link rel="prefetch" href="/assets/index.html.8e3cd89d.js"><link rel="prefetch" href="/assets/api.html.016aa5df.js"><link rel="prefetch" href="/assets/basics.html.7fdff7c7.js"><link rel="prefetch" href="/assets/commands.html.ac62cab6.js"><link rel="prefetch" href="/assets/context.html.80077a68.js"><link rel="prefetch" href="/assets/deployment-types.html.65e33c66.js"><link rel="prefetch" href="/assets/errors.html.93765c4b.js"><link rel="prefetch" href="/assets/files.html.ec378a93.js"><link rel="prefetch" href="/assets/filter-queries.html.64c223fe.js"><link rel="prefetch" href="/assets/games.html.7e5aecc7.js"><link rel="prefetch" href="/assets/getting-started.html.5ace4cfb.js"><link rel="prefetch" href="/assets/inline-queries.html.b32e49df.js"><link rel="prefetch" href="/assets/introduction.html.63b36243.js"><link rel="prefetch" href="/assets/middleware.html.00d5623b.js"><link rel="prefetch" href="/assets/comparison.html.718ee58e.js"><link rel="prefetch" href="/assets/deno-deploy.html.82a12d88.js"><link rel="prefetch" href="/assets/gcf.html.613fd014.js"><link rel="prefetch" href="/assets/heroku.html.4a62f147.js"><link rel="prefetch" href="/assets/supabase.html.817370dd.js"><link rel="prefetch" href="/assets/vps.html.a67b5cca.js"><link rel="prefetch" href="/assets/index.html.cca2c7b3.js"><link rel="prefetch" href="/assets/auto-retry.html.d10bb394.js"><link rel="prefetch" href="/assets/autoquote.html.2c5aefe5.js"><link rel="prefetch" href="/assets/command-filter.html.75c129da.js"><link rel="prefetch" href="/assets/console-time.html.772dab31.js"><link rel="prefetch" href="/assets/emoji.html.ac5600f6.js"><link rel="prefetch" href="/assets/files.html.8adb2bbe.js"><link rel="prefetch" href="/assets/fluent.html.8b85b21e.js"><link rel="prefetch" href="/assets/guide.html.887051d1.js"><link rel="prefetch" href="/assets/hydrate.html.78b2c50e.js"><link rel="prefetch" href="/assets/i18n.html.9494c3a2.js"><link rel="prefetch" href="/assets/keyboard.html.8b346bae.js"><link rel="prefetch" href="/assets/menu.html.f032241a.js"><link rel="prefetch" href="/assets/middlewares.html.470c174c.js"><link rel="prefetch" href="/assets/parse-mode.html.ba716486.js"><link rel="prefetch" href="/assets/ratelimiter.html.98481e36.js"><link rel="prefetch" href="/assets/router.html.40702a35.js"><link rel="prefetch" href="/assets/runner.html.ee7d9d7a.js"><link rel="prefetch" href="/assets/session.html.c8ab3005.js"><link rel="prefetch" href="/assets/stateless-question.html.245226e2.js"><link rel="prefetch" href="/assets/transformer-throttler.html.af53e2d0.js"><link rel="prefetch" href="/assets/about.html.7b65581f.js"><link rel="prefetch" href="/assets/comparison.html.ea016124.js"><link rel="prefetch" href="/assets/faq.html.3afcba67.js"><link rel="prefetch" href="/assets/index.html.eef9fbe6.js"><link rel="prefetch" href="/assets/deployment.html.cdf69b84.js"><link rel="prefetch" href="/assets/flood.html.4f1865e0.js"><link rel="prefetch" href="/assets/middleware.html.d9d26e75.js"><link rel="prefetch" href="/assets/proxy.html.5255f337.js"><link rel="prefetch" href="/assets/reliability.html.dbb6bad3.js"><link rel="prefetch" href="/assets/scaling.html.0af6ccaa.js"><link rel="prefetch" href="/assets/structuring.html.9bf495d0.js"><link rel="prefetch" href="/assets/transformers.html.33036e37.js"><link rel="prefetch" href="/assets/index.html.6448debf.js"><link rel="prefetch" href="/assets/examples.html.ee77f0d5.js"><link rel="prefetch" href="/assets/index.html.d9a46521.js"><link rel="prefetch" href="/assets/api.html.b776a81a.js"><link rel="prefetch" href="/assets/basics.html.cf94d5ce.js"><link rel="prefetch" href="/assets/commands.html.6b0b3a2a.js"><link rel="prefetch" href="/assets/context.html.e1e3fee3.js"><link rel="prefetch" href="/assets/deployment-types.html.a852345f.js"><link rel="prefetch" href="/assets/errors.html.8242fd24.js"><link rel="prefetch" href="/assets/files.html.7e742d21.js"><link rel="prefetch" href="/assets/filter-queries.html.7aa8b84d.js"><link rel="prefetch" href="/assets/games.html.56ba0ae8.js"><link rel="prefetch" href="/assets/getting-started.html.80060686.js"><link rel="prefetch" href="/assets/inline-queries.html.eca13ad8.js"><link rel="prefetch" href="/assets/introduction.html.cafcaea7.js"><link rel="prefetch" href="/assets/middleware.html.c25f395d.js"><link rel="prefetch" href="/assets/comparison.html.6746e662.js"><link rel="prefetch" href="/assets/deno-deploy.html.8635c631.js"><link rel="prefetch" href="/assets/gcf.html.fbbc8c66.js"><link rel="prefetch" href="/assets/heroku.html.f7d33256.js"><link rel="prefetch" href="/assets/supabase.html.0b7f85a7.js"><link rel="prefetch" href="/assets/vps.html.3ccb23c7.js"><link rel="prefetch" href="/assets/index.html.ec836f1a.js"><link rel="prefetch" href="/assets/auto-retry.html.4f0a7780.js"><link rel="prefetch" href="/assets/autoquote.html.2e990b55.js"><link rel="prefetch" href="/assets/command-filter.html.d9267659.js"><link rel="prefetch" href="/assets/console-time.html.3e4c3c69.js"><link rel="prefetch" href="/assets/conversations.html.2a998a2d.js"><link rel="prefetch" href="/assets/emoji.html.bb9f617f.js"><link rel="prefetch" href="/assets/files.html.baa5ac7f.js"><link rel="prefetch" href="/assets/fluent.html.31382f60.js"><link rel="prefetch" href="/assets/guide.html.49abbd63.js"><link rel="prefetch" href="/assets/hydrate.html.24ba8b8a.js"><link rel="prefetch" href="/assets/i18n.html.e626c16e.js"><link rel="prefetch" href="/assets/keyboard.html.a41d72df.js"><link rel="prefetch" href="/assets/menu.html.7c43427e.js"><link rel="prefetch" href="/assets/middlewares.html.791dae8e.js"><link rel="prefetch" href="/assets/parse-mode.html.4cf91041.js"><link rel="prefetch" href="/assets/ratelimiter.html.c4e98bda.js"><link rel="prefetch" href="/assets/router.html.fe091e82.js"><link rel="prefetch" href="/assets/runner.html.9e0979bf.js"><link rel="prefetch" href="/assets/session.html.9b302e77.js"><link rel="prefetch" href="/assets/stateless-question.html.ff4603c6.js"><link rel="prefetch" href="/assets/transformer-throttler.html.557d5f05.js"><link rel="prefetch" href="/assets/about.html.76710bd9.js"><link rel="prefetch" href="/assets/comparison.html.2ac5c9ef.js"><link rel="prefetch" href="/assets/faq.html.b4f81d0b.js"><link rel="prefetch" href="/assets/index.html.3d591f00.js"><link rel="prefetch" href="/assets/deployment.html.7867e6c9.js"><link rel="prefetch" href="/assets/flood.html.2ea2f691.js"><link rel="prefetch" href="/assets/middleware.html.65081599.js"><link rel="prefetch" href="/assets/proxy.html.b7669bfc.js"><link rel="prefetch" href="/assets/reliability.html.dc3b7f0b.js"><link rel="prefetch" href="/assets/scaling.html.5494cb4e.js"><link rel="prefetch" href="/assets/structuring.html.93f34d3b.js"><link rel="prefetch" href="/assets/transformers.html.e41ecbed.js"><link rel="prefetch" href="/assets/index.html.c18f01b3.js"><link rel="prefetch" href="/assets/examples.html.f943c601.js"><link rel="prefetch" href="/assets/index.html.cda796c0.js"><link rel="prefetch" href="/assets/api.html.27e83c72.js"><link rel="prefetch" href="/assets/basics.html.529df59d.js"><link rel="prefetch" href="/assets/commands.html.fa3fdccb.js"><link rel="prefetch" href="/assets/context.html.6ec976ab.js"><link rel="prefetch" href="/assets/deployment-types.html.40c57bd8.js"><link rel="prefetch" href="/assets/errors.html.e7ae41af.js"><link rel="prefetch" href="/assets/files.html.91294931.js"><link rel="prefetch" href="/assets/filter-queries.html.815a1b7b.js"><link rel="prefetch" href="/assets/games.html.7c820635.js"><link rel="prefetch" href="/assets/getting-started.html.945a075c.js"><link rel="prefetch" href="/assets/inline-queries.html.650b3533.js"><link rel="prefetch" href="/assets/introduction.html.1941576d.js"><link rel="prefetch" href="/assets/middleware.html.92c13cb7.js"><link rel="prefetch" href="/assets/comparison.html.6ba6b00d.js"><link rel="prefetch" href="/assets/deno-deploy.html.01548194.js"><link rel="prefetch" href="/assets/gcf.html.e4977ca9.js"><link rel="prefetch" href="/assets/heroku.html.0e4a5968.js"><link rel="prefetch" href="/assets/supabase.html.c4c62fc7.js"><link rel="prefetch" href="/assets/vps.html.5ae15a95.js"><link rel="prefetch" href="/assets/index.html.ba0787fa.js"><link rel="prefetch" href="/assets/auto-retry.html.43df2e8b.js"><link rel="prefetch" href="/assets/autoquote.html.cf1e0f37.js"><link rel="prefetch" href="/assets/command-filter.html.2974e416.js"><link rel="prefetch" href="/assets/console-time.html.43a1489a.js"><link rel="prefetch" href="/assets/conversations.html.18b6ae28.js"><link rel="prefetch" href="/assets/emoji.html.9ab88423.js"><link rel="prefetch" href="/assets/files.html.235ab172.js"><link rel="prefetch" href="/assets/fluent.html.bb980530.js"><link rel="prefetch" href="/assets/guide.html.2846d612.js"><link rel="prefetch" href="/assets/hydrate.html.ebb496c8.js"><link rel="prefetch" href="/assets/i18n.html.a92d3708.js"><link rel="prefetch" href="/assets/keyboard.html.fef8d845.js"><link rel="prefetch" href="/assets/menu.html.11effab9.js"><link rel="prefetch" href="/assets/middlewares.html.b24b568a.js"><link rel="prefetch" href="/assets/parse-mode.html.97b56576.js"><link rel="prefetch" href="/assets/ratelimiter.html.b651cf2f.js"><link rel="prefetch" href="/assets/router.html.c4fe017c.js"><link rel="prefetch" href="/assets/runner.html.6a9f0e60.js"><link rel="prefetch" href="/assets/session.html.5f1804f0.js"><link rel="prefetch" href="/assets/stateless-question.html.332a15b4.js"><link rel="prefetch" href="/assets/transformer-throttler.html.4a1d85c5.js"><link rel="prefetch" href="/assets/about.html.a004299d.js"><link rel="prefetch" href="/assets/comparison.html.0a4b9344.js"><link rel="prefetch" href="/assets/faq.html.23034a7d.js"><link rel="prefetch" href="/assets/404.html.31b21725.js">
    <link rel="stylesheet" href="/assets/style.177b0b6b.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/es/" class=""><img class="logo" src="/Y.png" alt="grammY"><span class="site-name can-hide">grammY</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/es/guide/" class="" aria-label="Guía"><!--[--><!--]--><span>Guía <!--v-if--></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Aprender"><span class="title">Aprender</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Aprender"><span class="title">Aprender</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Guía <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/guide/" class="" aria-label="Resumen"><!--[--><!--]--><span>Resumen <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/introduction.html" class="" aria-label="Introducción"><!--[--><!--]--><span>Introducción <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/getting-started.html" class="" aria-label="Cómo empezar"><!--[--><!--]--><span>Cómo empezar <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/basics.html" class="" aria-label="Envío y recepción de mensajes"><!--[--><!--]--><span>Envío y recepción de mensajes <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/context.html" class="" aria-label="Contexto"><!--[--><!--]--><span>Contexto <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/api.html" class="" aria-label="API para bots"><!--[--><!--]--><span>API para bots <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/filter-queries.html" class="" aria-label="Filtrar consultas y bot.on()"><!--[--><!--]--><span>Filtrar consultas y bot.on() <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/commands.html" class="" aria-label="Comandos"><!--[--><!--]--><span>Comandos <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/middleware.html" class="" aria-label="Middleware"><!--[--><!--]--><span>Middleware <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/errors.html" class="" aria-label="Manejo de errores"><!--[--><!--]--><span>Manejo de errores <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/inline-queries.html" class="" aria-label="Consultas lineales"><!--[--><!--]--><span>Consultas lineales <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/files.html" class="" aria-label="Manejo de archivos"><!--[--><!--]--><span>Manejo de archivos <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/games.html" class="" aria-label="Juegos"><!--[--><!--]--><span>Juegos <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/deployment-types.html" class="" aria-label="Long Polling frente a Webhooks"><!--[--><!--]--><span>Long Polling frente a Webhooks <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Avanzado <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/advanced/" class="" aria-label="Resumen"><!--[--><!--]--><span>Resumen <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/middleware.html" class="" aria-label="Middleware en profundidad"><!--[--><!--]--><span>Middleware en profundidad <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/structuring.html" class="" aria-label="Escalando I: Código base grande"><!--[--><!--]--><span>Escalando I: Código base grande <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/scaling.html" class="" aria-label="Escalando II: Alta carga"><!--[--><!--]--><span>Escalando II: Alta carga <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/reliability.html" class="" aria-label="Escalando III: Fiabilidad"><!--[--><!--]--><span>Escalando III: Fiabilidad <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/flood.html" class="" aria-label="Escalando IV: Límites de flujo"><!--[--><!--]--><span>Escalando IV: Límites de flujo <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/transformers.html" class="" aria-label="Transformadores de la API del Bot"><!--[--><!--]--><span>Transformadores de la API del Bot <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/proxy.html" class="" aria-label="Soporte para proxy"><!--[--><!--]--><span>Soporte para proxy <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/deployment.html" class="" aria-label="Lista de comprobación del despliegue"><!--[--><!--]--><span>Lista de comprobación del despliegue <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Complementos"><span class="title">Complementos</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Complementos"><span class="title">Complementos</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Introducción <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/plugins/" class="" aria-label="Acerca de los complementos"><!--[--><!--]--><span>Acerca de los complementos <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/guide.html" class="" aria-label="Cómo escribir complementos"><!--[--><!--]--><span>Cómo escribir complementos <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Incorporado <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/plugins/session.html" class="" aria-label="Sesiones y almacenamiento de datos"><!--[--><!--]--><span>Sesiones y almacenamiento de datos <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/keyboard.html" class="" aria-label="Teclados lineales y personalizados"><!--[--><!--]--><span>Teclados lineales y personalizados <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Oficial <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a aria-current="page" href="/es/plugins/conversations.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Conversaciones (conversations)"><!--[--><!--]--><span>Conversaciones (conversations) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/menu.html" class="" aria-label="Menus Interactivos (menu)"><!--[--><!--]--><span>Menus Interactivos (menu) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/stateless-question.html" class="" aria-label="Preguntas sin estado (stateless-question)"><!--[--><!--]--><span>Preguntas sin estado (stateless-question) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/runner.html" class="" aria-label="Concurrencia (runner)"><!--[--><!--]--><span>Concurrencia (runner) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/hydrate.html" class="" aria-label="Hidratación (hydrate)"><!--[--><!--]--><span>Hidratación (hydrate) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/auto-retry.html" class="" aria-label="Reintentar solicitudes de la API (auto-retry)"><!--[--><!--]--><span>Reintentar solicitudes de la API (auto-retry) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/transformer-throttler.html" class="" aria-label="Control de flujo (transformer-throttler)"><!--[--><!--]--><span>Control de flujo (transformer-throttler) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/ratelimiter.html" class="" aria-label="Usuarios con límite de peticiones (ratelimiter)"><!--[--><!--]--><span>Usuarios con límite de peticiones (ratelimiter) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/files.html" class="" aria-label="Archivos (files)"><!--[--><!--]--><span>Archivos (files) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/i18n.html" class="" aria-label="Internacionalización (i18n)"><!--[--><!--]--><span>Internacionalización (i18n) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/fluent.html" class="" aria-label="Internacionalización (fluent)"><!--[--><!--]--><span>Internacionalización (fluent) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/router.html" class="" aria-label="Enrutador (router)"><!--[--><!--]--><span>Enrutador (router) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/emoji.html" class="" aria-label="Emojis (emoji)"><!--[--><!--]--><span>Emojis (emoji) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/parse-mode.html" class="" aria-label="Modo de parsear (parse-mode)"><!--[--><!--]--><span>Modo de parsear (parse-mode) <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>De Terceros <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/plugins/console-time.html" class="" aria-label="Tiempo de consola"><!--[--><!--]--><span>Tiempo de consola <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/middlewares.html" class="" aria-label="Middlewares de utilidad"><!--[--><!--]--><span>Middlewares de utilidad <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/autoquote.html" class="" aria-label="Citar automáticamente"><!--[--><!--]--><span>Citar automáticamente <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/#crear-tus-propios-plugins" class="" aria-label="[¡Envíe su PR!]"><!--[--><!--]--><span>[¡Envíe su PR!] <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Ejemplos"><span class="title">Ejemplos</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Ejemplos"><span class="title">Ejemplos</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Ejemplos <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/grammyjs/awesome-grammY" rel="noopener noreferrer" target="_blank" aria-label="Impresionante grammY"><!--[--><!--]--><span>Impresionante grammY <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/grammyjs/examples" rel="noopener noreferrer" target="_blank" aria-label="Ejemplo de Repositorio de Bots"><!--[--><!--]--><span>Ejemplo de Repositorio de Bots <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Recursos"><span class="title">Recursos</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Recursos"><span class="title">Recursos</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>grammY <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/resources/about.html" class="" aria-label="Sobre grammY"><!--[--><!--]--><span>Sobre grammY <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs" rel="noopener noreferrer" target="_blank" aria-label="Chat comunitario (Inglés)"><!--[--><!--]--><span>Chat comunitario (Inglés) <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs_ru" rel="noopener noreferrer" target="_blank" aria-label="Chat comunitario (Ruso)"><!--[--><!--]--><span>Chat comunitario (Ruso) <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs_news" rel="noopener noreferrer" target="_blank" aria-label="Noticias"><!--[--><!--]--><span>Noticias <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://twitter.com/grammy_js" rel="noopener noreferrer" target="_blank" aria-label="Twitter"><!--[--><!--]--><span>Twitter <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/resources/faq.html" class="" aria-label="Preguntas frecuentes"><!--[--><!--]--><span>Preguntas frecuentes <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/resources/comparison.html" class="" aria-label="Comparación con otros frameworks"><!--[--><!--]--><span>Comparación con otros frameworks <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Telegram <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots" rel="noopener noreferrer" target="_blank" aria-label="Introducción para desarrolladores"><!--[--><!--]--><span>Introducción para desarrolladores <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/faq" rel="noopener noreferrer" target="_blank" aria-label="Preguntas frecuentes de bots"><!--[--><!--]--><span>Preguntas frecuentes de bots <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/api" rel="noopener noreferrer" target="_blank" aria-label="Referencia de la API para bots"><!--[--><!--]--><span>Referencia de la API para bots <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/webhooks#testing-your-bot-with-updates" rel="noopener noreferrer" target="_blank" aria-label="Ejemplos de actualizaciones"><!--[--><!--]--><span>Ejemplos de actualizaciones <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Alojamiento"><span class="title">Alojamiento</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Alojamiento"><span class="title">Alojamiento</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Resumen <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/hosting/comparison.html" class="" aria-label="Comparativa"><!--[--><!--]--><span>Comparativa <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Tutoriales <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/hosting/deno-deploy.html" class="" aria-label="Deno Deploy"><!--[--><!--]--><span>Deno Deploy <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/hosting/supabase.html" class="" aria-label="Supabase Edge Functions"><!--[--><!--]--><span>Supabase Edge Functions <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/hosting/heroku.html" class="" aria-label="Heroku"><!--[--><!--]--><span>Heroku <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/hosting/gcf.html" class="" aria-label="Google Cloud Functions"><!--[--><!--]--><span>Google Cloud Functions <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/hosting/vps.html" class="" aria-label="Servidor Privado Virtual"><!--[--><!--]--><span>Servidor Privado Virtual <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://doc.deno.land/https://deno.land/x/grammy/mod.ts" rel="noopener noreferrer" target="_blank" aria-label="Referencia de API"><!--[--><!--]--><span>Referencia de API <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><a href="/plugins/conversations.html" class="" aria-label="English"><!--[--><!--]--><span>English <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/es/plugins/conversations.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Español"><!--[--><!--]--><span>Español <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/id/plugins/conversations.html" class="" aria-label="Indonesia"><!--[--><!--]--><span>Indonesia <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/zh/plugins/conversations.html" class="" aria-label="简体中文"><!--[--><!--]--><span>简体中文 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/grammyjs/grammY" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--><span>GitHub <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/es/guide/" class="" aria-label="Guía"><!--[--><!--]--><span>Guía <!--v-if--></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Aprender"><span class="title">Aprender</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Aprender"><span class="title">Aprender</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Guía <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/guide/" class="" aria-label="Resumen"><!--[--><!--]--><span>Resumen <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/introduction.html" class="" aria-label="Introducción"><!--[--><!--]--><span>Introducción <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/getting-started.html" class="" aria-label="Cómo empezar"><!--[--><!--]--><span>Cómo empezar <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/basics.html" class="" aria-label="Envío y recepción de mensajes"><!--[--><!--]--><span>Envío y recepción de mensajes <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/context.html" class="" aria-label="Contexto"><!--[--><!--]--><span>Contexto <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/api.html" class="" aria-label="API para bots"><!--[--><!--]--><span>API para bots <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/filter-queries.html" class="" aria-label="Filtrar consultas y bot.on()"><!--[--><!--]--><span>Filtrar consultas y bot.on() <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/commands.html" class="" aria-label="Comandos"><!--[--><!--]--><span>Comandos <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/middleware.html" class="" aria-label="Middleware"><!--[--><!--]--><span>Middleware <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/errors.html" class="" aria-label="Manejo de errores"><!--[--><!--]--><span>Manejo de errores <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/inline-queries.html" class="" aria-label="Consultas lineales"><!--[--><!--]--><span>Consultas lineales <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/files.html" class="" aria-label="Manejo de archivos"><!--[--><!--]--><span>Manejo de archivos <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/games.html" class="" aria-label="Juegos"><!--[--><!--]--><span>Juegos <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/guide/deployment-types.html" class="" aria-label="Long Polling frente a Webhooks"><!--[--><!--]--><span>Long Polling frente a Webhooks <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Avanzado <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/advanced/" class="" aria-label="Resumen"><!--[--><!--]--><span>Resumen <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/middleware.html" class="" aria-label="Middleware en profundidad"><!--[--><!--]--><span>Middleware en profundidad <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/structuring.html" class="" aria-label="Escalando I: Código base grande"><!--[--><!--]--><span>Escalando I: Código base grande <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/scaling.html" class="" aria-label="Escalando II: Alta carga"><!--[--><!--]--><span>Escalando II: Alta carga <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/reliability.html" class="" aria-label="Escalando III: Fiabilidad"><!--[--><!--]--><span>Escalando III: Fiabilidad <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/flood.html" class="" aria-label="Escalando IV: Límites de flujo"><!--[--><!--]--><span>Escalando IV: Límites de flujo <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/transformers.html" class="" aria-label="Transformadores de la API del Bot"><!--[--><!--]--><span>Transformadores de la API del Bot <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/proxy.html" class="" aria-label="Soporte para proxy"><!--[--><!--]--><span>Soporte para proxy <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/advanced/deployment.html" class="" aria-label="Lista de comprobación del despliegue"><!--[--><!--]--><span>Lista de comprobación del despliegue <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Complementos"><span class="title">Complementos</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Complementos"><span class="title">Complementos</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Introducción <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/plugins/" class="" aria-label="Acerca de los complementos"><!--[--><!--]--><span>Acerca de los complementos <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/guide.html" class="" aria-label="Cómo escribir complementos"><!--[--><!--]--><span>Cómo escribir complementos <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Incorporado <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/plugins/session.html" class="" aria-label="Sesiones y almacenamiento de datos"><!--[--><!--]--><span>Sesiones y almacenamiento de datos <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/keyboard.html" class="" aria-label="Teclados lineales y personalizados"><!--[--><!--]--><span>Teclados lineales y personalizados <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Oficial <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a aria-current="page" href="/es/plugins/conversations.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Conversaciones (conversations)"><!--[--><!--]--><span>Conversaciones (conversations) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/menu.html" class="" aria-label="Menus Interactivos (menu)"><!--[--><!--]--><span>Menus Interactivos (menu) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/stateless-question.html" class="" aria-label="Preguntas sin estado (stateless-question)"><!--[--><!--]--><span>Preguntas sin estado (stateless-question) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/runner.html" class="" aria-label="Concurrencia (runner)"><!--[--><!--]--><span>Concurrencia (runner) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/hydrate.html" class="" aria-label="Hidratación (hydrate)"><!--[--><!--]--><span>Hidratación (hydrate) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/auto-retry.html" class="" aria-label="Reintentar solicitudes de la API (auto-retry)"><!--[--><!--]--><span>Reintentar solicitudes de la API (auto-retry) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/transformer-throttler.html" class="" aria-label="Control de flujo (transformer-throttler)"><!--[--><!--]--><span>Control de flujo (transformer-throttler) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/ratelimiter.html" class="" aria-label="Usuarios con límite de peticiones (ratelimiter)"><!--[--><!--]--><span>Usuarios con límite de peticiones (ratelimiter) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/files.html" class="" aria-label="Archivos (files)"><!--[--><!--]--><span>Archivos (files) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/i18n.html" class="" aria-label="Internacionalización (i18n)"><!--[--><!--]--><span>Internacionalización (i18n) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/fluent.html" class="" aria-label="Internacionalización (fluent)"><!--[--><!--]--><span>Internacionalización (fluent) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/router.html" class="" aria-label="Enrutador (router)"><!--[--><!--]--><span>Enrutador (router) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/emoji.html" class="" aria-label="Emojis (emoji)"><!--[--><!--]--><span>Emojis (emoji) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/parse-mode.html" class="" aria-label="Modo de parsear (parse-mode)"><!--[--><!--]--><span>Modo de parsear (parse-mode) <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>De Terceros <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/plugins/console-time.html" class="" aria-label="Tiempo de consola"><!--[--><!--]--><span>Tiempo de consola <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/middlewares.html" class="" aria-label="Middlewares de utilidad"><!--[--><!--]--><span>Middlewares de utilidad <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/autoquote.html" class="" aria-label="Citar automáticamente"><!--[--><!--]--><span>Citar automáticamente <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/plugins/#crear-tus-propios-plugins" class="" aria-label="[¡Envíe su PR!]"><!--[--><!--]--><span>[¡Envíe su PR!] <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Ejemplos"><span class="title">Ejemplos</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Ejemplos"><span class="title">Ejemplos</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Ejemplos <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/grammyjs/awesome-grammY" rel="noopener noreferrer" target="_blank" aria-label="Impresionante grammY"><!--[--><!--]--><span>Impresionante grammY <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/grammyjs/examples" rel="noopener noreferrer" target="_blank" aria-label="Ejemplo de Repositorio de Bots"><!--[--><!--]--><span>Ejemplo de Repositorio de Bots <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Recursos"><span class="title">Recursos</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Recursos"><span class="title">Recursos</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>grammY <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/resources/about.html" class="" aria-label="Sobre grammY"><!--[--><!--]--><span>Sobre grammY <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs" rel="noopener noreferrer" target="_blank" aria-label="Chat comunitario (Inglés)"><!--[--><!--]--><span>Chat comunitario (Inglés) <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs_ru" rel="noopener noreferrer" target="_blank" aria-label="Chat comunitario (Ruso)"><!--[--><!--]--><span>Chat comunitario (Ruso) <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs_news" rel="noopener noreferrer" target="_blank" aria-label="Noticias"><!--[--><!--]--><span>Noticias <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://twitter.com/grammy_js" rel="noopener noreferrer" target="_blank" aria-label="Twitter"><!--[--><!--]--><span>Twitter <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/resources/faq.html" class="" aria-label="Preguntas frecuentes"><!--[--><!--]--><span>Preguntas frecuentes <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/resources/comparison.html" class="" aria-label="Comparación con otros frameworks"><!--[--><!--]--><span>Comparación con otros frameworks <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Telegram <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots" rel="noopener noreferrer" target="_blank" aria-label="Introducción para desarrolladores"><!--[--><!--]--><span>Introducción para desarrolladores <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/faq" rel="noopener noreferrer" target="_blank" aria-label="Preguntas frecuentes de bots"><!--[--><!--]--><span>Preguntas frecuentes de bots <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/api" rel="noopener noreferrer" target="_blank" aria-label="Referencia de la API para bots"><!--[--><!--]--><span>Referencia de la API para bots <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/webhooks#testing-your-bot-with-updates" rel="noopener noreferrer" target="_blank" aria-label="Ejemplos de actualizaciones"><!--[--><!--]--><span>Ejemplos de actualizaciones <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Alojamiento"><span class="title">Alojamiento</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Alojamiento"><span class="title">Alojamiento</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Resumen <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/hosting/comparison.html" class="" aria-label="Comparativa"><!--[--><!--]--><span>Comparativa <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Tutoriales <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/es/hosting/deno-deploy.html" class="" aria-label="Deno Deploy"><!--[--><!--]--><span>Deno Deploy <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/hosting/supabase.html" class="" aria-label="Supabase Edge Functions"><!--[--><!--]--><span>Supabase Edge Functions <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/hosting/heroku.html" class="" aria-label="Heroku"><!--[--><!--]--><span>Heroku <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/hosting/gcf.html" class="" aria-label="Google Cloud Functions"><!--[--><!--]--><span>Google Cloud Functions <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/es/hosting/vps.html" class="" aria-label="Servidor Privado Virtual"><!--[--><!--]--><span>Servidor Privado Virtual <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://doc.deno.land/https://deno.land/x/grammy/mod.ts" rel="noopener noreferrer" target="_blank" aria-label="Referencia de API"><!--[--><!--]--><span>Referencia de API <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><a href="/plugins/conversations.html" class="" aria-label="English"><!--[--><!--]--><span>English <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/es/plugins/conversations.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Español"><!--[--><!--]--><span>Español <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/id/plugins/conversations.html" class="" aria-label="Indonesia"><!--[--><!--]--><span>Indonesia <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/zh/plugins/conversations.html" class="" aria-label="简体中文"><!--[--><!--]--><span>简体中文 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/grammyjs/grammY" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--><span>GitHub <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Conversaciones (conversations) <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/es/plugins/conversations.html#introduccion" class="router-link-active router-link-exact-active sidebar-item" aria-label="Introducción"><!--[--><!--]--><span>Introducción <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#ejemplo-simple" class="router-link-active router-link-exact-active sidebar-item" aria-label="Ejemplo simple"><!--[--><!--]--><span>Ejemplo simple <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#funciones-del-constructor-de-conversaciones" class="router-link-active router-link-exact-active sidebar-item" aria-label="Funciones del Constructor de Conversaciones"><!--[--><!--]--><span>Funciones del Constructor de Conversaciones <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#instalar-y-entrar-en-una-conversacion" class="router-link-active router-link-exact-active sidebar-item" aria-label="Instalar y entrar en una conversación"><!--[--><!--]--><span>Instalar y entrar en una conversación <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#salir-de-una-conversacion" class="router-link-active router-link-exact-active sidebar-item" aria-label="Salir de una conversación"><!--[--><!--]--><span>Salir de una conversación <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#esperar-a-las-actualizaciones" class="router-link-active router-link-exact-active sidebar-item" aria-label="Esperar a las actualizaciones"><!--[--><!--]--><span>Esperar a las actualizaciones <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#tres-reglas-de-oro-de-las-conversaciones" class="router-link-active router-link-exact-active sidebar-item" aria-label="Tres reglas de oro de las conversaciones"><!--[--><!--]--><span>Tres reglas de oro de las conversaciones <!--v-if--></span><!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/es/plugins/conversations.html#regla-i-todos-los-efectos-secundarios-deben-estar-envueltos" class="router-link-active router-link-exact-active sidebar-item" aria-label="Regla I: Todos los efectos secundarios deben estar envueltos"><!--[--><!--]--><span>Regla I: Todos los efectos secundarios deben estar envueltos <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#regla-ii-todo-comportamiento-aleatorio-debe-estar-envuelto" class="router-link-active router-link-exact-active sidebar-item" aria-label="Regla II: Todo comportamiento aleatorio debe estar envuelto"><!--[--><!--]--><span>Regla II: Todo comportamiento aleatorio debe estar envuelto <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#regla-iii-usar-funciones-de-conveniencia" class="router-link-active router-link-exact-active sidebar-item" aria-label="Regla III: Usar funciones de conveniencia"><!--[--><!--]--><span>Regla III: Usar funciones de conveniencia <!--v-if--></span><!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/es/plugins/conversations.html#variables-bifurcaciones-y-bucles" class="router-link-active router-link-exact-active sidebar-item" aria-label="Variables, bifurcaciones y bucles"><!--[--><!--]--><span>Variables, bifurcaciones y bucles <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#funciones-y-recursion" class="router-link-active router-link-exact-active sidebar-item" aria-label="Funciones y recursión"><!--[--><!--]--><span>Funciones y recursión <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#modulos-y-clases" class="router-link-active router-link-exact-active sidebar-item" aria-label="Módulos y clases"><!--[--><!--]--><span>Módulos y clases <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#formularios" class="router-link-active router-link-exact-active sidebar-item" aria-label="Formularios"><!--[--><!--]--><span>Formularios <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#conversaciones-paralelas" class="router-link-active router-link-exact-active sidebar-item" aria-label="Conversaciones paralelas"><!--[--><!--]--><span>Conversaciones paralelas <!--v-if--></span><!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/es/plugins/conversations.html#como-funciona-entre-bastidores" class="router-link-active router-link-exact-active sidebar-item" aria-label="Cómo funciona entre bastidores"><!--[--><!--]--><span>Cómo funciona entre bastidores <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#como-se-puede-utilizar" class="router-link-active router-link-exact-active sidebar-item" aria-label="Cómo se puede utilizar"><!--[--><!--]--><span>Cómo se puede utilizar <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#inspeccion-de-conversaciones-activas" class="router-link-active router-link-exact-active sidebar-item" aria-label="Inspección de conversaciones activas"><!--[--><!--]--><span>Inspección de conversaciones activas <!--v-if--></span><!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/es/plugins/conversations.html#como-funciona" class="router-link-active router-link-exact-active sidebar-item" aria-label="Cómo funciona"><!--[--><!--]--><span>Cómo funciona <!--v-if--></span><!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/es/plugins/conversations.html#como-funcionan-las-llamadas-wait" class="router-link-active router-link-exact-active sidebar-item" aria-label="Cómo funcionan las llamadas wait"><!--[--><!--]--><span>Cómo funcionan las llamadas wait <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/es/plugins/conversations.html#como-interceptar-la-ejecucion-de-una-funcion" class="router-link-active router-link-exact-active sidebar-item" aria-label="Cómo interceptar la ejecución de una función"><!--[--><!--]--><span>Cómo interceptar la ejecución de una función <!--v-if--></span><!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/es/plugins/conversations.html#resumen-del-plugin" class="router-link-active router-link-exact-active sidebar-item" aria-label="Resumen del plugin"><!--[--><!--]--><span>Resumen del plugin <!--v-if--></span><!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="conversaciones-conversations" tabindex="-1"><a class="header-anchor" href="#conversaciones-conversations" aria-hidden="true">#</a> Conversaciones (<code>conversations</code>)</h1><div class="tag-group" style=""><!--[--><!----><!--]--></div><p>Crea potentes interfaces conversacionales con facilidad.</p><h2 id="introduccion" tabindex="-1"><a class="header-anchor" href="#introduccion" aria-hidden="true">#</a> Introducción</h2><p>La mayoría de los chats consisten en algo más que un solo mensaje. (meh)</p><p>Por ejemplo, puedes querer hacer una pregunta al usuario, y luego esperar la respuesta. Esto puede incluso ir y venir varias veces, de modo que se desarrolla una conversación.</p><p>Cuando pienses en el <a href="/es/guide/middleware.html" class="">middleware</a>, te darás cuenta de que todo se basa en un único <a href="/es/guide/context.html" class="">objeto contexto</a> por manejador. Esto significa que siempre se maneja un solo mensaje de forma aislada. No es fácil escribir algo como “comprobar el texto de hace tres mensajes” o algo así.</p><p><strong>Este plugin viene al rescate:</strong> Proporciona una forma extremadamente flexible de definir las conversaciones entre tu bot y tus usuarios.</p><p>Muchos marcos de bots te hacen definir grandes objetos de configuración con pasos y etapas y saltos y flujos de asistentes y lo que sea. Esto conduce a una gran cantidad de código repetitivo, y hace que sea difícil de seguir. <strong>Este plugin no funciona así.</strong></p><p>En su lugar, con este plugin, usarás algo mucho más poderoso: <strong>código</strong>. Básicamente, simplemente defines una función JavaScript normal que te permite definir cómo evoluciona la conversación. A medida que el bot y el usuario hablen entre sí, la función se ejecutará declaración por declaración.</p><p>(Para ser justos, en realidad no es así como funciona bajo el capó. Pero es muy útil pensarlo así). En realidad, tu función se ejecutará de manera un poco diferente, pero llegaremos a eso <a href="#esperar-a-las-actualizaciones">más tarde</a>.</p><h2 id="ejemplo-simple" tabindex="-1"><a class="header-anchor" href="#ejemplo-simple" aria-hidden="true">#</a> Ejemplo simple</h2><p>Antes de que nos sumerjamos en cómo se pueden crear conversaciones, echa un vistazo a un breve ejemplo de JavaScript de cómo se verá una conversación.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">saludo</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Hola! ¿Cuál es tu nombre?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> mensaje <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">¡Bienvenido al chat, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mensaje<span class="token punctuation">.</span>texto<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>En esta conversación, el bot saludará primero al usuario y le preguntará su nombre. Luego esperará hasta que el usuario envíe su nombre. Por último, el bot da la bienvenida al usuario al chat, repitiendo el nombre.</p><p>Fácil, ¿verdad? ¡Veamos cómo se hace!</p><h2 id="funciones-del-constructor-de-conversaciones" tabindex="-1"><a class="header-anchor" href="#funciones-del-constructor-de-conversaciones" aria-hidden="true">#</a> Funciones del Constructor de Conversaciones</h2><p>En primer lugar, vamos a importar algunas cosas.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">Deno</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token keyword">type</span> <span class="token class-name">Conversation</span><span class="token punctuation">,</span>
  <span class="token keyword">type</span> <span class="token class-name">ConversationFlavor</span><span class="token punctuation">,</span>
  conversations<span class="token punctuation">,</span>
  createConversation<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@grammyjs/conversations&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>
  conversations<span class="token punctuation">,</span>
  createConversation<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@grammyjs/conversations&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token keyword">type</span> <span class="token class-name">Conversation</span><span class="token punctuation">,</span>
  <span class="token keyword">type</span> <span class="token class-name">ConversationFlavor</span><span class="token punctuation">,</span>
  conversations<span class="token punctuation">,</span>
  createConversation<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;https://deno.land/x/grammy_conversations@v1.0.3/mod.ts&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Una vez aclarado esto, podemos ver cómo definir las interfaces conversacionales.</p><p>El elemento principal de una conversación es una función con dos argumentos. A esto lo llamamos la <em>función constructora de la conversación</em>.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">saludo</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: codificar la conversación</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Veamos cuáles son los dos parámetros.</p><p><em>El segundo parámetro</em>* no es tan interesante, es sólo un objeto de contexto normal. Como siempre, se llama <code>ctx</code> y utiliza tu <a href="/es/guide/context.html#customizing-the-context-object" class="">tipo de contexto personalizado</a> (quizás llamado <code>My<wbr>Context</code>). El plugin de conversaciones exporta un <a href="/es/guide/context.html#additive-context-flavors" class="">context flavor</a> llamado <code>Conversation<wbr>Flavor</code>.</p><p><strong>El primer parámetro</strong> es el elemento central de este plugin. Se llama comúnmente <code>conversation</code>, y tiene el tipo <code>Conversación</code> (<a href="https://doc.deno.land/https://deno.land/x/grammy_conversations/mod.ts/~/Conversation" target="_blank" rel="noopener noreferrer">referencia de la API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>). Puede ser usado como un manejador para controlar la conversación, como esperar la entrada del usuario, y más. El tipo <code>Conversation</code> espera su <a href="/es/guide/context.html#customizing-the-context-object" class="">tipo de contexto personalizado</a> como parámetro de tipo, por lo que a menudo utilizaría <code>Conversation&lt;My<wbr>Context&gt;</code>.</p><p>En resumen, en TypeScript, tu función de construcción de conversación se verá así.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">MyContext</span> <span class="token operator">=</span> Context <span class="token operator">&amp;</span> ConversationFlavor<span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">MyConversation</span> <span class="token operator">=</span> Conversation<span class="token operator">&lt;</span>MyContext<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">greeting</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: codificar la conversación</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Dentro de su función de construcción de conversación, ahora puede definir cómo debe ser la conversación. Antes de profundizar en cada una de las características de este plugin, echemos un vistazo a un ejemplo más complejo que el <a href="#ejemplo-simple">simple</a> anterior.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">movie</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¿Cuántas películas favoritas tiene?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> movies<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">¡Dime el número </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> titleCtx <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token string">&quot;:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    movies<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>titleCtx<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Aquí hay una mejor clasificación!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  movies<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span>movies<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">. </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>m<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">movie</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¿Cuántas películas favoritas tiene?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> movies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">¡Dime el número </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> titleCtx <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token string">&quot;:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    movies<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>titleCtx<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Aquí hay una mejor clasificación!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  movies<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span>movies<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">. </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>m<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>¿Puedes averiguar cómo funcionará este bot?</p><h2 id="instalar-y-entrar-en-una-conversacion" tabindex="-1"><a class="header-anchor" href="#instalar-y-entrar-en-una-conversacion" aria-hidden="true">#</a> Instalar y entrar en una conversación</h2><p>En primer lugar, <strong>debes</strong> utilizar el <a href="/es/plugins/session.html" class="">plugin de sesión</a> si quieres utilizar el plugin de conversaciones. También tienes que instalar el propio plugin de conversaciones, antes de poder registrar conversaciones individuales en tu bot.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// Instalar el plugin de sesión.</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">initial</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// devuelve un objeto vacío por ahora</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Instala el plugin de conversaciones.</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">conversations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>A continuación, puedes instalar la función de construcción de conversación como middleware en tu objeto bot envolviéndola dentro de <code>create<wbr>Conversation</code>.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">createConversation</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Ahora que tu conversación está registrada en el bot, puedes entrar en la conversación desde cualquier manejador. Asegúrate de usar <code>await</code> para todos los métodos en <code>ctx<wbr>.conversation</code>—de lo contrario tu código se romperá.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;greeting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Tan pronto como el usuario envíe <code>/start</code> al bot, la conversación será introducida. El objeto de contexto actual se pasa como segundo argumento a la función de construcción de la conversación. Por ejemplo, si inicias tu conversación con <code>await ctx<wbr>.reply(ctx<wbr>.message<wbr>.text)</code>, contendrá la actualización que contiene <code>/start</code>.</p><div class="custom-container tip"><p class="custom-container-title">Cambiar el identificador de la conversación</p><p>Por defecto, tienes que pasar el nombre de la función a <code>ctx<wbr>.conversation<wbr>.enter()</code>. Sin embargo, si prefieres utilizar un identificador diferente, puedes especificarlo así</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">createConversation</span><span class="token punctuation">(</span>greeting<span class="token punctuation">,</span> <span class="token string">&quot;new-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>A su vez, puedes entrar en la conversación con él:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;new-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>En total, tu código debería tener ahora más o menos este aspecto:</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">Deno</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Bot<span class="token punctuation">,</span> Context<span class="token punctuation">,</span> session <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;grammy&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token keyword">type</span> <span class="token class-name">Conversation</span><span class="token punctuation">,</span>
  <span class="token keyword">type</span> <span class="token class-name">ConversationFlavor</span><span class="token punctuation">,</span>
  conversations<span class="token punctuation">,</span>
  createConversation<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@grammyjs/conversations&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">MyContext</span> <span class="token operator">=</span> Context <span class="token operator">&amp;</span> ConversationFlavor<span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">MyConversation</span> <span class="token operator">=</span> Conversation<span class="token operator">&lt;</span>MyContext<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> bot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bot<span class="token operator">&lt;</span>MyContext<span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">initial</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">conversations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/** Define la conversación */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">greeting</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: codificar la conversación</span>
<span class="token punctuation">}</span>

bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">createConversation</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// introduce la función &quot;saludo&quot; que has declarado</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;greeting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> Bot<span class="token punctuation">,</span> Context<span class="token punctuation">,</span> session <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;grammy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>
  conversations<span class="token punctuation">,</span>
  createConversation<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@grammyjs/conversations&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> bot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bot</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">initial</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">conversations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/** Define la conversación */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">greeting</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: codificar la conversación</span>
<span class="token punctuation">}</span>

bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">createConversation</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// introduce la función &quot;saludo&quot; que has declarado</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;greeting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Bot<span class="token punctuation">,</span> Context<span class="token punctuation">,</span> session <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;https://deno.land/x/grammy@v1.11.1/mod.ts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token keyword">type</span> <span class="token class-name">Conversation</span><span class="token punctuation">,</span>
  <span class="token keyword">type</span> <span class="token class-name">ConversationFlavor</span><span class="token punctuation">,</span>
  conversations<span class="token punctuation">,</span>
  createConversation<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;https://deno.land/x/grammy_conversations@v1.0.3/mod.ts&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">MyContext</span> <span class="token operator">=</span> Context <span class="token operator">&amp;</span> ConversationFlavor<span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">MyConversation</span> <span class="token operator">=</span> Conversation<span class="token operator">&lt;</span>MyContext<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> bot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bot<span class="token operator">&lt;</span>MyContext<span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">initial</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">conversations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/** Define la conversación */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">greeting</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: codificar la conversación</span>
<span class="token punctuation">}</span>

bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">createConversation</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// introduce la función &quot;saludo&quot; que has declarado</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;greeting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><h2 id="salir-de-una-conversacion" tabindex="-1"><a class="header-anchor" href="#salir-de-una-conversacion" aria-hidden="true">#</a> Salir de una conversación</h2><p>La conversación se ejecutará hasta que su función de construcción de conversación se complete. Esto significa que puedes simplemente dejar una conversación usando <code>return</code>.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">hiAndBye</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Hola! ¡Y adiós!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Deja la conversación:</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">hiAndBye</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Hola! ¡Y adiós!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Deja la conversación:</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>(Sí, poner un <code>return</code> al final de la función es un poco inútil, pero se entiende la idea).</p><p>También puedes lanzar un error. Esto también saldrá de la conversación. Recuerda <a href="/es/guide/errors.html" class="">instalar un manejador de errores</a> en tu bot.</p><p>Si quieres acabar con la conversación mientras espera la entrada del usuario, también puedes usar <code>await ctx<wbr>.conversation<wbr>.exit()</code>. A menudo es mejor quedarse con el simple retorno de la función, pero hay algunos ejemplos en los que el uso de <code>await ctx<wbr>.conversation<wbr>.exit()</code> es conveniente. Recuerda que debes <code>esperar</code> la llamada.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">movie</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: definir la conversación</span>
<span class="token punctuation">}</span>

<span class="token comment">// Instalar el plugin de conversaciones.</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">conversations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Salir siempre de cualquier conversación tras /cancelar</span>
bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;cancel&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;Saliendo.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Salir siempre de la conversación de la `movie` </span>
<span class="token comment">// cuando se pulsa el botón de `cancel` del teclado en línea.</span>
bot<span class="token punctuation">.</span><span class="token function">callbackQuery</span><span class="token punctuation">(</span><span class="token string">&quot;cancel&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">answerCallbackQuery</span><span class="token punctuation">(</span><span class="token string">&quot;Dejando la conversación&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">&quot;movie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">createConversation</span><span class="token punctuation">(</span>movie<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;movie&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;movie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">movie</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: definir la conversación</span>
<span class="token punctuation">}</span>

<span class="token comment">// Instalar el plugin de conversaciones.</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">conversations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Salir siempre de cualquier conversación tras /cancelar</span>
bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;cancel&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;Saliendo.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Salir siempre de la conversación de la `movie` </span>
<span class="token comment">// cuando se pulsa el botón de `cancel` del teclado en línea.</span>
bot<span class="token punctuation">.</span><span class="token function">callbackQuery</span><span class="token punctuation">(</span><span class="token string">&quot;cancel&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">answerCallbackQuery</span><span class="token punctuation">(</span><span class="token string">&quot;Dejando la conversación&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">&quot;movie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">createConversation</span><span class="token punctuation">(</span>movie<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;movie&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;movie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Tenga en cuenta que el orden es importante aquí. Primero debes instalar el plugin de conversaciones (línea 6) antes de poder llamar a <code>await ctx<wbr>.conversation<wbr>.exit()</code>. Además, los manejadores de cancelación genéricos deben ser instalados antes de que las conversaciones reales (línea 21) sean registradas.</p><h2 id="esperar-a-las-actualizaciones" tabindex="-1"><a class="header-anchor" href="#esperar-a-las-actualizaciones" aria-hidden="true">#</a> Esperar a las actualizaciones</h2><p>Puedes usar el manejador de conversación <code>conversation</code> para esperar la siguiente actualización en este chat en particular.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">waitForMe</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Espere a la próxima actualización:</span>
  <span class="token keyword">const</span> newContext <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">waitForMe</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Espere a la próxima actualización:</span>
  <span class="token keyword">const</span> newContext <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Una actualización puede significar que se ha enviado un mensaje de texto, o que se ha pulsado un botón, o que se ha editado algo, o prácticamente cualquier otra acción realizada por el usuario. Consulta la lista completa en los documentos de Telegram <a href="https://core.telegram.org/bots/api#update" target="_blank" rel="noopener noreferrer">aquí<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>Normalmente, fuera del plugin de conversaciones, cada una de estas actualizaciones sería manejada por el <a href="/es/guide/middleware.html" class="">sistema de middleware</a> de tu bot. Por lo tanto, tu bot manejaría la actualización a través de un objeto de contexto que se pasa a tus manejadores.</p><p>En las conversaciones, obtendrá este nuevo objeto de contexto de la llamada <code>wait</code>. A su vez, puedes manejar diferentes actualizaciones de manera diferente en base a este objeto. Por ejemplo, puedes comprobar si hay mensajes de texto:</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">waitForText</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Espere a la próxima actualización:</span>
  ctx <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Comprueba el texto:</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>message<span class="token operator">?.</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">waitForText</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Espere a la próxima actualización:</span>
  ctx <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Comprueba el texto:</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>message<span class="token operator">?.</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Además, existen otros métodos junto a <code>wait</code> que permiten esperar sólo actualizaciones específicas. Un ejemplo es <code>wait<wbr>For</code> que toma una <a href="/es/guide/filter-queries.html" class="">consulta de filtro</a> y luego sólo espera las actualizaciones que coincidan con la consulta proporcionada. Esto es especialmente potente en combinación con <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" target="_blank" rel="noopener noreferrer">desestructuración de objetos<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>:</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">waitForText</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Espere a la siguiente actualización de los mensajes de texto:</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> msg<span class="token operator">:</span> <span class="token punctuation">{</span> text <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token string">&quot;message:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">waitForText</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Espere a la siguiente actualización de los mensajes de texto:</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token punctuation">{</span> text <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token string">&quot;message:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Consulta la <a href="https://doc.deno.land/https://deno.land/x/grammy_conversations/mod.ts/~/ConversationHandle#wait" target="_blank" rel="noopener noreferrer">referencia de la API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> para ver todos los métodos disponibles que son similares a <code>wait</code>.</p><p>Veamos ahora cómo funcionan realmente las llamadas wait. Como se mencionó anteriormente, <strong>no hacen <em>literalmente</em> que tu bot espere</strong>, aunque podemos programar las conversaciones como si ese fuera el caso.</p><h2 id="tres-reglas-de-oro-de-las-conversaciones" tabindex="-1"><a class="header-anchor" href="#tres-reglas-de-oro-de-las-conversaciones" aria-hidden="true">#</a> Tres reglas de oro de las conversaciones</h2><p>Hay tres reglas que se aplican al código que escribes dentro de una función constructora de conversaciones. Debes seguirlas si quieres que tu código se comporte correctamente.</p><p>Desplázate <a href="#como-funciona">hacia abajo</a> si quieres saber más sobre <em>por qué</em> se aplican estas reglas, y qué hacen realmente las llamadas <code>wait</code> internamente.</p><h3 id="regla-i-todos-los-efectos-secundarios-deben-estar-envueltos" tabindex="-1"><a class="header-anchor" href="#regla-i-todos-los-efectos-secundarios-deben-estar-envueltos" aria-hidden="true">#</a> Regla I: Todos los efectos secundarios deben estar envueltos</h3><p>El código que depende de un sistema externo, como bases de datos, APIs, archivos u otros recursos que podrían cambiar de una ejecución a otra, debe ser envuelto en llamadas <code>conversation<wbr>.external()</code>.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// MAL</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">externalApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// BIEN</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">external</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">externalApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Esto incluye tanto la lectura de datos como la realización de efectos secundarios (como la escritura en una base de datos).</p><div class="custom-container tip"><p class="custom-container-title">Comparable a React</p><p>Si estás familiarizado con React, puede que conozcas un concepto comparable de <code>use<wbr>Effect</code>.</p></div><h3 id="regla-ii-todo-comportamiento-aleatorio-debe-estar-envuelto" tabindex="-1"><a class="header-anchor" href="#regla-ii-todo-comportamiento-aleatorio-debe-estar-envuelto" aria-hidden="true">#</a> Regla II: Todo comportamiento aleatorio debe estar envuelto</h3><p>El código que depende de la aleatoriedad o del estado global que podría cambiar, debe envolver todo el acceso a él en llamadas a <code>conversation<wbr>.external()</code>, o utilizar la función de conveniencia <code>conversation<wbr>.random()</code>.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// MAL</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* hace cosas */</span> <span class="token punctuation">}</span>
<span class="token comment">// BIEN</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>conversation<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* hace cosas */</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="regla-iii-usar-funciones-de-conveniencia" tabindex="-1"><a class="header-anchor" href="#regla-iii-usar-funciones-de-conveniencia" aria-hidden="true">#</a> Regla III: Usar funciones de conveniencia</h3><p>Hay un montón de cosas instaladas en <code>conversación</code> que pueden ayudarte mucho. Tu código no se rompe exactamente si no las usas, pero puede ser lento o comportarse de forma confusa. Sin embargo, el usuario final puede no notar la diferencia.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// Dormir a través de la conversación, mejora masiva del rendimiento</span>
<span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3 segundos</span>

<span class="token comment">// Depurar el registro a través de la conversación, no imprime registros confusos</span>
conversation<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hola, mundo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Ten en cuenta que puedes hacer todo lo anterior a través de <code>conversation<wbr>.external()</code>, pero esto puede ser tedioso de escribir, así que es más fácil usar las funciones de conveniencia (<a href="https://doc.deno.land/https://deno.land/x/grammy_conversations/mod.ts/~/ConversationHandle#Methods" target="_blank" rel="noopener noreferrer">referencia de la API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>).</p><h2 id="variables-bifurcaciones-y-bucles" tabindex="-1"><a class="header-anchor" href="#variables-bifurcaciones-y-bucles" aria-hidden="true">#</a> Variables, bifurcaciones y bucles</h2><p>Si sigues las tres reglas anteriores, eres completamente libre de usar el código que quieras. Ahora repasaremos algunos conceptos que ya conoces de programación, y mostraremos cómo se traducen en conversaciones limpias y legibles.</p><p>Imagina que todo el código de abajo está escrito dentro de una función de construcción de conversación.</p><p>Puedes declarar variables y hacer lo que quieras con ellas:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Envíame tus números favoritos, separados por comas!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token string">&quot;message:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> suma <span class="token operator">=</span> message<span class="token punctuation">.</span>texto
  <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;La suma de estos números es: &quot;</span> <span class="token operator">+</span> suma<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>La ramificación también funciona:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Envíame una foto!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>message<span class="token operator">?.</span>photo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Eso no es una foto! ¡Estoy fuera!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>También lo hacen los bucles:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">do</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Envíame una foto!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>message<span class="token operator">?.</span>text <span class="token operator">===</span> <span class="token string">&quot;/cancel&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Cancelado, me voy!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>ctx<span class="token punctuation">.</span>message<span class="token operator">?.</span>photo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="funciones-y-recursion" tabindex="-1"><a class="header-anchor" href="#funciones-y-recursion" aria-hidden="true">#</a> Funciones y recursión</h2><p>También puedes dividir tu código en varias funciones, y reutilizarlas. Por ejemplo, así es como puedes definir un captcha reutilizable.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">captcha</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Demuestra que eres humano! ¿Cuál es la respuesta a todo?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> message<span class="token operator">?.</span>texto <span class="token operator">===</span> <span class="token string">&quot;42&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">captcha</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Demuestra que eres humano! ¿Cuál es la respuesta a todo?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> message<span class="token operator">?.</span>texto <span class="token operator">===</span> <span class="token string">&quot;42&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Devuelve <code>true</code> si el usuario puede pasar, y <code>false</code> en caso contrario. Ahora puedes usarlo en tu función principal del constructor de conversación así:</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">enterGroup</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ok <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">captcha</span><span class="token punctuation">(</span>conversation<span class="token punctuation">,</span> ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>ok<span class="token punctuation">)</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Bienvenido!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">banChatMember</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">enterGroup</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ok <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">captcha</span><span class="token punctuation">(</span>conversation<span class="token punctuation">,</span> ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>ok<span class="token punctuation">)</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Bienvenido!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">banChatMember</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Vea cómo la función captcha puede ser reutilizada en diferentes lugares de su código.</p><blockquote><p>Este sencillo ejemplo sólo pretende ilustrar cómo funcionan las funciones. En realidad, puede funcionar mal porque sólo espera una nueva actualización del chat respectivo, pero sin verificar que realmente proviene del mismo usuario que se unió. Si quieres crear un captcha real, puedes usar <a href="#conversaciones-paralelas">conversaciones paralelas</a>.</p></blockquote><p>Si quieres, también puedes dividir tu código en más funciones, o usar recursión, recursión mutua, generadores, etc. (Sólo asegúrese de que todas las funciones siguen las <a href="#tres-reglas-de-oro-de-las-conversaciones">tres reglas</a>.</p><p>Naturalmente, también puedes usar el manejo de errores en tus funciones. Las declaraciones regulares <code>try</code>/<code>catch</code> funcionan bien, también en las funciones. Después de todo, las conversaciones son sólo JavaScript.</p><p>Si la función de conversación principal arroja un error, el error se propagará más allá en los [mecanismos de manejo de errores] (…/guide/errors.md) de tu bot.</p><h2 id="modulos-y-clases" tabindex="-1"><a class="header-anchor" href="#modulos-y-clases" aria-hidden="true">#</a> Módulos y clases</h2><p>Naturalmente, puedes mover tus funciones a través de los módulos. De esta manera, puedes definir algunas funciones en un archivo, <code>exportarlas</code>, y luego <code>importarlas</code> y usarlas en otro archivo.</p><p>Si quieres, también puedes definir clases.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Auth</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> token<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">authenticate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> link <span class="token operator">=</span> <span class="token function">getAuthLink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obtener el enlace de autentificación de su sistema</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span>
      <span class="token string">&quot;Abre este enlace para obtener una ficha, y envíamela: &quot;</span> <span class="token operator">+</span> link<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">=</span> ctx<span class="token punctuation">.</span>message<span class="token operator">?.</span>text<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">isAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span> <span class="token keyword">is</span> Auth <span class="token operator">&amp;</span> <span class="token punctuation">{</span> token<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">askForToken</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> auth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Auth</span><span class="token punctuation">(</span>conversation<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> auth<span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>auth<span class="token punctuation">.</span><span class="token function">isAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> token <span class="token operator">=</span> auth<span class="token punctuation">.</span>token<span class="token punctuation">;</span>
    <span class="token comment">// haz cosas con el token</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Auth</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">conversation</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#conversation <span class="token operator">=</span> conversation<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> link <span class="token operator">=</span> <span class="token function">getAuthLink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obtener el enlace de autentificación de su sistema</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span>
      <span class="token string">&quot;Abre este enlace para obtener una ficha, y envíamela: &quot;</span> <span class="token operator">+</span> link<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#conversation<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">=</span> ctx<span class="token punctuation">.</span>message<span class="token operator">?.</span>text<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">isAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">askForToken</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> auth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Auth</span><span class="token punctuation">(</span>conversation<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> auth<span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>auth<span class="token punctuation">.</span><span class="token function">isAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> token <span class="token operator">=</span> auth<span class="token punctuation">.</span>token<span class="token punctuation">;</span>
    <span class="token comment">// haz cosas con el token</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>El punto aquí no es tanto que recomendemos estrictamente hacer esto. Se trata más bien de un ejemplo de cómo puede utilizar las infinitas flexibilidades de JavaScript para estructurar su código.</p><h2 id="formularios" tabindex="-1"><a class="header-anchor" href="#formularios" aria-hidden="true">#</a> Formularios</h2><p>Como se mencionó <a href="#esperar-a-las-actualizaciones">anteriormente</a>, hay varias funciones de utilidad diferentes en el manejador de la conversación, como <code>await conversation<wbr>.wait<wbr>For(&#39;message:<wbr>text&#39;)</code> que sólo devuelve las actualizaciones de los mensajes de texto.</p><p>Si estos métodos no son suficientes, el plugin de conversaciones proporciona aún más funciones de ayuda para construir formularios a través de <code>conversation<wbr>.form</code>.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">waitForMe</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¿Qué edad tienes?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> age<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">waitForMe</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¿Qué edad tienes?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Como siempre, consulte la <a href="https://doc.deno.land/https://deno.land/x/grammy_conversations/mod.ts/~/ConversationForm" target="_blank" rel="noopener noreferrer">referencia de la API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> para ver qué métodos están disponibles.</p><h2 id="conversaciones-paralelas" tabindex="-1"><a class="header-anchor" href="#conversaciones-paralelas" aria-hidden="true">#</a> Conversaciones paralelas</h2><p>Naturalmente, el plugin de conversaciones puede ejecutar cualquier número de conversaciones en paralelo en diferentes chats.</p><p>Sin embargo, si tu bot se añade a un chat de grupo, puede querer tener conversaciones con varios usuarios diferentes en paralelo <em>en el mismo chat</em>. Por ejemplo, si tu bot tiene un captcha que quiere enviar a todos los nuevos miembros. Si dos miembros se unen al mismo tiempo, el bot debería ser capaz de mantener dos conversaciones independientes con ellos.</p><p>Por eso el plugin de conversaciones permite introducir varias conversaciones al mismo tiempo para cada chat. Por ejemplo, es posible tener cinco conversaciones diferentes con cinco nuevos usuarios, y al mismo tiempo chatear con un administrador sobre la nueva configuración del chat.</p><h3 id="como-funciona-entre-bastidores" tabindex="-1"><a class="header-anchor" href="#como-funciona-entre-bastidores" aria-hidden="true">#</a> Cómo funciona entre bastidores</h3><p>Cada actualización entrante sólo será manejada por una de las conversaciones activas en un chat. Comparable a los manejadores de middleware, las conversaciones serán llamadas en el orden en que son registradas. Si una conversación se inicia varias veces, estas instancias de la conversación serán llamadas en orden cronológico.</p><p>Cada conversación puede entonces manejar la actualización, o puede llamar a <code>await conversation<wbr>.skip()</code>. En el primer caso, la actualización simplemente se consumirá mientras la conversación la maneja. En el segundo caso, la conversación deshará efectivamente la recepción de la actualización, y la pasará a la siguiente conversación. Si todas las conversaciones omiten una actualización, el flujo de control será devuelto al sistema de middleware, y ejecutará cualquier manejador posterior.</p><p>Esto permite iniciar una nueva conversación desde el middleware regular.</p><h3 id="como-se-puede-utilizar" tabindex="-1"><a class="header-anchor" href="#como-se-puede-utilizar" aria-hidden="true">#</a> Cómo se puede utilizar</h3><p>En la práctica, nunca necesitas llamar a <code>await conversation<wbr>.skip()</code> en absoluto. En su lugar, puedes usar cosas como <code>await conversation<wbr>.wait<wbr>From(user<wbr>Id)</code>, que se encargará de los detalles por ti. Esto te permite chatear con un solo usuario en un chat de grupo.</p><p>Por ejemplo, vamos a implementar el ejemplo del captcha de aquí arriba de nuevo, pero esta vez con conversaciones paralelas.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TypeScript</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">JavaScript</button></li></ul></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true"><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">captcha</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>from <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Demuestra que eres humano! ¿Cuál es la respuesta a todo?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">waitFrom</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> message<span class="token operator">?.</span>text <span class="token operator">===</span> <span class="token string">&quot;42&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">enterGroup</span><span class="token punctuation">(</span>conversation<span class="token operator">:</span> MyConversation<span class="token punctuation">,</span> ctx<span class="token operator">:</span> MyContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ok <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">captcha</span><span class="token punctuation">(</span>conversation<span class="token punctuation">,</span> ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>ok<span class="token punctuation">)</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Bienvenido!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">banChatMember</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">captcha</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>from <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Demuestra que eres humano! ¿Cuál es la respuesta a todo?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> conversation<span class="token punctuation">.</span><span class="token function">waitFrom</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> message<span class="token operator">?.</span>text <span class="token operator">===</span> <span class="token string">&quot;42&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">enterGroup</span><span class="token punctuation">(</span><span class="token parameter">conversation<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ok <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">captcha</span><span class="token punctuation">(</span>conversation<span class="token punctuation">,</span> ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>ok<span class="token punctuation">)</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;¡Bienvenido!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">banChatMember</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Observa cómo sólo esperamos los mensajes de un usuario en particular.</p><p>Ahora podemos tener un simple manejador que entra en la conversación cuando un nuevo miembro se une.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;chat_member&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>chatMember<span class="token punctuation">.</span>old_chat_member<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>chatMember<span class="token punctuation">.</span>new_chat_member<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">&quot;member&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token string">&quot;enterGroup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="inspeccion-de-conversaciones-activas" tabindex="-1"><a class="header-anchor" href="#inspeccion-de-conversaciones-activas" aria-hidden="true">#</a> Inspección de conversaciones activas</h3><p>Puede ver cuántas conversaciones con qué identificador se están ejecutando.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> stats <span class="token operator">=</span> ctx<span class="token punctuation">.</span>conversation<span class="token punctuation">.</span>active<span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stats<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { &quot;enterGroup&quot;: 1 }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Esto se proporcionará como un objeto que tiene los identificadores de conversación como claves, y un número que indica el número de conversaciones en curso para cada identificador.</p><h2 id="como-funciona" tabindex="-1"><a class="header-anchor" href="#como-funciona" aria-hidden="true">#</a> Cómo funciona</h2><blockquote><p><a href="#tres-reglas-de-oro-de-las-conversaciones">Recuerda</a> que el código dentro de tus funciones de construcción de conversaciones debe seguir tres reglas. Ahora vamos a ver <em>por qué</em> necesitas construirlas de esa manera.</p></blockquote><p>Primero vamos a ver cómo funciona este plugin conceptualmente, antes de elaborar algunos detalles.</p><h3 id="como-funcionan-las-llamadas-wait" tabindex="-1"><a class="header-anchor" href="#como-funcionan-las-llamadas-wait" aria-hidden="true">#</a> Cómo funcionan las llamadas <code>wait</code></h3><p>Cambiemos de perspectiva por un momento, y hagamos una pregunta desde el punto de vista de un desarrollador de plugins. ¿Cómo implementar una llamada <code>wait</code> en el plugin?</p><p>El enfoque ingenuo para implementar una llamada <code>wait</code> en el plugin de conversaciones sería crear una nueva promesa, y esperar hasta que llegue el siguiente objeto de contexto. Tan pronto como lo haga, resolvemos la promesa, y la conversación puede continuar.</p><p>Sin embargo, esto es una mala idea por varias razones.</p><p><strong>Pérdida de datos.</strong> ¿Qué pasa si tu servidor se cae mientras esperas un objeto de contexto? En ese caso, perdemos toda la información sobre el estado de la conversación. Básicamente, el bot pierde su tren de pensamiento, y el usuario tiene que empezar de nuevo. Esto es un mal diseño y molesto.</p><p><strong>Bloqueo.</strong> Si las llamadas de espera se bloquean hasta que llega la siguiente actualización, significa que la ejecución del middleware para la primera actualización no puede completarse hasta que la conversación entera se complete.</p><ul><li>Para el sondeo incorporado, esto significa que no se pueden procesar más actualizaciones hasta que la actual haya terminado. Por lo tanto, el bot simplemente se bloquearía para siempre.</li><li>Para <a href="/es/plugins/runner.html" class="">grammY runner</a>, el bot no se bloquearía. Sin embargo, al procesar miles de conversaciones en paralelo con diferentes usuarios, consumiría cantidades potencialmente muy grandes de memoria. Si muchos usuarios dejan de responder, esto deja al bot atascado en medio de innumerables conversaciones.</li><li>Los webhooks tienen su propia <a href="/es/guide/deployment-types.html#terminar-las-solicitudes-de-webhooks-a-tiempo" class="">categoría de problemas</a> con middleware de larga duración.</li></ul><p><strong>Estado.</strong> En la infraestructura sin servidor, como las funciones en la nube, no podemos asumir que la misma instancia maneja dos actualizaciones posteriores del mismo usuario. Por lo tanto, si fuéramos a crear conversaciones con estado, podrían romperse aleatoriamente todo el tiempo, ya que algunas llamadas <code>wait</code> no se resuelven, pero algún otro middleware se ejecuta de repente. El resultado es una abundancia de bugs aleatorios y caos.</p><p>Hay más problemas, pero se entiende la idea.</p><p>En consecuencia, el plugin de conversaciones hace las cosas de forma diferente. Muy diferente.</p><p>El plugin de conversaciones rastrea la ejecución de su función. Cuando se alcanza una llamada de espera, serializa el estado de ejecución en la sesión, y lo almacena de forma segura en una base de datos. Cuando llega la siguiente actualización, primero inspecciona los datos de la sesión. Si encuentra que lo dejó en medio de una conversación, deserializa el estado de ejecución, toma su función constructora de conversación y la reproduce hasta el punto de la última llamada <code>wait</code>. A continuación, reanuda la ejecución ordinaria de tu función, hasta que se alcanza la siguiente llamada <code>wait</code>, y la ejecución debe ser detenida de nuevo.</p><p>¿Qué entendemos por estado de ejecución? En pocas palabras, consiste en tres cosas</p><ol><li>Las actualizaciones entrantes</li><li>Las llamadas salientes a la API</li><li>Eventos y efectos externos, como la aleatoriedad o las llamadas a APIs o bases de datos externas</li></ol><p>¿Qué entendemos por repetición? Reproducir significa simplemente llamar a la función regularmente desde el principio, pero cuando hace cosas como llamar a <code>wait</code> o realizar llamadas a la API, en realidad no hacemos nada de eso. En su lugar, comprobamos o registramos de una ejecución anterior qué valores fueron devueltos. A continuación, inyectamos estos valores para que la función de construcción de la conversación simplemente se ejecute muy rápido - hasta que nuestros registros se agoten. En ese momento, cambiamos de nuevo al modo de ejecución normal, que es sólo una forma elegante de decir que dejamos de inyectar cosas, y empezamos a realizar realmente las llamadas a la API de nuevo.</p><p>Por eso el plugin tiene que hacer un seguimiento de todas las actualizaciones entrantes, así como de todas las llamadas a la API de los bots. (Véanse los puntos 1 y 2 anteriores). Sin embargo, el plugin no tiene control sobre los eventos externos, los efectos secundarios o la aleatoriedad. Por ejemplo, podría esto:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// hacer una cosa</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// hacer otra cosa</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>En ese caso, al llamar a la función, puede que de repente se comporte de forma diferente cada vez, por lo que la reproducción de la función se romperá. Podría funcionar aleatoriamente de forma diferente a la ejecución original. Por eso existe el punto 3, y hay que seguir las <a href="#tres-reglas-de-oro-de-las-conversaciones">Tres Reglas de Oro</a>.</p><h3 id="como-interceptar-la-ejecucion-de-una-funcion" tabindex="-1"><a class="header-anchor" href="#como-interceptar-la-ejecucion-de-una-funcion" aria-hidden="true">#</a> Cómo interceptar la ejecución de una función</h3><p>Conceptualmente hablando, las palabras clave <code>async</code> y <code>await</code> nos dan el control sobre el lugar en el que el hilo es <a href="https://en.wikipedia.org/wiki/Preemption_(computing)" target="_blank" rel="noopener noreferrer">preempted<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. Por lo tanto, si alguien llama a la conversación <code>await<wbr>.wait()</code>, que es una función de nuestra biblioteca, se nos da el poder de adelantarnos a la ejecución.</p><p>Concretamente, la primitiva secreta del núcleo que nos permite interrumpir la ejecución de una función es una <code>Promise</code> que nunca se resuelve.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">never</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// BOOM</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Si esperas una promesa de este tipo en cualquier archivo JavaScript, tu tiempo de ejecución terminará instantáneamente. (Siéntase libre de pegar el código anterior en un archivo y probarlo).</p><p>Como obviamente no queremos matar el runtime de JS, tenemos que atrapar esto de nuevo. ¿Cómo lo harías? (Siéntase libre de revisar el código fuente del plugin si esto no es inmediatamente obvio para usted).</p><h2 id="resumen-del-plugin" tabindex="-1"><a class="header-anchor" href="#resumen-del-plugin" aria-hidden="true">#</a> Resumen del plugin</h2><ul><li>Name: <code>conversations</code></li><li>Source: <a href="https://github.com/grammyjs/conversations" target="_blank" rel="noopener noreferrer">https://<wbr>github<wbr>.com<wbr>/grammyjs<wbr>/conversations<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Reference: <a href="https://doc.deno.land/https://deno.land/x/grammy_conversations/mod.ts" target="_blank" rel="noopener noreferrer">https://<wbr>doc<wbr>.deno<wbr>.land<wbr>/https://<wbr>deno<wbr>.land<wbr>/x<wbr>/grammy<wbr>_conversations<wbr>/mod<wbr>.ts<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/grammyjs/website/edit/main/site/docs/es/plugins/conversations.md" rel="noopener noreferrer" target="_blank" aria-label="Editar esta página en GitHub"><!--[--><!--]--><span>Editar esta página en GitHub <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Última actualización: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Colaboradores: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: git.fytyt@aleeas.com">Ciki Momogi</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: shtrog@gmail.com">KnorpelSenf</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: ez@roj.im">Roj</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: 99770068+sartoshi-foot-dao@users.noreply.github.com">sartoshi-foot-dao</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.ff0cf306.js" defer></script>
  </body>
</html>
