<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>Filter 参数与 bot.on() | grammY</title><meta name="description" content="Telegram Bot 框架">
    <link rel="modulepreload" href="/assets/app.ff0cf306.js"><link rel="modulepreload" href="/assets/filter-queries.html.815a1b7b.js"><link rel="modulepreload" href="/assets/filter-query-search.b06c500c.js"><link rel="modulepreload" href="/assets/filter-queries.html.dab2ea34.js"><link rel="prefetch" href="/assets/index.html.0429b483.js"><link rel="prefetch" href="/assets/index.html.2401d292.js"><link rel="prefetch" href="/assets/deployment.html.820945fa.js"><link rel="prefetch" href="/assets/flood.html.064205fe.js"><link rel="prefetch" href="/assets/middleware.html.992dcb0e.js"><link rel="prefetch" href="/assets/proxy.html.c404e72a.js"><link rel="prefetch" href="/assets/reliability.html.5a572dfa.js"><link rel="prefetch" href="/assets/scaling.html.fe634161.js"><link rel="prefetch" href="/assets/structuring.html.1e8ebd48.js"><link rel="prefetch" href="/assets/transformers.html.3e1cae77.js"><link rel="prefetch" href="/assets/index.html.fb39b504.js"><link rel="prefetch" href="/assets/examples.html.4b7b6125.js"><link rel="prefetch" href="/assets/index.html.e45b3ea7.js"><link rel="prefetch" href="/assets/index.html.172886ab.js"><link rel="prefetch" href="/assets/api.html.d34afc0f.js"><link rel="prefetch" href="/assets/basics.html.65923044.js"><link rel="prefetch" href="/assets/commands.html.c2610c77.js"><link rel="prefetch" href="/assets/context.html.d7289dc7.js"><link rel="prefetch" href="/assets/deployment-types.html.346b4d4f.js"><link rel="prefetch" href="/assets/errors.html.d567f2e9.js"><link rel="prefetch" href="/assets/files.html.5df1fdf3.js"><link rel="prefetch" href="/assets/filter-queries.html.ff3c15e1.js"><link rel="prefetch" href="/assets/games.html.ebb92d65.js"><link rel="prefetch" href="/assets/getting-started.html.3aad9f5a.js"><link rel="prefetch" href="/assets/inline-queries.html.9fa5435e.js"><link rel="prefetch" href="/assets/introduction.html.d062e0ed.js"><link rel="prefetch" href="/assets/middleware.html.c32c1afb.js"><link rel="prefetch" href="/assets/comparison.html.864b515f.js"><link rel="prefetch" href="/assets/deno-deploy.html.33fda6ac.js"><link rel="prefetch" href="/assets/gcf.html.94978e12.js"><link rel="prefetch" href="/assets/heroku.html.f4861855.js"><link rel="prefetch" href="/assets/supabase.html.f931ecc3.js"><link rel="prefetch" href="/assets/vps.html.f8b61457.js"><link rel="prefetch" href="/assets/index.html.564f39e8.js"><link rel="prefetch" href="/assets/index.html.cc711d93.js"><link rel="prefetch" href="/assets/auto-retry.html.76b5ce1b.js"><link rel="prefetch" href="/assets/autoquote.html.f8611f7b.js"><link rel="prefetch" href="/assets/command-filter.html.12deb6e8.js"><link rel="prefetch" href="/assets/console-time.html.bbb18311.js"><link rel="prefetch" href="/assets/conversations.html.542d4ede.js"><link rel="prefetch" href="/assets/emoji.html.96b685bd.js"><link rel="prefetch" href="/assets/files.html.59f0953c.js"><link rel="prefetch" href="/assets/fluent.html.93e75a53.js"><link rel="prefetch" href="/assets/guide.html.4a675f4a.js"><link rel="prefetch" href="/assets/hydrate.html.4d6c9f6e.js"><link rel="prefetch" href="/assets/i18n.html.b886c9b6.js"><link rel="prefetch" href="/assets/keyboard.html.5d3ef392.js"><link rel="prefetch" href="/assets/menu.html.97fd78f5.js"><link rel="prefetch" href="/assets/middlewares.html.4527fc91.js"><link rel="prefetch" href="/assets/parse-mode.html.5fea1fba.js"><link rel="prefetch" href="/assets/ratelimiter.html.09dbf6ad.js"><link rel="prefetch" href="/assets/router.html.02606ebd.js"><link rel="prefetch" href="/assets/runner.html.fb3b00e6.js"><link rel="prefetch" href="/assets/session.html.a3ebd553.js"><link rel="prefetch" href="/assets/stateless-question.html.acdd39e3.js"><link rel="prefetch" href="/assets/transformer-throttler.html.009b0e9c.js"><link rel="prefetch" href="/assets/about.html.e9ce3575.js"><link rel="prefetch" href="/assets/comparison.html.5589e0a7.js"><link rel="prefetch" href="/assets/faq.html.4a46d2bc.js"><link rel="prefetch" href="/assets/index.html.8d516f91.js"><link rel="prefetch" href="/assets/index.html.0ea21131.js"><link rel="prefetch" href="/assets/deployment.html.947cfd03.js"><link rel="prefetch" href="/assets/flood.html.adb704f3.js"><link rel="prefetch" href="/assets/middleware.html.62700685.js"><link rel="prefetch" href="/assets/proxy.html.d9e32858.js"><link rel="prefetch" href="/assets/reliability.html.214116d2.js"><link rel="prefetch" href="/assets/scaling.html.17ebd1a5.js"><link rel="prefetch" href="/assets/structuring.html.b2cc831f.js"><link rel="prefetch" href="/assets/transformers.html.0d715264.js"><link rel="prefetch" href="/assets/index.html.655275db.js"><link rel="prefetch" href="/assets/examples.html.4da510e2.js"><link rel="prefetch" href="/assets/index.html.b68e7c4e.js"><link rel="prefetch" href="/assets/api.html.864221a5.js"><link rel="prefetch" href="/assets/basics.html.d83b67aa.js"><link rel="prefetch" href="/assets/commands.html.0c654628.js"><link rel="prefetch" href="/assets/context.html.684cfc10.js"><link rel="prefetch" href="/assets/deployment-types.html.66bb2eb6.js"><link rel="prefetch" href="/assets/errors.html.3bd197a1.js"><link rel="prefetch" href="/assets/files.html.b3f5719d.js"><link rel="prefetch" href="/assets/filter-queries.html.2fc848b9.js"><link rel="prefetch" href="/assets/games.html.ed2eeb11.js"><link rel="prefetch" href="/assets/getting-started.html.bee7700c.js"><link rel="prefetch" href="/assets/inline-queries.html.3dd234a2.js"><link rel="prefetch" href="/assets/introduction.html.2c38a111.js"><link rel="prefetch" href="/assets/middleware.html.956472a4.js"><link rel="prefetch" href="/assets/comparison.html.62a530ba.js"><link rel="prefetch" href="/assets/deno-deploy.html.9ad88492.js"><link rel="prefetch" href="/assets/gcf.html.dbb08649.js"><link rel="prefetch" href="/assets/heroku.html.1a7f1f38.js"><link rel="prefetch" href="/assets/supabase.html.4ce4dd3e.js"><link rel="prefetch" href="/assets/vps.html.7964c3ff.js"><link rel="prefetch" href="/assets/index.html.d277051d.js"><link rel="prefetch" href="/assets/auto-retry.html.627c099e.js"><link rel="prefetch" href="/assets/autoquote.html.931147c8.js"><link rel="prefetch" href="/assets/command-filter.html.24250ac2.js"><link rel="prefetch" href="/assets/console-time.html.c602475c.js"><link rel="prefetch" href="/assets/conversations.html.34bdf713.js"><link rel="prefetch" href="/assets/emoji.html.4340fe04.js"><link rel="prefetch" href="/assets/files.html.0ce1beed.js"><link rel="prefetch" href="/assets/fluent.html.2312cffa.js"><link rel="prefetch" href="/assets/guide.html.cdc01534.js"><link rel="prefetch" href="/assets/hydrate.html.e78bac27.js"><link rel="prefetch" href="/assets/i18n.html.7a67a704.js"><link rel="prefetch" href="/assets/keyboard.html.6c1187da.js"><link rel="prefetch" href="/assets/menu.html.2390f9b0.js"><link rel="prefetch" href="/assets/middlewares.html.8fb2b4c6.js"><link rel="prefetch" href="/assets/parse-mode.html.6084b065.js"><link rel="prefetch" href="/assets/ratelimiter.html.e9ab9086.js"><link rel="prefetch" href="/assets/router.html.49ad6cc8.js"><link rel="prefetch" href="/assets/runner.html.2e392816.js"><link rel="prefetch" href="/assets/session.html.bc00753b.js"><link rel="prefetch" href="/assets/stateless-question.html.840ef874.js"><link rel="prefetch" href="/assets/transformer-throttler.html.a0519c22.js"><link rel="prefetch" href="/assets/about.html.6acc59e5.js"><link rel="prefetch" href="/assets/comparison.html.19d2b82f.js"><link rel="prefetch" href="/assets/faq.html.525026ef.js"><link rel="prefetch" href="/assets/index.html.c671af3a.js"><link rel="prefetch" href="/assets/deployment.html.890ba700.js"><link rel="prefetch" href="/assets/flood.html.99fc87f0.js"><link rel="prefetch" href="/assets/middleware.html.93e739dc.js"><link rel="prefetch" href="/assets/proxy.html.a206407d.js"><link rel="prefetch" href="/assets/reliability.html.77f11b74.js"><link rel="prefetch" href="/assets/scaling.html.b0186def.js"><link rel="prefetch" href="/assets/structuring.html.431bf13f.js"><link rel="prefetch" href="/assets/transformers.html.76eb6336.js"><link rel="prefetch" href="/assets/index.html.629ca643.js"><link rel="prefetch" href="/assets/examples.html.cea54aec.js"><link rel="prefetch" href="/assets/index.html.374cf0b5.js"><link rel="prefetch" href="/assets/api.html.a789ac69.js"><link rel="prefetch" href="/assets/basics.html.a5f54cb2.js"><link rel="prefetch" href="/assets/commands.html.f5bc337a.js"><link rel="prefetch" href="/assets/context.html.e94c9f2e.js"><link rel="prefetch" href="/assets/deployment-types.html.d3d220f8.js"><link rel="prefetch" href="/assets/errors.html.cb531b7a.js"><link rel="prefetch" href="/assets/files.html.1cbd9c21.js"><link rel="prefetch" href="/assets/filter-queries.html.18865e77.js"><link rel="prefetch" href="/assets/games.html.019dc6f4.js"><link rel="prefetch" href="/assets/getting-started.html.cdb13cc0.js"><link rel="prefetch" href="/assets/inline-queries.html.02267dd2.js"><link rel="prefetch" href="/assets/introduction.html.e8487eb7.js"><link rel="prefetch" href="/assets/middleware.html.beeb4db0.js"><link rel="prefetch" href="/assets/comparison.html.ece5207a.js"><link rel="prefetch" href="/assets/deno-deploy.html.8cd18a25.js"><link rel="prefetch" href="/assets/gcf.html.bf1ad988.js"><link rel="prefetch" href="/assets/heroku.html.200ca6ee.js"><link rel="prefetch" href="/assets/supabase.html.aca1ac1d.js"><link rel="prefetch" href="/assets/vps.html.40de5172.js"><link rel="prefetch" href="/assets/index.html.567ecd8c.js"><link rel="prefetch" href="/assets/auto-retry.html.be745936.js"><link rel="prefetch" href="/assets/autoquote.html.5c46e2d3.js"><link rel="prefetch" href="/assets/command-filter.html.fa1f4413.js"><link rel="prefetch" href="/assets/console-time.html.0d2bc762.js"><link rel="prefetch" href="/assets/conversations.html.778561d7.js"><link rel="prefetch" href="/assets/emoji.html.601be2b6.js"><link rel="prefetch" href="/assets/files.html.13f0053f.js"><link rel="prefetch" href="/assets/fluent.html.47d160d5.js"><link rel="prefetch" href="/assets/guide.html.381a5a51.js"><link rel="prefetch" href="/assets/hydrate.html.426ed716.js"><link rel="prefetch" href="/assets/i18n.html.afb30866.js"><link rel="prefetch" href="/assets/keyboard.html.19037e93.js"><link rel="prefetch" href="/assets/menu.html.e70d11ec.js"><link rel="prefetch" href="/assets/middlewares.html.5bc684e5.js"><link rel="prefetch" href="/assets/parse-mode.html.0e2027aa.js"><link rel="prefetch" href="/assets/ratelimiter.html.f1aaea8c.js"><link rel="prefetch" href="/assets/router.html.1476dda9.js"><link rel="prefetch" href="/assets/runner.html.ce50a49c.js"><link rel="prefetch" href="/assets/session.html.fe8e3213.js"><link rel="prefetch" href="/assets/stateless-question.html.b8a43883.js"><link rel="prefetch" href="/assets/transformer-throttler.html.45a66fc5.js"><link rel="prefetch" href="/assets/about.html.4abcfa07.js"><link rel="prefetch" href="/assets/comparison.html.8ed17bd9.js"><link rel="prefetch" href="/assets/faq.html.0dd6c2c4.js"><link rel="prefetch" href="/assets/index.html.45898178.js"><link rel="prefetch" href="/assets/deployment.html.75afc00d.js"><link rel="prefetch" href="/assets/flood.html.71e88b3b.js"><link rel="prefetch" href="/assets/middleware.html.afa5db3b.js"><link rel="prefetch" href="/assets/proxy.html.b70254e4.js"><link rel="prefetch" href="/assets/reliability.html.2858f460.js"><link rel="prefetch" href="/assets/scaling.html.ae951df2.js"><link rel="prefetch" href="/assets/structuring.html.d2ff17dd.js"><link rel="prefetch" href="/assets/transformers.html.6f5b57b6.js"><link rel="prefetch" href="/assets/index.html.74522b16.js"><link rel="prefetch" href="/assets/examples.html.24e682eb.js"><link rel="prefetch" href="/assets/index.html.9de295a7.js"><link rel="prefetch" href="/assets/api.html.8ed7866f.js"><link rel="prefetch" href="/assets/basics.html.7afbeb28.js"><link rel="prefetch" href="/assets/commands.html.131d044b.js"><link rel="prefetch" href="/assets/context.html.f1f04579.js"><link rel="prefetch" href="/assets/deployment-types.html.6efb3c25.js"><link rel="prefetch" href="/assets/errors.html.0c95dbb6.js"><link rel="prefetch" href="/assets/files.html.c53a8155.js"><link rel="prefetch" href="/assets/games.html.60a32e8c.js"><link rel="prefetch" href="/assets/getting-started.html.7d3308dc.js"><link rel="prefetch" href="/assets/inline-queries.html.c644e6f2.js"><link rel="prefetch" href="/assets/introduction.html.2b2e7021.js"><link rel="prefetch" href="/assets/middleware.html.8e8a095a.js"><link rel="prefetch" href="/assets/comparison.html.65d3d0d9.js"><link rel="prefetch" href="/assets/deno-deploy.html.b3d0c42c.js"><link rel="prefetch" href="/assets/gcf.html.8a35f9f5.js"><link rel="prefetch" href="/assets/heroku.html.8ba42f90.js"><link rel="prefetch" href="/assets/supabase.html.ee2b455f.js"><link rel="prefetch" href="/assets/vps.html.6fe75bcb.js"><link rel="prefetch" href="/assets/index.html.f9a366b7.js"><link rel="prefetch" href="/assets/auto-retry.html.e870a1fc.js"><link rel="prefetch" href="/assets/autoquote.html.afc82797.js"><link rel="prefetch" href="/assets/command-filter.html.d5692cab.js"><link rel="prefetch" href="/assets/console-time.html.a509e6b6.js"><link rel="prefetch" href="/assets/conversations.html.c2a1214f.js"><link rel="prefetch" href="/assets/emoji.html.346d49b0.js"><link rel="prefetch" href="/assets/files.html.97985794.js"><link rel="prefetch" href="/assets/fluent.html.497a7165.js"><link rel="prefetch" href="/assets/guide.html.6086fd79.js"><link rel="prefetch" href="/assets/hydrate.html.f3bc28bb.js"><link rel="prefetch" href="/assets/i18n.html.42762cf9.js"><link rel="prefetch" href="/assets/keyboard.html.9ccac385.js"><link rel="prefetch" href="/assets/menu.html.05b22f9d.js"><link rel="prefetch" href="/assets/middlewares.html.b0d76949.js"><link rel="prefetch" href="/assets/parse-mode.html.377b539d.js"><link rel="prefetch" href="/assets/ratelimiter.html.f7e73ee7.js"><link rel="prefetch" href="/assets/router.html.401950f2.js"><link rel="prefetch" href="/assets/runner.html.da15a490.js"><link rel="prefetch" href="/assets/session.html.79028198.js"><link rel="prefetch" href="/assets/stateless-question.html.e542bb65.js"><link rel="prefetch" href="/assets/transformer-throttler.html.7d448db6.js"><link rel="prefetch" href="/assets/about.html.41287b90.js"><link rel="prefetch" href="/assets/comparison.html.162bdf02.js"><link rel="prefetch" href="/assets/faq.html.abba6af1.js"><link rel="prefetch" href="/assets/404.html.d2dc3323.js"><link rel="prefetch" href="/assets/index.html.1c4897cb.js"><link rel="prefetch" href="/assets/index.html.fab842be.js"><link rel="prefetch" href="/assets/deployment.html.2d12c72d.js"><link rel="prefetch" href="/assets/flood.html.4c566ad6.js"><link rel="prefetch" href="/assets/middleware.html.3c169a9b.js"><link rel="prefetch" href="/assets/proxy.html.86c8a347.js"><link rel="prefetch" href="/assets/reliability.html.de93c5c4.js"><link rel="prefetch" href="/assets/scaling.html.38766e34.js"><link rel="prefetch" href="/assets/structuring.html.298e5159.js"><link rel="prefetch" href="/assets/transformers.html.459b59a8.js"><link rel="prefetch" href="/assets/index.html.7ab4aeb8.js"><link rel="prefetch" href="/assets/examples.html.e177b696.js"><link rel="prefetch" href="/assets/index.html.1b86b7ab.js"><link rel="prefetch" href="/assets/index.html.27a97d59.js"><link rel="prefetch" href="/assets/api.html.818d4b27.js"><link rel="prefetch" href="/assets/basics.html.8fbee6af.js"><link rel="prefetch" href="/assets/commands.html.34c4b445.js"><link rel="prefetch" href="/assets/context.html.c95cab40.js"><link rel="prefetch" href="/assets/deployment-types.html.0753e120.js"><link rel="prefetch" href="/assets/errors.html.61b179ab.js"><link rel="prefetch" href="/assets/files.html.f0668945.js"><link rel="prefetch" href="/assets/filter-queries.html.04d48bf8.js"><link rel="prefetch" href="/assets/games.html.cd692caf.js"><link rel="prefetch" href="/assets/getting-started.html.b343f1ad.js"><link rel="prefetch" href="/assets/inline-queries.html.0cef76b9.js"><link rel="prefetch" href="/assets/introduction.html.580d3cec.js"><link rel="prefetch" href="/assets/middleware.html.5a88b951.js"><link rel="prefetch" href="/assets/comparison.html.a4599628.js"><link rel="prefetch" href="/assets/deno-deploy.html.3bf24005.js"><link rel="prefetch" href="/assets/gcf.html.cb67212f.js"><link rel="prefetch" href="/assets/heroku.html.006de730.js"><link rel="prefetch" href="/assets/supabase.html.20f6ce0b.js"><link rel="prefetch" href="/assets/vps.html.3f6b6358.js"><link rel="prefetch" href="/assets/index.html.3dbe0499.js"><link rel="prefetch" href="/assets/index.html.38c0498b.js"><link rel="prefetch" href="/assets/auto-retry.html.8935c4bd.js"><link rel="prefetch" href="/assets/autoquote.html.7d18421c.js"><link rel="prefetch" href="/assets/command-filter.html.41399595.js"><link rel="prefetch" href="/assets/console-time.html.bdcb76fa.js"><link rel="prefetch" href="/assets/conversations.html.30e475ea.js"><link rel="prefetch" href="/assets/emoji.html.0441dc31.js"><link rel="prefetch" href="/assets/files.html.8497b8e8.js"><link rel="prefetch" href="/assets/fluent.html.f255b3f2.js"><link rel="prefetch" href="/assets/guide.html.a191a55b.js"><link rel="prefetch" href="/assets/hydrate.html.f4be7961.js"><link rel="prefetch" href="/assets/i18n.html.06d7a64d.js"><link rel="prefetch" href="/assets/keyboard.html.8839562b.js"><link rel="prefetch" href="/assets/menu.html.13205fde.js"><link rel="prefetch" href="/assets/middlewares.html.b91f741b.js"><link rel="prefetch" href="/assets/parse-mode.html.d6b680f1.js"><link rel="prefetch" href="/assets/ratelimiter.html.b1d0313f.js"><link rel="prefetch" href="/assets/router.html.6431683f.js"><link rel="prefetch" href="/assets/runner.html.6afe64ed.js"><link rel="prefetch" href="/assets/session.html.52fddacf.js"><link rel="prefetch" href="/assets/stateless-question.html.749484d7.js"><link rel="prefetch" href="/assets/transformer-throttler.html.2a964be5.js"><link rel="prefetch" href="/assets/about.html.6ed10858.js"><link rel="prefetch" href="/assets/comparison.html.9ac21ae9.js"><link rel="prefetch" href="/assets/faq.html.13c39620.js"><link rel="prefetch" href="/assets/index.html.05578d8d.js"><link rel="prefetch" href="/assets/index.html.87d4a8f7.js"><link rel="prefetch" href="/assets/deployment.html.af33805d.js"><link rel="prefetch" href="/assets/flood.html.33593415.js"><link rel="prefetch" href="/assets/middleware.html.4ace3339.js"><link rel="prefetch" href="/assets/proxy.html.a5872303.js"><link rel="prefetch" href="/assets/reliability.html.2c57405c.js"><link rel="prefetch" href="/assets/scaling.html.20302e91.js"><link rel="prefetch" href="/assets/structuring.html.d001ced5.js"><link rel="prefetch" href="/assets/transformers.html.94af9873.js"><link rel="prefetch" href="/assets/index.html.b4b4baf5.js"><link rel="prefetch" href="/assets/examples.html.b80db678.js"><link rel="prefetch" href="/assets/index.html.8e3cd89d.js"><link rel="prefetch" href="/assets/api.html.016aa5df.js"><link rel="prefetch" href="/assets/basics.html.7fdff7c7.js"><link rel="prefetch" href="/assets/commands.html.ac62cab6.js"><link rel="prefetch" href="/assets/context.html.80077a68.js"><link rel="prefetch" href="/assets/deployment-types.html.65e33c66.js"><link rel="prefetch" href="/assets/errors.html.93765c4b.js"><link rel="prefetch" href="/assets/files.html.ec378a93.js"><link rel="prefetch" href="/assets/filter-queries.html.64c223fe.js"><link rel="prefetch" href="/assets/games.html.7e5aecc7.js"><link rel="prefetch" href="/assets/getting-started.html.5ace4cfb.js"><link rel="prefetch" href="/assets/inline-queries.html.b32e49df.js"><link rel="prefetch" href="/assets/introduction.html.63b36243.js"><link rel="prefetch" href="/assets/middleware.html.00d5623b.js"><link rel="prefetch" href="/assets/comparison.html.718ee58e.js"><link rel="prefetch" href="/assets/deno-deploy.html.82a12d88.js"><link rel="prefetch" href="/assets/gcf.html.613fd014.js"><link rel="prefetch" href="/assets/heroku.html.4a62f147.js"><link rel="prefetch" href="/assets/supabase.html.817370dd.js"><link rel="prefetch" href="/assets/vps.html.a67b5cca.js"><link rel="prefetch" href="/assets/index.html.cca2c7b3.js"><link rel="prefetch" href="/assets/auto-retry.html.d10bb394.js"><link rel="prefetch" href="/assets/autoquote.html.2c5aefe5.js"><link rel="prefetch" href="/assets/command-filter.html.75c129da.js"><link rel="prefetch" href="/assets/console-time.html.772dab31.js"><link rel="prefetch" href="/assets/conversations.html.0a307e9b.js"><link rel="prefetch" href="/assets/emoji.html.ac5600f6.js"><link rel="prefetch" href="/assets/files.html.8adb2bbe.js"><link rel="prefetch" href="/assets/fluent.html.8b85b21e.js"><link rel="prefetch" href="/assets/guide.html.887051d1.js"><link rel="prefetch" href="/assets/hydrate.html.78b2c50e.js"><link rel="prefetch" href="/assets/i18n.html.9494c3a2.js"><link rel="prefetch" href="/assets/keyboard.html.8b346bae.js"><link rel="prefetch" href="/assets/menu.html.f032241a.js"><link rel="prefetch" href="/assets/middlewares.html.470c174c.js"><link rel="prefetch" href="/assets/parse-mode.html.ba716486.js"><link rel="prefetch" href="/assets/ratelimiter.html.98481e36.js"><link rel="prefetch" href="/assets/router.html.40702a35.js"><link rel="prefetch" href="/assets/runner.html.ee7d9d7a.js"><link rel="prefetch" href="/assets/session.html.c8ab3005.js"><link rel="prefetch" href="/assets/stateless-question.html.245226e2.js"><link rel="prefetch" href="/assets/transformer-throttler.html.af53e2d0.js"><link rel="prefetch" href="/assets/about.html.7b65581f.js"><link rel="prefetch" href="/assets/comparison.html.ea016124.js"><link rel="prefetch" href="/assets/faq.html.3afcba67.js"><link rel="prefetch" href="/assets/index.html.eef9fbe6.js"><link rel="prefetch" href="/assets/deployment.html.cdf69b84.js"><link rel="prefetch" href="/assets/flood.html.4f1865e0.js"><link rel="prefetch" href="/assets/middleware.html.d9d26e75.js"><link rel="prefetch" href="/assets/proxy.html.5255f337.js"><link rel="prefetch" href="/assets/reliability.html.dbb6bad3.js"><link rel="prefetch" href="/assets/scaling.html.0af6ccaa.js"><link rel="prefetch" href="/assets/structuring.html.9bf495d0.js"><link rel="prefetch" href="/assets/transformers.html.33036e37.js"><link rel="prefetch" href="/assets/index.html.6448debf.js"><link rel="prefetch" href="/assets/examples.html.ee77f0d5.js"><link rel="prefetch" href="/assets/index.html.d9a46521.js"><link rel="prefetch" href="/assets/api.html.b776a81a.js"><link rel="prefetch" href="/assets/basics.html.cf94d5ce.js"><link rel="prefetch" href="/assets/commands.html.6b0b3a2a.js"><link rel="prefetch" href="/assets/context.html.e1e3fee3.js"><link rel="prefetch" href="/assets/deployment-types.html.a852345f.js"><link rel="prefetch" href="/assets/errors.html.8242fd24.js"><link rel="prefetch" href="/assets/files.html.7e742d21.js"><link rel="prefetch" href="/assets/filter-queries.html.7aa8b84d.js"><link rel="prefetch" href="/assets/games.html.56ba0ae8.js"><link rel="prefetch" href="/assets/getting-started.html.80060686.js"><link rel="prefetch" href="/assets/inline-queries.html.eca13ad8.js"><link rel="prefetch" href="/assets/introduction.html.cafcaea7.js"><link rel="prefetch" href="/assets/middleware.html.c25f395d.js"><link rel="prefetch" href="/assets/comparison.html.6746e662.js"><link rel="prefetch" href="/assets/deno-deploy.html.8635c631.js"><link rel="prefetch" href="/assets/gcf.html.fbbc8c66.js"><link rel="prefetch" href="/assets/heroku.html.f7d33256.js"><link rel="prefetch" href="/assets/supabase.html.0b7f85a7.js"><link rel="prefetch" href="/assets/vps.html.3ccb23c7.js"><link rel="prefetch" href="/assets/index.html.ec836f1a.js"><link rel="prefetch" href="/assets/auto-retry.html.4f0a7780.js"><link rel="prefetch" href="/assets/autoquote.html.2e990b55.js"><link rel="prefetch" href="/assets/command-filter.html.d9267659.js"><link rel="prefetch" href="/assets/console-time.html.3e4c3c69.js"><link rel="prefetch" href="/assets/conversations.html.2a998a2d.js"><link rel="prefetch" href="/assets/emoji.html.bb9f617f.js"><link rel="prefetch" href="/assets/files.html.baa5ac7f.js"><link rel="prefetch" href="/assets/fluent.html.31382f60.js"><link rel="prefetch" href="/assets/guide.html.49abbd63.js"><link rel="prefetch" href="/assets/hydrate.html.24ba8b8a.js"><link rel="prefetch" href="/assets/i18n.html.e626c16e.js"><link rel="prefetch" href="/assets/keyboard.html.a41d72df.js"><link rel="prefetch" href="/assets/menu.html.7c43427e.js"><link rel="prefetch" href="/assets/middlewares.html.791dae8e.js"><link rel="prefetch" href="/assets/parse-mode.html.4cf91041.js"><link rel="prefetch" href="/assets/ratelimiter.html.c4e98bda.js"><link rel="prefetch" href="/assets/router.html.fe091e82.js"><link rel="prefetch" href="/assets/runner.html.9e0979bf.js"><link rel="prefetch" href="/assets/session.html.9b302e77.js"><link rel="prefetch" href="/assets/stateless-question.html.ff4603c6.js"><link rel="prefetch" href="/assets/transformer-throttler.html.557d5f05.js"><link rel="prefetch" href="/assets/about.html.76710bd9.js"><link rel="prefetch" href="/assets/comparison.html.2ac5c9ef.js"><link rel="prefetch" href="/assets/faq.html.b4f81d0b.js"><link rel="prefetch" href="/assets/index.html.3d591f00.js"><link rel="prefetch" href="/assets/deployment.html.7867e6c9.js"><link rel="prefetch" href="/assets/flood.html.2ea2f691.js"><link rel="prefetch" href="/assets/middleware.html.65081599.js"><link rel="prefetch" href="/assets/proxy.html.b7669bfc.js"><link rel="prefetch" href="/assets/reliability.html.dc3b7f0b.js"><link rel="prefetch" href="/assets/scaling.html.5494cb4e.js"><link rel="prefetch" href="/assets/structuring.html.93f34d3b.js"><link rel="prefetch" href="/assets/transformers.html.e41ecbed.js"><link rel="prefetch" href="/assets/index.html.c18f01b3.js"><link rel="prefetch" href="/assets/examples.html.f943c601.js"><link rel="prefetch" href="/assets/index.html.cda796c0.js"><link rel="prefetch" href="/assets/api.html.27e83c72.js"><link rel="prefetch" href="/assets/basics.html.529df59d.js"><link rel="prefetch" href="/assets/commands.html.fa3fdccb.js"><link rel="prefetch" href="/assets/context.html.6ec976ab.js"><link rel="prefetch" href="/assets/deployment-types.html.40c57bd8.js"><link rel="prefetch" href="/assets/errors.html.e7ae41af.js"><link rel="prefetch" href="/assets/files.html.91294931.js"><link rel="prefetch" href="/assets/games.html.7c820635.js"><link rel="prefetch" href="/assets/getting-started.html.945a075c.js"><link rel="prefetch" href="/assets/inline-queries.html.650b3533.js"><link rel="prefetch" href="/assets/introduction.html.1941576d.js"><link rel="prefetch" href="/assets/middleware.html.92c13cb7.js"><link rel="prefetch" href="/assets/comparison.html.6ba6b00d.js"><link rel="prefetch" href="/assets/deno-deploy.html.01548194.js"><link rel="prefetch" href="/assets/gcf.html.e4977ca9.js"><link rel="prefetch" href="/assets/heroku.html.0e4a5968.js"><link rel="prefetch" href="/assets/supabase.html.c4c62fc7.js"><link rel="prefetch" href="/assets/vps.html.5ae15a95.js"><link rel="prefetch" href="/assets/index.html.ba0787fa.js"><link rel="prefetch" href="/assets/auto-retry.html.43df2e8b.js"><link rel="prefetch" href="/assets/autoquote.html.cf1e0f37.js"><link rel="prefetch" href="/assets/command-filter.html.2974e416.js"><link rel="prefetch" href="/assets/console-time.html.43a1489a.js"><link rel="prefetch" href="/assets/conversations.html.18b6ae28.js"><link rel="prefetch" href="/assets/emoji.html.9ab88423.js"><link rel="prefetch" href="/assets/files.html.235ab172.js"><link rel="prefetch" href="/assets/fluent.html.bb980530.js"><link rel="prefetch" href="/assets/guide.html.2846d612.js"><link rel="prefetch" href="/assets/hydrate.html.ebb496c8.js"><link rel="prefetch" href="/assets/i18n.html.a92d3708.js"><link rel="prefetch" href="/assets/keyboard.html.fef8d845.js"><link rel="prefetch" href="/assets/menu.html.11effab9.js"><link rel="prefetch" href="/assets/middlewares.html.b24b568a.js"><link rel="prefetch" href="/assets/parse-mode.html.97b56576.js"><link rel="prefetch" href="/assets/ratelimiter.html.b651cf2f.js"><link rel="prefetch" href="/assets/router.html.c4fe017c.js"><link rel="prefetch" href="/assets/runner.html.6a9f0e60.js"><link rel="prefetch" href="/assets/session.html.5f1804f0.js"><link rel="prefetch" href="/assets/stateless-question.html.332a15b4.js"><link rel="prefetch" href="/assets/transformer-throttler.html.4a1d85c5.js"><link rel="prefetch" href="/assets/about.html.a004299d.js"><link rel="prefetch" href="/assets/comparison.html.0a4b9344.js"><link rel="prefetch" href="/assets/faq.html.23034a7d.js"><link rel="prefetch" href="/assets/404.html.31b21725.js">
    <link rel="stylesheet" href="/assets/style.177b0b6b.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/zh/" class=""><img class="logo" src="/Y.png" alt="grammY"><span class="site-name can-hide">grammY</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/zh/guide/" class="router-link-active" aria-label="基础"><!--[--><!--]--><span>基础 <!--v-if--></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="了解"><span class="title">了解</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="了解"><span class="title">了解</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>基础 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/guide/" class="" aria-label="概述"><!--[--><!--]--><span>概述 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/introduction.html" class="" aria-label="简介"><!--[--><!--]--><span>简介 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/getting-started.html" class="" aria-label="入门"><!--[--><!--]--><span>入门 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/basics.html" class="" aria-label="发送和接收消息"><!--[--><!--]--><span>发送和接收消息 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/context.html" class="" aria-label="上下文"><!--[--><!--]--><span>上下文 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/api.html" class="" aria-label="Bot API"><!--[--><!--]--><span>Bot API <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a aria-current="page" href="/zh/guide/filter-queries.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Filter 查询与 bot.on()"><!--[--><!--]--><span>Filter 查询与 bot.on() <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/commands.html" class="" aria-label="Commands"><!--[--><!--]--><span>Commands <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/middleware.html" class="" aria-label="中间件"><!--[--><!--]--><span>中间件 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/errors.html" class="" aria-label="错误处理"><!--[--><!--]--><span>错误处理 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/inline-queries.html" class="" aria-label="Inline Queries"><!--[--><!--]--><span>Inline Queries <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/files.html" class="" aria-label="文件管理"><!--[--><!--]--><span>文件管理 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/games.html" class="" aria-label="游戏"><!--[--><!--]--><span>游戏 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/deployment-types.html" class="" aria-label="长轮询 vs. Webhooks"><!--[--><!--]--><span>长轮询 vs. Webhooks <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>进阶 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/advanced/" class="" aria-label="概述"><!--[--><!--]--><span>概述 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/middleware.html" class="" aria-label="重构中间件"><!--[--><!--]--><span>重构中间件 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/structuring.html" class="" aria-label="I: 代码组织"><!--[--><!--]--><span>I: 代码组织 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/scaling.html" class="" aria-label="II: 高负载"><!--[--><!--]--><span>II: 高负载 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/reliability.html" class="" aria-label="III: 可靠性"><!--[--><!--]--><span>III: 可靠性 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/flood.html" class="" aria-label="IV: 流量限制"><!--[--><!--]--><span>IV: 流量限制 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/transformers.html" class="" aria-label="Bot API Transformers"><!--[--><!--]--><span>Bot API Transformers <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/proxy.html" class="" aria-label="代理支持"><!--[--><!--]--><span>代理支持 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/deployment.html" class="" aria-label="部署"><!--[--><!--]--><span>部署 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="插件"><span class="title">插件</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="插件"><span class="title">插件</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>简介 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/plugins/" class="" aria-label="关于插件"><!--[--><!--]--><span>关于插件 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/guide.html" class="" aria-label="如何编写一个插件"><!--[--><!--]--><span>如何编写一个插件 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>内置插件 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/plugins/session.html" class="" aria-label="会话与数据储存"><!--[--><!--]--><span>会话与数据储存 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/keyboard.html" class="" aria-label="Inline 与自定义 Keyboards"><!--[--><!--]--><span>Inline 与自定义 Keyboards <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>官方维护 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/plugins/conversations.html" class="" aria-label="对话 (conversations)"><!--[--><!--]--><span>对话 (conversations) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/menu.html" class="" aria-label="互动菜单 (menu)"><!--[--><!--]--><span>互动菜单 (menu) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/stateless-question.html" class="" aria-label="无状态问题 (stateless-question)"><!--[--><!--]--><span>无状态问题 (stateless-question) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/runner.html" class="" aria-label="并发 (runner)"><!--[--><!--]--><span>并发 (runner) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/hydrate.html" class="" aria-label="Hydration (hydrate)"><!--[--><!--]--><span>Hydration (hydrate) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/auto-retry.html" class="" aria-label="重试 API 请求 (auto-retry)"><!--[--><!--]--><span>重试 API 请求 (auto-retry) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/transformer-throttler.html" class="" aria-label="流量控制 (transformer-throttler)"><!--[--><!--]--><span>流量控制 (transformer-throttler) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/ratelimiter.html" class="" aria-label="限制用户速率 (ratelimiter)"><!--[--><!--]--><span>限制用户速率 (ratelimiter) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/files.html" class="" aria-label="文件助手 (files)"><!--[--><!--]--><span>文件助手 (files) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/i18n.html" class="" aria-label="国际化 (i18n)"><!--[--><!--]--><span>国际化 (i18n) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/fluent.html" class="" aria-label="国际化 (fluent)"><!--[--><!--]--><span>国际化 (fluent) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/router.html" class="" aria-label="路由器 (router)"><!--[--><!--]--><span>路由器 (router) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/emoji.html" class="" aria-label="Emoji (emoji)"><!--[--><!--]--><span>Emoji (emoji) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/parse-mode.html" class="" aria-label="解析模式 (parse-mode)"><!--[--><!--]--><span>解析模式 (parse-mode) <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>第三方 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/plugins/console-time.html" class="" aria-label="调试时输出日志"><!--[--><!--]--><span>调试时输出日志 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/middlewares.html" class="" aria-label="有用的中间件"><!--[--><!--]--><span>有用的中间件 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/autoquote.html" class="" aria-label="自动引用"><!--[--><!--]--><span>自动引用 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/#创建你自己的插件" class="" aria-label="[等待你的 PR!]"><!--[--><!--]--><span>[等待你的 PR!] <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="示例"><span class="title">示例</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="示例"><span class="title">示例</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>示例 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/grammyjs/awesome-grammY" rel="noopener noreferrer" target="_blank" aria-label="Awesome grammY"><!--[--><!--]--><span>Awesome grammY <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/grammyjs/examples" rel="noopener noreferrer" target="_blank" aria-label="示例 Bots 仓库"><!--[--><!--]--><span>示例 Bots 仓库 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="资源"><span class="title">资源</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="资源"><span class="title">资源</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>grammY <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/resources/about.html" class="" aria-label="关于 grammY"><!--[--><!--]--><span>关于 grammY <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs" rel="noopener noreferrer" target="_blank" aria-label="社区聊天（英语）"><!--[--><!--]--><span>社区聊天（英语） <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs_ru" rel="noopener noreferrer" target="_blank" aria-label="社区聊天（俄语）"><!--[--><!--]--><span>社区聊天（俄语） <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs_news" rel="noopener noreferrer" target="_blank" aria-label="咨询"><!--[--><!--]--><span>咨询 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://twitter.com/grammy_js" rel="noopener noreferrer" target="_blank" aria-label="Twitter"><!--[--><!--]--><span>Twitter <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/resources/faq.html" class="" aria-label="FAQ"><!--[--><!--]--><span>FAQ <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/resources/comparison.html" class="" aria-label="与其他框架的比较"><!--[--><!--]--><span>与其他框架的比较 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Telegram <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots" rel="noopener noreferrer" target="_blank" aria-label="面向开发者的介绍"><!--[--><!--]--><span>面向开发者的介绍 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/faq" rel="noopener noreferrer" target="_blank" aria-label="Bots FAQ"><!--[--><!--]--><span>Bots FAQ <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/api" rel="noopener noreferrer" target="_blank" aria-label="Bot API 概览"><!--[--><!--]--><span>Bot API 概览 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/webhooks#testing-your-bot-with-updates" rel="noopener noreferrer" target="_blank" aria-label="Updates 示例"><!--[--><!--]--><span>Updates 示例 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="托管服务"><span class="title">托管服务</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="托管服务"><span class="title">托管服务</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>总览 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/hosting/comparison.html" class="" aria-label="对比"><!--[--><!--]--><span>对比 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>教程 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/hosting/deno-deploy.html" class="" aria-label="Deno Deploy"><!--[--><!--]--><span>Deno Deploy <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/hosting/supabase.html" class="" aria-label="Supabase Edge Functions"><!--[--><!--]--><span>Supabase Edge Functions <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/hosting/heroku.html" class="" aria-label="Heroku"><!--[--><!--]--><span>Heroku <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/hosting/gcf.html" class="" aria-label="Google Cloud Functions"><!--[--><!--]--><span>Google Cloud Functions <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/hosting/vps.html" class="" aria-label="Virtual Private Server"><!--[--><!--]--><span>Virtual Private Server <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://doc.deno.land/https://deno.land/x/grammy/mod.ts" rel="noopener noreferrer" target="_blank" aria-label="API 参考"><!--[--><!--]--><span>API 参考 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">语言</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">语言</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><a href="/guide/filter-queries.html" class="" aria-label="English"><!--[--><!--]--><span>English <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/es/guide/filter-queries.html" class="" aria-label="Español"><!--[--><!--]--><span>Español <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/id/guide/filter-queries.html" class="" aria-label="Indonesia"><!--[--><!--]--><span>Indonesia <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/zh/guide/filter-queries.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--><span>简体中文 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/grammyjs/grammY" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--><span>GitHub <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/zh/guide/" class="router-link-active" aria-label="基础"><!--[--><!--]--><span>基础 <!--v-if--></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="了解"><span class="title">了解</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="了解"><span class="title">了解</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>基础 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/guide/" class="" aria-label="概述"><!--[--><!--]--><span>概述 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/introduction.html" class="" aria-label="简介"><!--[--><!--]--><span>简介 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/getting-started.html" class="" aria-label="入门"><!--[--><!--]--><span>入门 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/basics.html" class="" aria-label="发送和接收消息"><!--[--><!--]--><span>发送和接收消息 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/context.html" class="" aria-label="上下文"><!--[--><!--]--><span>上下文 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/api.html" class="" aria-label="Bot API"><!--[--><!--]--><span>Bot API <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a aria-current="page" href="/zh/guide/filter-queries.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Filter 查询与 bot.on()"><!--[--><!--]--><span>Filter 查询与 bot.on() <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/commands.html" class="" aria-label="Commands"><!--[--><!--]--><span>Commands <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/middleware.html" class="" aria-label="中间件"><!--[--><!--]--><span>中间件 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/errors.html" class="" aria-label="错误处理"><!--[--><!--]--><span>错误处理 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/inline-queries.html" class="" aria-label="Inline Queries"><!--[--><!--]--><span>Inline Queries <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/files.html" class="" aria-label="文件管理"><!--[--><!--]--><span>文件管理 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/games.html" class="" aria-label="游戏"><!--[--><!--]--><span>游戏 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/guide/deployment-types.html" class="" aria-label="长轮询 vs. Webhooks"><!--[--><!--]--><span>长轮询 vs. Webhooks <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>进阶 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/advanced/" class="" aria-label="概述"><!--[--><!--]--><span>概述 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/middleware.html" class="" aria-label="重构中间件"><!--[--><!--]--><span>重构中间件 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/structuring.html" class="" aria-label="I: 代码组织"><!--[--><!--]--><span>I: 代码组织 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/scaling.html" class="" aria-label="II: 高负载"><!--[--><!--]--><span>II: 高负载 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/reliability.html" class="" aria-label="III: 可靠性"><!--[--><!--]--><span>III: 可靠性 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/flood.html" class="" aria-label="IV: 流量限制"><!--[--><!--]--><span>IV: 流量限制 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/transformers.html" class="" aria-label="Bot API Transformers"><!--[--><!--]--><span>Bot API Transformers <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/proxy.html" class="" aria-label="代理支持"><!--[--><!--]--><span>代理支持 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/advanced/deployment.html" class="" aria-label="部署"><!--[--><!--]--><span>部署 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="插件"><span class="title">插件</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="插件"><span class="title">插件</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>简介 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/plugins/" class="" aria-label="关于插件"><!--[--><!--]--><span>关于插件 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/guide.html" class="" aria-label="如何编写一个插件"><!--[--><!--]--><span>如何编写一个插件 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>内置插件 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/plugins/session.html" class="" aria-label="会话与数据储存"><!--[--><!--]--><span>会话与数据储存 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/keyboard.html" class="" aria-label="Inline 与自定义 Keyboards"><!--[--><!--]--><span>Inline 与自定义 Keyboards <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>官方维护 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/plugins/conversations.html" class="" aria-label="对话 (conversations)"><!--[--><!--]--><span>对话 (conversations) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/menu.html" class="" aria-label="互动菜单 (menu)"><!--[--><!--]--><span>互动菜单 (menu) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/stateless-question.html" class="" aria-label="无状态问题 (stateless-question)"><!--[--><!--]--><span>无状态问题 (stateless-question) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/runner.html" class="" aria-label="并发 (runner)"><!--[--><!--]--><span>并发 (runner) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/hydrate.html" class="" aria-label="Hydration (hydrate)"><!--[--><!--]--><span>Hydration (hydrate) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/auto-retry.html" class="" aria-label="重试 API 请求 (auto-retry)"><!--[--><!--]--><span>重试 API 请求 (auto-retry) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/transformer-throttler.html" class="" aria-label="流量控制 (transformer-throttler)"><!--[--><!--]--><span>流量控制 (transformer-throttler) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/ratelimiter.html" class="" aria-label="限制用户速率 (ratelimiter)"><!--[--><!--]--><span>限制用户速率 (ratelimiter) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/files.html" class="" aria-label="文件助手 (files)"><!--[--><!--]--><span>文件助手 (files) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/i18n.html" class="" aria-label="国际化 (i18n)"><!--[--><!--]--><span>国际化 (i18n) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/fluent.html" class="" aria-label="国际化 (fluent)"><!--[--><!--]--><span>国际化 (fluent) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/router.html" class="" aria-label="路由器 (router)"><!--[--><!--]--><span>路由器 (router) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/emoji.html" class="" aria-label="Emoji (emoji)"><!--[--><!--]--><span>Emoji (emoji) <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/parse-mode.html" class="" aria-label="解析模式 (parse-mode)"><!--[--><!--]--><span>解析模式 (parse-mode) <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>第三方 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/plugins/console-time.html" class="" aria-label="调试时输出日志"><!--[--><!--]--><span>调试时输出日志 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/middlewares.html" class="" aria-label="有用的中间件"><!--[--><!--]--><span>有用的中间件 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/autoquote.html" class="" aria-label="自动引用"><!--[--><!--]--><span>自动引用 <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/plugins/#创建你自己的插件" class="" aria-label="[等待你的 PR!]"><!--[--><!--]--><span>[等待你的 PR!] <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="示例"><span class="title">示例</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="示例"><span class="title">示例</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>示例 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/grammyjs/awesome-grammY" rel="noopener noreferrer" target="_blank" aria-label="Awesome grammY"><!--[--><!--]--><span>Awesome grammY <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/grammyjs/examples" rel="noopener noreferrer" target="_blank" aria-label="示例 Bots 仓库"><!--[--><!--]--><span>示例 Bots 仓库 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="资源"><span class="title">资源</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="资源"><span class="title">资源</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>grammY <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/resources/about.html" class="" aria-label="关于 grammY"><!--[--><!--]--><span>关于 grammY <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs" rel="noopener noreferrer" target="_blank" aria-label="社区聊天（英语）"><!--[--><!--]--><span>社区聊天（英语） <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs_ru" rel="noopener noreferrer" target="_blank" aria-label="社区聊天（俄语）"><!--[--><!--]--><span>社区聊天（俄语） <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://t.me/grammyjs_news" rel="noopener noreferrer" target="_blank" aria-label="咨询"><!--[--><!--]--><span>咨询 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://twitter.com/grammy_js" rel="noopener noreferrer" target="_blank" aria-label="Twitter"><!--[--><!--]--><span>Twitter <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/resources/faq.html" class="" aria-label="FAQ"><!--[--><!--]--><span>FAQ <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/resources/comparison.html" class="" aria-label="与其他框架的比较"><!--[--><!--]--><span>与其他框架的比较 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Telegram <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots" rel="noopener noreferrer" target="_blank" aria-label="面向开发者的介绍"><!--[--><!--]--><span>面向开发者的介绍 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/faq" rel="noopener noreferrer" target="_blank" aria-label="Bots FAQ"><!--[--><!--]--><span>Bots FAQ <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/api" rel="noopener noreferrer" target="_blank" aria-label="Bot API 概览"><!--[--><!--]--><span>Bot API 概览 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://core.telegram.org/bots/webhooks#testing-your-bot-with-updates" rel="noopener noreferrer" target="_blank" aria-label="Updates 示例"><!--[--><!--]--><span>Updates 示例 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="托管服务"><span class="title">托管服务</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="托管服务"><span class="title">托管服务</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>总览 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/hosting/comparison.html" class="" aria-label="对比"><!--[--><!--]--><span>对比 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>教程 <!----></span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/hosting/deno-deploy.html" class="" aria-label="Deno Deploy"><!--[--><!--]--><span>Deno Deploy <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/hosting/supabase.html" class="" aria-label="Supabase Edge Functions"><!--[--><!--]--><span>Supabase Edge Functions <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/hosting/heroku.html" class="" aria-label="Heroku"><!--[--><!--]--><span>Heroku <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/hosting/gcf.html" class="" aria-label="Google Cloud Functions"><!--[--><!--]--><span>Google Cloud Functions <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/hosting/vps.html" class="" aria-label="Virtual Private Server"><!--[--><!--]--><span>Virtual Private Server <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://doc.deno.land/https://deno.land/x/grammy/mod.ts" rel="noopener noreferrer" target="_blank" aria-label="API 参考"><!--[--><!--]--><span>API 参考 <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">语言</span><!----><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">语言</span><!----><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!-- suppress type check error by implementing `as any` --><!--[--><li class="navbar-dropdown-item"><a href="/guide/filter-queries.html" class="" aria-label="English"><!--[--><!--]--><span>English <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/es/guide/filter-queries.html" class="" aria-label="Español"><!--[--><!--]--><span>Español <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/id/guide/filter-queries.html" class="" aria-label="Indonesia"><!--[--><!--]--><span>Indonesia <!--v-if--></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/zh/guide/filter-queries.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--><span>简体中文 <!--v-if--></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/grammyjs/grammY" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--><span>GitHub <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Filter 参数与 bot.on() <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/zh/guide/filter-queries.html#简介" class="router-link-active router-link-exact-active sidebar-item" aria-label="简介"><!--[--><!--]--><span>简介 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#查询示例" class="router-link-active router-link-exact-active sidebar-item" aria-label="查询示例"><!--[--><!--]--><span>查询示例 <!--v-if--></span><!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/zh/guide/filter-queries.html#常规查询" class="router-link-active router-link-exact-active sidebar-item" aria-label="常规查询"><!--[--><!--]--><span>常规查询 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#可用于-entities-的-filter" class="router-link-active router-link-exact-active sidebar-item" aria-label="可用于 Entities 的 Filter"><!--[--><!--]--><span>可用于 Entities 的 Filter <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#缺省值" class="router-link-active router-link-exact-active sidebar-item" aria-label="缺省值"><!--[--><!--]--><span>缺省值 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#快捷方式" class="router-link-active router-link-exact-active sidebar-item" aria-label="快捷方式"><!--[--><!--]--><span>快捷方式 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#语法糖" class="router-link-active router-link-exact-active sidebar-item" aria-label="语法糖"><!--[--><!--]--><span>语法糖 <!--v-if--></span><!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#组合多个查询" class="router-link-active router-link-exact-active sidebar-item" aria-label="组合多个查询"><!--[--><!--]--><span>组合多个查询 <!--v-if--></span><!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/zh/guide/filter-queries.html#使用-or-进行组合" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用 OR 进行组合"><!--[--><!--]--><span>使用 OR 进行组合 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#使用-and-进行组合" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用 AND 进行组合"><!--[--><!--]--><span>使用 AND 进行组合 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#构建复杂的查询" class="router-link-active router-link-exact-active sidebar-item" aria-label="构建复杂的查询"><!--[--><!--]--><span>构建复杂的查询 <!--v-if--></span><!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#实用贴士" class="router-link-active router-link-exact-active sidebar-item" aria-label="实用贴士"><!--[--><!--]--><span>实用贴士 <!--v-if--></span><!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/zh/guide/filter-queries.html#聊天成员更新" class="router-link-active router-link-exact-active sidebar-item" aria-label="聊天成员更新"><!--[--><!--]--><span>聊天成员更新 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#将查询与其他方法相结合" class="router-link-active router-link-exact-active sidebar-item" aria-label="将查询与其他方法相结合"><!--[--><!--]--><span>将查询与其他方法相结合 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#按消息发送者类型过滤" class="router-link-active router-link-exact-active sidebar-item" aria-label="按消息发送者类型过滤"><!--[--><!--]--><span>按消息发送者类型过滤 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#按照用户属性筛选" class="router-link-active router-link-exact-active sidebar-item" aria-label="按照用户属性筛选"><!--[--><!--]--><span>按照用户属性筛选 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#复用过滤查询逻辑" class="router-link-active router-link-exact-active sidebar-item" aria-label="复用过滤查询逻辑"><!--[--><!--]--><span>复用过滤查询逻辑 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#复用过滤查询类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="复用过滤查询类型"><!--[--><!--]--><span>复用过滤查询类型 <!--v-if--></span><!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#查询语言" class="router-link-active router-link-exact-active sidebar-item" aria-label="查询语言"><!--[--><!--]--><span>查询语言 <!--v-if--></span><!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/zh/guide/filter-queries.html#查询结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="查询结构"><!--[--><!--]--><span>查询结构 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#查询前验证" class="router-link-active router-link-exact-active sidebar-item" aria-label="查询前验证"><!--[--><!--]--><span>查询前验证 <!--v-if--></span><!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/guide/filter-queries.html#性能" class="router-link-active router-link-exact-active sidebar-item" aria-label="性能"><!--[--><!--]--><span>性能 <!--v-if--></span><!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="filter-参数与-bot-on" tabindex="-1"><a class="header-anchor" href="#filter-参数与-bot-on" aria-hidden="true">#</a> Filter 参数与 <code>bot<wbr>.on()</code></h1><p><code>bot<wbr>.on()</code> 的第一个参数是一个叫做 <em>filter 参数</em> 的字符串。</p><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h2><p>大多数（所有？）其他机器人框架允许你对更新进行原始形式的筛选，例如，只有 <code>on(&quot;message&quot;)</code> 之类的。 其他消息筛选是留给开发人员的，这往往导致他们的代码中出现无休止的 <code>if</code> 语句。</p><p>相反，<strong>grammY 带有自己的查询语言</strong>，你可以用它来<strong>筛选你想要的消息</strong>。</p><p>这允许使用超过 650 种不同的 filter 进行筛选，而且我们可能会随着时间的推移增加更多的过滤器。 每个有效的 filter 都可以在你的代码编辑器中自动完成。 因此，你可以简单地输入 <code>bot<wbr>.on(&quot;&quot;)</code>，打开自动完成，并通过输入一些东西来搜索所有的查询。</p><p><img src="/filter-query-search.png" alt="Filter 参数查询"></p><p><code>bot<wbr>.on()</code> 的类型推理将理解你挑选的 filter。 因此，它在上下文中浓缩了一些已知存在的类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果收到的消息没有文本，则可能是未定义的。</span>
  <span class="token keyword">const</span> text<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>text<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message:text&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 文本总是被定义的，因为当收到一个文本消息时，这个处理程序被调用。</span>
  <span class="token keyword">const</span> text<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>text<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从某种意义上说，grammY 在运行时和类型层面上都实现了筛选。</p><h2 id="查询示例" tabindex="-1"><a class="header-anchor" href="#查询示例" aria-hidden="true">#</a> 查询示例</h2><p>下面是一些查询的例子：</p><h3 id="常规查询" tabindex="-1"><a class="header-anchor" href="#常规查询" aria-hidden="true">#</a> 常规查询</h3><p>简单的更新 filter，以及 sub-filter 的应用。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 当收到任何消息时被调用</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 只有文本消息才会被调用</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message:photo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 只有图片消息才会被调用</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="可用于-entities-的-filter" tabindex="-1"><a class="header-anchor" href="#可用于-entities-的-filter" aria-hidden="true">#</a> 可用于 Entities 的 Filter</h3><p>Sub-filters 带来了更强的能力与新的可能性。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message:entities:url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 包含一个 URL 的消息</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message:entities:code&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 包含一个代码片断的消息</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;edited_message:entities&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 编辑的消息与任何 entities</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="缺省值" tabindex="-1"><a class="header-anchor" href="#缺省值" aria-hidden="true">#</a> 缺省值</h3><p>你可以在 filter 查询中省略一些参数。 然后，grammY 将通过不同的值来搜索，以匹配你的查询。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 任何文本消息和 channel 中的所有文本 post</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message::url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 消息中带有 URL 的文字或标题（照片等）。</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;::email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 所有消息、channel post 的标题或内容中包括的 email（有时你确实会对某一类消息这样执着）。</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>省去 <em>filter 第一个参数</em> ，可以同时匹配消息和 channel posts 。 <a href="/zh/guide/context.html#%E5%8F%AF%E7%94%A8%E6%93%8D%E4%BD%9C" class="">记住</a>，<code>ctx<wbr>.msg</code> 让你可以访问消息或 channel posts ，它们都是符合匹配规则的，可以放心使用。</p><p>遗漏 <em>第二</em> 个值可以同时匹配 entities 和标题 entities。 你可以同时省略第一和第二部分。</p><h3 id="快捷方式" tabindex="-1"><a class="header-anchor" href="#快捷方式" aria-hidden="true">#</a> 快捷方式</h3><p>grammY 的查询引擎允许定义整齐的快捷方式，将相关的查询组合在一起。</p><h4 id="msg" tabindex="-1"><a class="header-anchor" href="#msg" aria-hidden="true">#</a> <code>msg</code></h4><p><code>msg</code> 快捷键将新消息和频道 posts 归纳其中。 换句话说，使用 <code>msg</code> 相当于同时监听 <code>message</code> 和 <code>channel<wbr>_post</code> 事件。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 任何的消息或者频道 post</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;msg:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 与 `:text` 完全一致</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="edit" tabindex="-1"><a class="header-anchor" href="#edit" aria-hidden="true">#</a> <code>edit</code></h4><p>这个 <code>edit</code> 快捷方式将编辑过的消息和编辑过的频道 posts 归纳其中。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;edit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 任何编辑过的消息和编辑过的频道 post</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;edit:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 已编辑过的文字消息</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;edit::url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在文本或标题中编辑带有 URL 的消息</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;edit:location&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 实时位置更新</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="media" tabindex="-1"><a class="header-anchor" href="#media" aria-hidden="true">#</a> <code>:<wbr>media</code></h4><p><code>:<wbr>media</code> 快捷方式将照片和视频消息归纳其中。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message:media&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 照片和视频消息</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;edited_channel_post:media&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 已编辑的频道 posts 中带有媒体的部分</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;:media&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 媒体消息或者频道 posts</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="file" tabindex="-1"><a class="header-anchor" href="#file" aria-hidden="true">#</a> <code>:<wbr>file</code></h4><p><code>:<wbr>file</code> 快捷方式将所有包含文件的归纳。 因此，<code>await ctx<wbr>.get<wbr>File()</code> 将会会返回给你一个文件对象。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;:file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 消息或频道 posts 包含文件的部分</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;edit:file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在消息或频道 posts 包含文件的部分且已被编辑的部分</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="语法糖" tabindex="-1"><a class="header-anchor" href="#语法糖" aria-hidden="true">#</a> 语法糖</h3><p>查询部分有两种特殊情况，使用户的过滤更方便。 你可以通过 <code>:<wbr>is<wbr>_bot</code> 的查询部分来检测消息来源是否是 bot。 语法糖 <code>:<wbr>me</code> 可以用来在查询中指代你的 bot ，它将在内部为你比对用户标识符来实现这个效果。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 一个 bot 加入了聊天的服务信息</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message:new_chat_members:is_bot&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 你的 bot 被移除的服务信息</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message:left_chat_member:me&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>请注意，虽然这个语法糖对于服务消息很有用，但是它不应该用于检测用户是否真的加入或离开聊天。 服务消息是通知聊天中的用户的消息，其中一些不一定会在所有情况下都可见。 例如，在大型群组中，用户加入或离开聊天的消息不会出现在消息中。 因此，你的 bot 可能不会注意到这个。 所以，你应该监听 <a href="#%E8%81%8A%E5%A4%A9%E6%88%90%E5%91%98%E6%9B%B4%E6%96%B0">聊天成员更新</a>。</p><h2 id="组合多个查询" tabindex="-1"><a class="header-anchor" href="#组合多个查询" aria-hidden="true">#</a> 组合多个查询</h2><p>你可以用 <code>AND</code> 以及 <code>OR</code> 操作来组合任何数量的 filter 查询（这是真的）。</p><h3 id="使用-or-进行组合" tabindex="-1"><a class="header-anchor" href="#使用-or-进行组合" aria-hidden="true">#</a> 使用 OR 进行组合</h3><p>如果你想在两个查询的 OR 串联后面安装一些中间件，你可以把这两个查询以数组的形式传递给 <code>bot<wbr>.on()</code>。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 如果更新是关于一个消息或对一个消息的编辑，则运行。</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;edited_message&quot;</span><span class="token punctuation">]</span> <span class="token comment">/* , ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 如果在文本或标题中发现 hashtag 或电子邮件，或提及 entity，则运行。</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;::hashtag&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;::email&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;::mention&quot;</span><span class="token punctuation">]</span> <span class="token comment">/* , ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>你所提供的 <em>任何查询匹配</em>，中间件都将被执行。 所以查询的顺序并不重要。</p><h3 id="使用-and-进行组合" tabindex="-1"><a class="header-anchor" href="#使用-and-进行组合" aria-hidden="true">#</a> 使用 AND 进行组合</h3><p>如果你想在两个查询的 AND 串联后面安装一些中间件，你可以连锁调用 <code>bot<wbr>.on()</code>。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 匹配转发的 URL</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;::url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;:forward_date&quot;</span> <span class="token comment">/* , ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 匹配在标题中含有标签的照片</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;:photo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;::hashtag&quot;</span> <span class="token comment">/* , ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>你所提供的 <em>任何查询匹配</em>，中间件都将被执行。 所以查询的顺序并不重要。</p><h3 id="构建复杂的查询" tabindex="-1"><a class="header-anchor" href="#构建复杂的查询" aria-hidden="true">#</a> 构建复杂的查询</h3><p>从技术上讲，如果 filter 查询是在 <a href="https://zh.wikipedia.org/wiki/%E5%90%88%E5%8F%96%E8%8C%83%E5%BC%8F" target="_blank" rel="noopener noreferrer">CNF<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 中进行的，就有可能将其与更复杂的公式相结合，尽管这可能不太有用。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot
  <span class="token comment">// 匹配所有频道的帖子或转发的消息 ...</span>
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;channel_post&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;:forward_date&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// ... 包含文本. ...</span>
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;:text&quot;</span><span class="token punctuation">)</span>
  <span class="token comment">// ... 至少有一个 URL，hashtag 或 cashtag。</span>
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;::url&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;::hashtag&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;::cashtag&quot;</span><span class="token punctuation">]</span> <span class="token comment">/* , ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>ctx</code> 的类型推理将扫描整个调用链并检查所有三个 <code>.on</code> 调用的每个元素。 打个比方，它可以检测到 <code>ctx<wbr>.msg<wbr>.text</code> 是上述代码片断的一个必要属性。</p><h2 id="实用贴士" tabindex="-1"><a class="header-anchor" href="#实用贴士" aria-hidden="true">#</a> 实用贴士</h2><p>这里有一些鲜为人知的过滤器查询的功能，它们可能会派上用场。 其中一些是一些比较高级的，所以你可以跳过它们到 <a href="/zh/guide/commands.html" class="">下一节</a>。</p><h3 id="聊天成员更新" tabindex="-1"><a class="header-anchor" href="#聊天成员更新" aria-hidden="true">#</a> 聊天成员更新</h3><p>你可以使用下面的过滤查询来接收你的 bot 的状态更新。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;my_chat_member&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 开始, 停止, 加入, 或者离开</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在私人聊天中，这将在 bot 开始或停止时触发。 在群组中，这将在 bot 加入或移除时触发。 你可以检查 <code>ctx<wbr>.my<wbr>Chat<wbr>Member</code> 来确定到底发生了什么。</p><p>这一点不能与下面混淆</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;chat_member&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面可用于检测其他聊天成员的状态变化，如人们加入、权限提升等。</p><blockquote><p>请注意，<code>chat<wbr>_member</code> 更新需要在启动 bot 时显式地指定 <code>allowed<wbr>_updates</code>。</p></blockquote><h3 id="将查询与其他方法相结合" tabindex="-1"><a class="header-anchor" href="#将查询与其他方法相结合" aria-hidden="true">#</a> 将查询与其他方法相结合</h3><p>你可以将过滤器查询与 <code>Composer</code> 类（<a href="https://doc.deno.land/https://deno.land/x/grammy/mod.ts/~/Composer" target="_blank" rel="noopener noreferrer">API 参考<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>）的其他方法相结合，例如 <code>command</code> 或 <code>filter</code>。 这可以让你构建更复杂的消息处理模式。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;:forward_date&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;help&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 转发的 /help 命令</span>
<span class="token comment">// 只在私人聊天中处理命令。</span>
<span class="token keyword">const</span> pm <span class="token operator">=</span> bot<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>chat<span class="token operator">?.</span>type <span class="token operator">===</span> <span class="token string">&quot;private&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pm<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pm<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;help&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="按消息发送者类型过滤" tabindex="-1"><a class="header-anchor" href="#按消息发送者类型过滤" aria-hidden="true">#</a> 按消息发送者类型过滤</h3><p>在 Telegram 上有 5 种可能的消息发送者类型：</p><ol><li>频道中帖子的作者</li><li>在讨论组中从链接的频道的自动转发</li><li>正常的用户账户，这包括机器人（即&quot;普通&quot;消息）</li><li>管理员代表小组发送（<a href="https://telegram.org/blog/filters-anonymous-admins-comments#anonymous-group-admins" target="_blank" rel="noopener noreferrer">匿名组管理员<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>）</li><li>用户将消息作为其频道之一发送</li></ol><p>你可以将过滤查询与其他更新处理机制结合起来，以找出消息作者的类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 从 `ctx.senderChat` 发送的频道帖子</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;channel_post&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 从 `ctx.senderChat`频道自动转发</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message:is_automatic_forward&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 从 `ctx.from` 发送的常规信息</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>senderChat <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// `ctx.chat` 中的匿名管理员</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span>senderChat<span class="token operator">?.</span>id <span class="token operator">===</span> ctx<span class="token punctuation">.</span>chat<span class="token operator">?.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 其他一切，比如用户作为 `ctx.senderChat` 发送消息</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  ctx<span class="token punctuation">.</span>senderChat <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> ctx<span class="token punctuation">.</span>senderChat<span class="token punctuation">.</span>id <span class="token operator">!==</span> ctx<span class="token punctuation">.</span>chat<span class="token punctuation">.</span>id
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="按照用户属性筛选" tabindex="-1"><a class="header-anchor" href="#按照用户属性筛选" aria-hidden="true">#</a> 按照用户属性筛选</h3><p>如果你想通过用户的其他属性进行过滤，你需要执行一个额外的请求，例如 <code>await ctx<wbr>.get<wbr>Author()</code> 来获取消息的作者。 filter 查询不会秘密地为你执行进一步的 API 请求。 执行这种查询仍然很简单：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
  <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">getAuthor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> user<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">&quot;creator&quot;</span> <span class="token operator">||</span> user<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">&quot;administrator&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 处理来自 creator 和 administrator 的消息</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="复用过滤查询逻辑" tabindex="-1"><a class="header-anchor" href="#复用过滤查询逻辑" aria-hidden="true">#</a> 复用过滤查询逻辑</h3><p>在内部，<code>bot<wbr>.on</code> 依赖于一个名为 <code>match<wbr>Filter</code> 的函数。 它接受一个过滤查询并编译成一个判断函数。 这个判断函数被简单地传递给 <code>bot<wbr>.filter</code>，用于过滤 updates。</p><p>如果你想在你自己的逻辑中使用 <code>match<wbr>Filter</code>，你可以直接导入它。 例如，你可以决定丢弃所有匹配某个查询的 updates：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 丢弃所有文本消息或文本频道帖子。</span>
bot<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token function">matchFilter</span><span class="token punctuation">(</span><span class="token string">&quot;:text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>类似地，你可以使用 grammY 内部的过滤查询类型：</p><h3 id="复用过滤查询类型" tabindex="-1"><a class="header-anchor" href="#复用过滤查询类型" aria-hidden="true">#</a> 复用过滤查询类型</h3><p>在内部，<code>match<wbr>Filter</code> 使用 TypeScript 的 <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates" target="_blank" rel="noopener noreferrer">类型预先定义<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 来缩小 <code>ctx</code> 的类型。 它接受一个 <code>C extends Context</code> 类型和一个 <code>Q extends Filter<wbr>Query</code>类型，并生成 <code>ctx is Filter&lt;C<wbr>, Q&gt;</code>。 换句话说，<code>Filter</code> 类型是你在中间件中接收到的 <code>ctx</code> 的类型。</p><p>如果你想在你自己的逻辑中使用 <code>Filter</code>，你可以直接导入它。 例如，你可以定义一个处理函数，处理被过滤查询筛选的特定上下文对象：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">handler</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> Filter<span class="token operator">&lt;</span>Context<span class="token punctuation">,</span> <span class="token string">&quot;:text&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 处理缩小的上下文对象</span>
<span class="token punctuation">}</span>
bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;:text&quot;</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>查看并阅读更多 <a href="https://doc.deno.land/https://deno.land/x/grammy/filter.ts/~/matchFilter" target="_blank" rel="noopener noreferrer"><code>match<wbr>Filter</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，<a href="https://doc.deno.land/https://deno.land/x/grammy/filter.ts/~/Filter" target="_blank" rel="noopener noreferrer"><code>Filter</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 和 <a href="https://doc.deno.land/https://deno.land/x/grammy/filter.ts/~/FilterQuery" target="_blank" rel="noopener noreferrer"><code>Filter<wbr>Query</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 的 API 参考。</p></blockquote><h2 id="查询语言" tabindex="-1"><a class="header-anchor" href="#查询语言" aria-hidden="true">#</a> 查询语言</h2><blockquote><p>本节是为那些想对 grammY 中的 filter 查询有更深入了解的用户准备的，它不包含创建 bot 所需的任何知识。</p></blockquote><h3 id="查询结构" tabindex="-1"><a class="header-anchor" href="#查询结构" aria-hidden="true">#</a> 查询结构</h3><p>每个查询由最多三个查询部分组成。 根据一个查询有多少个查询部分，我们区分了 L1，L2 和 L3 查询，如 <code>message</code>，<code>message:<wbr>entities</code> 和 <code>message:<wbr>entities:<wbr>url</code>。我们能很清晰的分辨出这三个等级。</p><p>查询部分由冒号(<code>:</code>)分隔。 我们把第一个冒号之前的部分或查询字符串的末尾称为查询的 <em>L1 部分</em>。 我们把从第一个冒号到第二个冒号或到查询字符串结尾的部分称为查询的 <em>L2 部分</em>。 我们把从第二个冒号到查询字符串结尾的部分称为查询的 <em>L3 部分</em>。</p><p>示例:</p><table><thead><tr><th>Filter 查询</th><th>L1 部分</th><th>L2 部分</th><th>L3 部分</th></tr></thead><tbody><tr><td><code>&quot;message&quot;</code></td><td><code>&quot;message&quot;</code></td><td><code>undefined</code></td><td><code>undefined</code></td></tr><tr><td><code>&quot;message:<wbr>entities&quot;</code></td><td><code>&quot;message&quot;</code></td><td><code>&quot;entities&quot;</code></td><td><code>undefined</code></td></tr><tr><td><code>&quot;message:<wbr>entities:<wbr>mention&quot;</code></td><td><code>&quot;message&quot;</code></td><td><code>&quot;entities&quot;</code></td><td><code>&quot;mention&quot;</code></td></tr></tbody></table><h3 id="查询前验证" tabindex="-1"><a class="header-anchor" href="#查询前验证" aria-hidden="true">#</a> 查询前验证</h3><p>尽管类型系统应该在编译时捕获所有无效的过滤器查询，但 grammY 在设置时也会在运行时检查所有通过的过滤器查询。 每个通过的过滤器查询都会与一个验证结构相匹配，以检查它是否有效。 在设置过程中立即失败而不是在运行时失败不仅是好事，以前也发生过 TypeScript 中的错误导致复杂的类型推理系统出现严重问题的情况。 如果将来再发生这种情况，查询前验证将防止可能发生的问题。 在这种情况下，你将会得到有用的错误消息。</p><h3 id="性能" tabindex="-1"><a class="header-anchor" href="#性能" aria-hidden="true">#</a> 性能</h3><p><strong>grammY 可以在每次更新的恒定时间内检查每个 filter 查询</strong>，与查询的结构或传入的更新无关。</p><p>filter 查询的验证只发生一次，当 bot 被初始化和 <code>bot<wbr>.on()</code> 被调用时。</p><p>在启动时，grammY 从 filter 查询中导出一个函数语句，将其拆分为查询部分。 每个部分都将被映射到一个函数，该函数执行一个单一的 <code>in</code> 检查，或者如果该部分被省略，需要检查两个值，则执行两个检查。 然后这些函数被组合成一个语句，这个语句只需要检查与查询相关的值，而不需要对 <code>Update</code> 的对象键进行迭代。</p><p>这个系统使用的操作比一些同类库要少，这些库在路由更新时需要对数组进行包含性检查。如你所见， grammY 的 filter 查询系统要强大得多。</p></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/grammyjs/website/edit/main/site/docs/zh/guide/filter-queries.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页！"><!--[--><!--]--><span>在 GitHub 上编辑此页！ <!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">最近更新时间: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: shtrog@gmail.com">KnorpelSenf</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: 643089849@qq.com">WingLim</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: ez@roj.im">Roj</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: linbuxiao@gmail.com">linbuxiao</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: roj@rojser.best">Roj Serbest</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: git.fytyt@aleeas.com">Ciki Momogi</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: rojserbest@gmail.com">Roj</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: 643089849@qq.com">WignLim</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/zh/guide/api.html" class="" aria-label="Bot API"><!--[--><!--]--><span>Bot API <!--v-if--></span><!--[--><!--]--></a></span><span class="next"><a href="/zh/guide/commands.html" class="" aria-label="Commands"><!--[--><!--]--><span>Commands <!--v-if--></span><!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.ff0cf306.js" defer></script>
  </body>
</html>
